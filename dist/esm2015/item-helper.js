import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { Config, ItemTypes } from "@geoplatform/client";
const ASSETS = [
    ItemTypes.DATASET, ItemTypes.SERVICE, ItemTypes.LAYER, ItemTypes.MAP,
    ItemTypes.GALLERY, ItemTypes.COMMUNITY, ItemTypes.APPLICATION, ItemTypes.TOPIC,
    ItemTypes.WEBSITE
];
let ItemHelper = class ItemHelper {
    constructor() { }
    /**
     * @param {any} item - either GP item or string type
     * @return {boolean}
     */
    static isAsset(item) {
        if (!item)
            return false;
        let type = null;
        if (typeof (item) === 'string')
            type = item;
        else if (item.type)
            type = item.type;
        return type && ASSETS.indexOf(type) >= 0;
    }
    /**
     * @param {any} item - either GP item or string type
     * @return {string} url of icon for the type
     */
    static getIcon(item) {
        let type = "dataset";
        switch (item.type) {
            case ItemTypes.CONTACT:
                type = 'vcard';
                break;
            default: type = item.type.replace(/^[a-z]+\:/i, '').toLowerCase();
        }
        return 'icon-' + type;
    }
    /**
     * @param {any} item - either GP item
     * @return {string} label for the item
     */
    static getLabel(item) {
        if (!item || !item.type)
            return 'Unknown type';
        let type = item.type;
        switch (type) {
            case ItemTypes.ORGANIZATION:
                // case ItemTypes.PERSON :
                return item.label || item.name || "Un-titled resource";
            case ItemTypes.CONCEPT:
            case ItemTypes.CONCEPT_SCHEME:
                return item.label || item.prefLabel || "Un-titled resource";
            case ItemTypes.CONTACT:
                let fn = item.fullName || '';
                let pt = item.positionTitle || '';
                let on = item.orgName || '';
                let label = fn + (fn.length ? ' - ' : '') + pt + (pt.length ? ' - ' : '') + on;
                //if none of those fields have been provided, default to email or placeholder
                if (!label.length)
                    label = item.email || 'Untitled Contact';
                return label;
            default: return item.label || item.title || "Un-titled resource";
        }
    }
    /**
     * @param {any} item - either GP item or string type
     * @return {string} label for the item's type
     */
    static getTypeLabel(item) {
        if (!item)
            return 'Unknown Resource Type';
        let type = null;
        if (typeof (item) === 'string')
            type = item;
        else if (item.type)
            type = item.type;
        else
            return null;
        switch (type) {
            case ItemTypes.DATASET:
            case ItemTypes.SERVICE:
            // case ItemTypes.PERSON :
            case ItemTypes.ORGANIZATION:
            case ItemTypes.CONCEPT:
                return type.replace(/^[a-z]+\:/i, '');
            case ItemTypes.CONCEPT_SCHEME: return "Concept Scheme";
            case ItemTypes.WEBSITE: return "Website";
            case ItemTypes.CONTACT: return "Contact";
            default: return type; //remainder are unprefixed
        }
    }
    /**
     * @param {any} item - either GP item or string type
     * @return {string} key (plural) for the item's type
     */
    static getTypeKey(item) {
        if (!item)
            return null;
        let type = null;
        if (typeof (item) === 'string')
            type = item;
        else if (item.type)
            type = item.type;
        else
            return null;
        switch (type) {
            //special plurality
            case ItemTypes.GALLERY: return 'galleries';
            case ItemTypes.COMMUNITY: return 'communities';
            //different name
            case ItemTypes.CONTACT: return 'contacts'; //instead of "vcards"
            //remainder
            default: return type.replace(/^[a-z]+\:/i, '').toLowerCase() + 's';
        }
    }
    /**
     * @param {string} type - item type
     * @return {string} string path to the type's icon
     */
    static determineIconType(type) {
        let name = type.replace(/^[a-z]+\:/i, '').toLowerCase();
        return `/assets/icons/${name}.svg`;
    }
    static getItemDetailsUrl(item) {
        if (!item || !item.type || !item.id)
            return null;
        return Config.portalUrl + '/resources/' + this.getTypeKey(item) + '/' + item.id;
    }
};
ItemHelper = tslib_1.__decorate([
    Injectable()
], ItemHelper);
export { ItemHelper };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXRlbS1oZWxwZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ2VvcGxhdGZvcm0vY29tbW9uLyIsInNvdXJjZXMiOlsiaXRlbS1oZWxwZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUV4RCxNQUFNLE1BQU0sR0FBRztJQUNYLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLE9BQU8sRUFBSSxTQUFTLENBQUMsS0FBSyxFQUFRLFNBQVMsQ0FBQyxHQUFHO0lBQzVFLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxLQUFLO0lBQzlFLFNBQVMsQ0FBQyxPQUFPO0NBQ3BCLENBQUM7QUFHRixJQUFhLFVBQVUsR0FBdkIsTUFBYSxVQUFVO0lBRW5CLGdCQUFnQixDQUFDO0lBRWpCOzs7T0FHRztJQUNILE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBVTtRQUNyQixJQUFHLENBQUMsSUFBSTtZQUFFLE9BQU8sS0FBSyxDQUFDO1FBQ3ZCLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQztRQUNoQixJQUFHLE9BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxRQUFRO1lBQUcsSUFBSSxHQUFHLElBQWMsQ0FBQzthQUNoRCxJQUFHLElBQUksQ0FBQyxJQUFJO1lBQUUsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDcEMsT0FBTyxJQUFJLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVEOzs7T0FHRztJQUNILE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBVTtRQUNyQixJQUFJLElBQUksR0FBRyxTQUFTLENBQUM7UUFDckIsUUFBTyxJQUFJLENBQUMs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QUFDLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUFFLE9BQU8sSUFBSSxDQUFDO1FBRWhELE9BQU8sTUFBTSxDQUFDLFNBQVMsR0FBRyxhQUFhLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQztJQUNwRixDQUFDO0NBRUosQ0FBQTtBQS9IWSxVQUFVO0lBRHRCLFVBQVUsRUFBRTtHQUNBLFVBQVUsQ0ErSHRCO1NBL0hZLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb25maWcsIEl0ZW1UeXBlcyB9IGZyb20gXCJAZ2VvcGxhdGZvcm0vY2xpZW50XCI7XG5cbmNvbnN0IEFTU0VUUyA9IFtcbiAgICBJdGVtVHlwZXMuREFUQVNFVCwgSXRlbVR5cGVzLlNFUlZJQ0UsICAgSXRlbVR5cGVzLkxBWUVSLCAgICAgICBJdGVtVHlwZXMuTUFQLFxuICAgIEl0ZW1UeXBlcy5HQUxMRVJZLCBJdGVtVHlwZXMuQ09NTVVOSVRZLCBJdGVtVHlwZXMuQVBQTElDQVRJT04sIEl0ZW1UeXBlcy5UT1BJQyxcbiAgICBJdGVtVHlwZXMuV0VCU0lURVxuXTtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEl0ZW1IZWxwZXIge1xuXG4gICAgY29uc3RydWN0b3IoKSB7IH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7YW55fSBpdGVtIC0gZWl0aGVyIEdQIGl0ZW0gb3Igc3RyaW5nIHR5cGVcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIHN0YXRpYyBpc0Fzc2V0KGl0ZW0gOiBhbnkpIHtcbiAgICAgICAgaWYoIWl0ZW0pIHJldHVybiBmYWxzZTtcbiAgICAgICAgbGV0IHR5cGUgPSBudWxsO1xuICAgICAgICBpZih0eXBlb2YoaXRlbSkgPT09ICdzdHJpbmcnKSAgdHlwZSA9IGl0ZW0gYXMgc3RyaW5nO1xuICAgICAgICBlbHNlIGlmKGl0ZW0udHlwZSkgdHlwZSA9IGl0ZW0udHlwZTtcbiAgICAgICAgcmV0dXJuIHR5cGUgJiYgQVNTRVRTLmluZGV4T2YodHlwZSkgPj0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2FueX0gaXRlbSAtIGVpdGhlciBHUCBpdGVtIG9yIHN0cmluZyB0eXBlXG4gICAgICogQHJldHVybiB7c3RyaW5nfSB1cmwgb2YgaWNvbiBmb3IgdGhlIHR5cGVcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0SWNvbihpdGVtIDogYW55KSA6c3RyaW5nIHtcbiAgICAgICAgbGV0IHR5cGUgPSBcImRhdGFzZXRcIjtcbiAgICAgICAgc3dpdGNoKGl0ZW0udHlwZSkge1xuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuQ09OVEFDVDogICAgICAgICB0eXBlID0gICd2Y2FyZCc7IGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDogdHlwZSA9IGl0ZW0udHlwZS5yZXBsYWNlKC9eW2Etel0rXFw6L2ksICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnaWNvbi0nICsgdHlwZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2FueX0gaXRlbSAtIGVpdGhlciBHUCBpdGVtXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBsYWJlbCBmb3IgdGhlIGl0ZW1cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0TGFiZWwoaXRlbSA6IGFueSkge1xuICAgICAgICBpZighaXRlbSB8fCAhaXRlbS50eXBlKSByZXR1cm4gJ1Vua25vd24gdHlwZSc7XG5cbiAgICAgICAgbGV0IHR5cGUgPSBpdGVtLnR5cGU7XG4gICAgICAgIHN3aXRjaCh0eXBlKSB7XG5cbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLk9SR0FOSVpBVElPTiA6XG4gICAgICAgICAgICAvLyBjYXNlIEl0ZW1UeXBlcy5QRVJTT04gOlxuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmxhYmVsIHx8IGl0ZW0ubmFtZSB8fCBcIlVuLXRpdGxlZCByZXNvdXJjZVwiO1xuXG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05DRVBUIDpcbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLkNPTkNFUFRfU0NIRU1FIDpcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5sYWJlbCB8fCBpdGVtLnByZWZMYWJlbCB8fCBcIlVuLXRpdGxlZCByZXNvdXJjZVwiO1xuXG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05UQUNUIDpcbiAgICAgICAgICAgICAgICBsZXQgZm4gPSBpdGVtLmZ1bGxOYW1lIHx8ICcnO1xuICAgICAgICAgICAgICAgIGxldCBwdCA9IGl0ZW0ucG9zaXRpb25UaXRsZSB8fCAnJztcbiAgICAgICAgICAgICAgICBsZXQgb24gPSBpdGVtLm9yZ05hbWUgfHwgJyc7XG4gICAgICAgICAgICAgICAgbGV0IGxhYmVsID0gZm4gKyAoZm4ubGVuZ3RoPycgLSAnOicnKSArIHB0ICsgKHB0Lmxlbmd0aD8nIC0gJzonJykgKyBvbjtcbiAgICAgICAgICAgICAgICAvL2lmIG5vbmUgb2YgdGhvc2UgZmllbGRzIGhhdmUgYmVlbiBwcm92aWRlZCwgZGVmYXVsdCB0byBlbWFpbCBvciBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgIGlmKCFsYWJlbC5sZW5ndGgpIGxhYmVsID0gaXRlbS5lbWFpbCB8fCAnVW50aXRsZWQgQ29udGFjdCc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxhYmVsO1xuXG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gaXRlbS5sYWJlbCB8fCBpdGVtLnRpdGxlIHx8IFwiVW4tdGl0bGVkIHJlc291cmNlXCI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2FueX0gaXRlbSAtIGVpdGhlciBHUCBpdGVtIG9yIHN0cmluZyB0eXBlXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBsYWJlbCBmb3IgdGhlIGl0ZW0ncyB0eXBlXG4gICAgICovXG4gICAgc3RhdGljIGdldFR5cGVMYWJlbChpdGVtOmFueSkge1xuICAgICAgICBpZighaXRlbSkgcmV0dXJuICdVbmtub3duIFJlc291cmNlIFR5cGUnO1xuXG4gICAgICAgIGxldCB0eXBlIDogc3RyaW5nID0gbnVsbDtcbiAgICAgICAgaWYodHlwZW9mKGl0ZW0pID09PSAnc3RyaW5nJykgdHlwZSA9IGl0ZW0gYXMgc3RyaW5nO1xuICAgICAgICBlbHNlIGlmKGl0ZW0udHlwZSkgdHlwZSA9IGl0ZW0udHlwZTtcbiAgICAgICAgZWxzZSByZXR1cm4gbnVsbDtcblxuICAgICAgICBzd2l0Y2godHlwZSkge1xuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuREFUQVNFVCA6XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5TRVJWSUNFIDpcbiAgICAgICAgICAgIC8vIGNhc2UgSXRlbVR5cGVzLlBFUlNPTiA6XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5PUkdBTklaQVRJT04gOlxuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuQ09OQ0VQVCA6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHR5cGUucmVwbGFjZSgvXlthLXpdK1xcOi9pLCAnJyk7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05DRVBUX1NDSEVNRSA6IHJldHVybiBcIkNvbmNlcHQgU2NoZW1lXCI7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5XRUJTSVRFIDogcmV0dXJuIFwiV2Vic2l0ZVwiO1xuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuQ09OVEFDVCA6IHJldHVybiBcIkNvbnRhY3RcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiB0eXBlOyAgIC8vcmVtYWluZGVyIGFyZSB1bnByZWZpeGVkXG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7YW55fSBpdGVtIC0gZWl0aGVyIEdQIGl0ZW0gb3Igc3RyaW5nIHR5cGVcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IGtleSAocGx1cmFsKSBmb3IgdGhlIGl0ZW0ncyB0eXBlXG4gICAgICovXG4gICAgc3RhdGljIGdldFR5cGVLZXkoaXRlbTphbnkpIHtcbiAgICAgICAgaWYoIWl0ZW0pIHJldHVybiBudWxsO1xuXG4gICAgICAgIGxldCB0eXBlIDogc3RyaW5nID0gbnVsbDtcbiAgICAgICAgaWYodHlwZW9mKGl0ZW0pID09PSAnc3RyaW5nJykgdHlwZSA9IGl0ZW0gYXMgc3RyaW5nO1xuICAgICAgICBlbHNlIGlmKGl0ZW0udHlwZSkgdHlwZSA9IGl0ZW0udHlwZTtcbiAgICAgICAgZWxzZSByZXR1cm4gbnVsbDtcblxuICAgICAgICBzd2l0Y2godHlwZSkge1xuICAgICAgICAgICAgLy9zcGVjaWFsIHBsdXJhbGl0eVxuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuR0FMTEVSWSA6IHJldHVybiAnZ2FsbGVyaWVzJztcbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLkNPTU1VTklUWSA6IHJldHVybiAnY29tbXVuaXRpZXMnO1xuICAgICAgICAgICAgLy9kaWZmZXJlbnQgbmFtZVxuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuQ09OVEFDVCA6IHJldHVybiAnY29udGFjdHMnOyAvL2luc3RlYWQgb2YgXCJ2Y2FyZHNcIlxuICAgICAgICAgICAgLy9yZW1haW5kZXJcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiB0eXBlLnJlcGxhY2UoL15bYS16XStcXDovaSwgJycpLnRvTG93ZXJDYXNlKCkgKyAncyc7XG5cbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBpdGVtIHR5cGVcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IHN0cmluZyBwYXRoIHRvIHRoZSB0eXBlJ3MgaWNvblxuICAgICAqL1xuICAgIHN0YXRpYyBkZXRlcm1pbmVJY29uVHlwZSh0eXBlIDogc3RyaW5nKSB7XG4gICAgICAgIGxldCBuYW1lID0gdHlwZS5yZXBsYWNlKC9eW2Etel0rXFw6L2ksICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICByZXR1cm4gYC9hc3NldHMvaWNvbnMvJHtuYW1lfS5zdmdgO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRJdGVtRGV0YWlsc1VybChpdGVtIDogYW55KSB7XG4gICAgICAgIGlmKCFpdGVtIHx8ICFpdGVtLnR5cGUgfHwgIWl0ZW0uaWQpIHJldHVybiBudWxsO1xuXG4gICAgICAgIHJldHVybiBDb25maWcucG9ydGFsVXJsICsgJy9yZXNvdXJjZXMvJyArIHRoaXMuZ2V0VHlwZUtleShpdGVtKSArICcvJyArIGl0ZW0uaWQ7XG4gICAgfVxuXG59XG4iXX0=