import { ItemTypes } from '@geoplatform/client';
import { ItemHelper } from './item-helper';
const Visibilities = {
    PUBLIC: 'public',
    PRIVATE: 'private'
};
const Statuses = {
    SUBMITTED: 'submitted'
};
function createItem(type, opts) {
    return Object.assign({
        type: type,
        uri: null,
        label: "New Item",
        description: "This item needs a description",
        resourceTypes: [],
        createdBy: null,
        lastModifiedBy: null
    }, opts || {});
}
function createAsset(type, opts) {
    let options = Object.assign({
        keywords: [],
        alternateTitles: [],
        purpose: null,
        themes: [],
        contacts: [],
        publishers: [],
        contributors: [],
        distributions: [],
        classifiers: {},
        landingPage: null,
        status: Statuses.SUBMITTED,
        visibility: Visibilities.PUBLIC,
        identifiers: [],
        extent: { minx: -179, miny: -89, maxx: 179, maxy: 89 },
        temporal: { startDate: null, endDate: null },
        statistics: { numViews: 0, numLikes: 0 },
        usedBy: [],
        related: [],
        rights: []
    }, opts || {});
    let item = createItem(type, options);
    return item;
}
function createMap() {
    let obj = createAsset(ItemTypes.MAP, {
        layers: [],
        baseLayer: null,
        annotations: {},
        thumbnail: {
            label: null,
            url: null,
            contentData: null,
            width: 0,
            height: 0
        }
    });
    return obj;
}
function createLayer(service) {
    let services = service ? [service] : [];
    let obj = createAsset(ItemTypes.LAYER, {
        subLayers: [],
        parentLayer: null,
        services: services,
        layerName: null,
        layerType: null,
        legend: null
    });
    return obj;
}
function createService() {
    let obj = createAsset(ItemTypes.SERVICE, {
        datasets: [],
        serviceType: null,
        href: null
    });
    return obj;
}
function createDataset() {
    let obj = createAsset(ItemTypes.DATASET, { services: [] });
    return obj;
}
function createGallery() {
    let obj = createAsset(ItemTypes.GALLERY, { items: [] });
    return obj;
}
function createCommunity() {
    let obj = createAsset(ItemTypes.COMMUNITY);
    return obj;
}
function createConcept() {
    let obj = createItem(ItemTypes.CONCEPT, { scheme: null });
    return obj;
}
function createConceptScheme() {
    let obj = createItem(ItemTypes.CONCEPT_SCHEME);
    return obj;
}
function createOrg() {
    let obj = createItem(ItemTypes.ORGANIZATION, { subOrgOf: null });
    return obj;
}
function createContact() {
    let obj = createItem(ItemTypes.CONTACT, {
        fullName: null,
        email: null,
        tel: null,
        fax: null,
        address: {
            street1: null,
            street2: null,
            city: null,
            state: null,
            zip: null
        }
    });
    return obj;
}
function defaultArrayValue(item, property) {
    if (!item || !property)
        return;
    if (item[property] === null || item[property] === undefined ||
        typeof (item[property]) === 'undefined')
        item[property] = [];
}
function defaultToNullValue(item, property) {
    if (!item || !property)
        return;
    if (typeof (item[property]) === 'undefined')
        item[property] = null;
}
export class ItemFactory {
    static create(type) {
        switch (type) {
            case ItemTypes.MAP: return createMap();
            case ItemTypes.LAYER: return createLayer();
            case ItemTypes.SERVICE: return createService();
            case ItemTypes.DATASET: return createDataset();
            case ItemTypes.GALLERY: return createGallery();
            case ItemTypes.COMMUNITY: return createCommunity();
            case ItemTypes.CONCEPT: return createConcept();
            case ItemTypes.CONCEPT_SCHEME: return createConceptScheme();
            case ItemTypes.ORGANIZATION: return createOrg();
            case ItemTypes.CONTACT: return createContact();
            default: return null;
        }
    }
    static fix(item) {
        defaultArrayValue(item, 'resourceTypes');
        if (ItemHelper.isAsset(item)) {
            defaultArrayValue(item, 'keywords');
            defaultArrayValue(item, 'alternateTitles');
            defaultArrayValue(item, 'themes');
            defaultArrayValue(item, 'contacts');
            defaultArrayValue(item, 'publishers');
            defaultArrayValue(item, 'contributors');
            defaultArrayValue(item, 'distributions');
            defaultArrayValue(item, 'identifiers');
            defaultArrayValue(item, 'usedBy');
            defaultArrayValue(item, 'related');
            defaultArrayValue(item, 'accessRights');
            defaultToNullValue(item, 'purpose');
            defaultToNullValue(item, 'landingPage');
            defaultToNullValue(item, 'status');
            defaultToNullValue(item, 'visibility');
            if (!item.temporal) {
                item.temporal = { startDate: null, endDate: null };
            }
            if (!item.extent) {
                item.extent = { minx: -179, miny: -89, maxx: 179, maxy: 89 };
            }
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXRlbS1mYWN0b3J5LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdlb3BsYXRmb3JtL2NvbW1vbi8iLCJzb3VyY2VzIjpbIml0ZW0tZmFjdG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBSUgsU0FBUyxFQUNaLE1BQU0scUJBQXFCLENBQUM7QUFFN0IsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUczQyxNQUFNLFlBQVksR0FBUztJQUN2QixNQUFNLEVBQUcsUUFBUTtJQUNqQixPQUFPLEVBQUcsU0FBUztDQUN0QixDQUFDO0FBRUYsTUFBTSxRQUFRLEdBQVM7SUFDbkIsU0FBUyxFQUFHLFdBQVc7Q0FDMUIsQ0FBQztBQUlGLFNBQVMsVUFBVSxDQUFDLElBQUksRUFBRSxJQUEwQjtJQUNoRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDakIsSUFBSSxFQUFZLElBQUk7UUFDcEIsR0FBRyxFQUFhLElBQUk7UUFDcEIsS0FBSyxFQUFXLFVBQVU7UUFDMUIsV0FBVyxFQUFLLCtCQUErQjtRQUMvQyxhQUFhLEVBQUcsRUFBRTtRQUNsQixTQUFTLEVBQU8sSUFBSTtRQUNwQixjQUFjLEVBQUUsSUFBSTtLQUN2QixFQUFFLElBQUksSUFBRSxFQUFFLENBQUMsQ0FBQztBQUNqQixDQUFDO0FBRUQsU0FBUyxXQUFXLENBQUMsSUFBSSxFQUFFLElBQTBCO0lBQ2pELElBQUksT0FBTyxHQUEyQixNQUFNLENBQUMsTUFBTSxDQUFDO1FBQ2hELFFBQVEsRUFBVSxFQUFFO1FBQ3BCLGVBQWUsRUFBRyxFQUFFO1FBQ3BCLE9BQU8sRUFBVyxJQUFJO1FBQ3RCLE1BQU0sRUFBWSxFQUFFO1FBQ3BCLFFBQVEsRUFBVSxFQUFFO1FBQ3BCLFVBQVUsRUFBUSxFQUFFO1FBQ3BCLFlBQVksRUFBTSxFQUFFO1FBQ3BCLGFBQWEsRUFBSyxFQUFFO1FBQ3BCLFdBQVcsRUFBTyxFQUFFO1FBQ3BCLFdBQVcsRUFBTyxJQUFJO1FBQ3RCLE1B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RSxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxDQUFDO2FBQ2hFO1NBQ0o7SUFDTCxDQUFDO0NBRUoiLCJzb3VyY2VzQ29udGVudCI6WyJcblxuaW1wb3J0IHtcbiAgICBJdGVtLCBBc3NldCxcbiAgICBNYXAsIExheWVyLCBTZXJ2aWNlLCBEYXRhc2V0LCBHYWxsZXJ5LCBDb21tdW5pdHksIENvbmNlcHQsXG4gICAgQ29uY2VwdFNjaGVtZSwgT3JnYW5pemF0aW9uLCBDb250YWN0LFxuICAgIEl0ZW1UeXBlc1xufSBmcm9tICdAZ2VvcGxhdGZvcm0vY2xpZW50JztcblxuaW1wb3J0IHsgSXRlbUhlbHBlciB9IGZyb20gJy4vaXRlbS1oZWxwZXInO1xuXG5cbmNvbnN0IFZpc2liaWxpdGllcyA6IGFueSA9IHtcbiAgICBQVUJMSUMgOiAncHVibGljJyxcbiAgICBQUklWQVRFIDogJ3ByaXZhdGUnXG59O1xuXG5jb25zdCBTdGF0dXNlcyA6IGFueSA9IHtcbiAgICBTVUJNSVRURUQgOiAnc3VibWl0dGVkJ1xufTtcblxuXG5cbmZ1bmN0aW9uIGNyZWF0ZUl0ZW0odHlwZSwgb3B0cyA/OiB7W2tleTpzdHJpbmddOmFueX0pIDogYW55IHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgIHR5cGU6ICAgICAgICAgICB0eXBlLFxuICAgICAgICB1cmk6ICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgbGFiZWw6ICAgICAgICAgIFwiTmV3IEl0ZW1cIixcbiAgICAgICAgZGVzY3JpcHRpb246ICAgIFwiVGhpcyBpdGVtIG5lZWRzIGEgZGVzY3JpcHRpb25cIixcbiAgICAgICAgcmVzb3VyY2VUeXBlczogIFtdLFxuICAgICAgICBjcmVhdGVkQnk6ICAgICAgbnVsbCxcbiAgICAgICAgbGFzdE1vZGlmaWVkQnk6IG51bGxcbiAgICB9LCBvcHRzfHx7fSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUFzc2V0KHR5cGUsIG9wdHMgPzoge1trZXk6c3RyaW5nXTphbnl9KSA6IGFueSB7XG4gICAgbGV0IG9wdGlvbnMgOiB7W2tleTpzdHJpbmddOnN0cmluZ30gPSBPYmplY3QuYXNzaWduKHtcbiAgICAgICAga2V5d29yZHMgICAgICAgIDogW10sXG4gICAgICAgIGFsdGVybmF0ZVRpdGxlcyA6IFtdLFxuICAgICAgICBwdXJwb3NlICAgICAgICAgOiBudWxsLFxuICAgICAgICB0aGVtZXMgICAgICAgICAgOiBbXSxcbiAgICAgICAgY29udGFjdHMgICAgICAgIDogW10sXG4gICAgICAgIHB1Ymxpc2hlcnMgICAgICA6IFtdLFxuICAgICAgICBjb250cmlidXRvcnMgICAgOiBbXSxcbiAgICAgICAgZGlzdHJpYnV0aW9ucyAgIDogW10sXG4gICAgICAgIGNsYXNzaWZpZXJzICAgICA6IHt9LFxuICAgICAgICBsYW5kaW5nUGFnZSAgICAgOiBudWxsLFxuICAgICAgICBzdGF0dXMgICAgICAgICAgOiBTdGF0dXNlcy5TVUJNSVRURUQsXG4gICAgICAgIHZpc2liaWxpdHkgICAgICA6IFZpc2liaWxpdGllcy5QVUJMSUMsXG4gICAgICAgIGlkZW50aWZpZXJzICAgICA6IFtdIGFzIHN0cmluZ1tdLFxuICAgICAgICBleHRlbnQgICAgICAgICAgOiB7IG1pbng6IC0xNzksIG1pbnk6IC04OSwgbWF4eDogMTc5LCBtYXh5OiA4OSB9LFxuICAgICAgICB0ZW1wb3JhbCAgICAgICAgOiB7IHN0YXJ0RGF0ZTogbnVsbCwgZW5kRGF0ZTogbnVsbCB9LFxuICAgICAgICBzdGF0aXN0aWNzICAgICAgOiB7IG51bVZpZXdzOiAwLCBudW1MaWtlczogMCB9LFxuICAgICAgICB1c2VkQnkgICAgICAgICAgOiBbXSxcbiAgICAgICAgcmVsYXRlZCAgICAgICAgIDogW10sXG4gICAgICAgIHJpZ2h0cyAgICAgICAgICA6IFtdXG4gICAgfSwgb3B0c3x8e30pO1xuICAgIGxldCBpdGVtID0gY3JlYXRlSXRlbSh0eXBlLCBvcHRpb25zKTtcbiAgICByZXR1cm4gaXRlbSBhcyBBc3NldDtcbn1cblxuXG5cbmZ1bmN0aW9uIGNyZWF0ZU1hcCgpIDogTWFwIHtcbiAgICBsZXQgb2JqID0gY3JlYXRlQXNzZXQoSXRlbVR5cGVzLk1BUCwge1xuICAgICAgICBsYXllcnMgICAgICA6IFtdLFxuICAgICAgICBiYXNlTGF5ZXIgICA6IG51bGwsXG4gICAgICAgIGFubm90YXRpb25zIDoge30sXG4gICAgICAgIHRodW1ibmFpbCAgIDoge1xuICAgICAgICAgICAgbGFiZWwgICAgICAgOiBudWxsLFxuICAgICAgICAgICAgdXJsICAgICAgICAgOiBudWxsLFxuICAgICAgICAgICAgY29udGVudERhdGEgOiBudWxsLFxuICAgICAgICAgICAgd2lkdGggICAgICAgOiAwLFxuICAgICAgICAgICAgaGVpZ2h0ICAgICAgOiAwXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gb2JqIGFzIE1hcDtcbn1cblxuXG5mdW5jdGlvbiBjcmVhdGVMYXllciggc2VydmljZSA/OiBTZXJ2aWNlICkgOiBNYXAge1xuICAgIGxldCBzZXJ2aWNlcyA9IHNlcnZpY2UgPyBbc2VydmljZV0gOiBbXTtcbiAgICBsZXQgb2JqID0gY3JlYXRlQXNzZXQoSXRlbVR5cGVzLkxBWUVSLCB7XG4gICAgICAgIHN1YkxheWVycyAgIDogW10sXG4gICAgICAgIHBhcmVudExheWVyIDogbnVsbCxcbiAgICAgICAgc2VydmljZXMgICAgOiBzZXJ2aWNlcyxcbiAgICAgICAgbGF5ZXJOYW1lICAgOiBudWxsLFxuICAgICAgICBsYXllclR5cGUgICA6IG51bGwsXG4gICAgICAgIGxlZ2VuZCAgICAgIDogbnVsbFxuICAgIH0pO1xuICAgIHJldHVybiBvYmogYXMgTWFwO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVTZXJ2aWNlKCkgOiBTZXJ2aWNlIHtcbiAgICBsZXQgb2JqID0gY3JlYXRlQXNzZXQoSXRlbVR5cGVzLlNFUlZJQ0UsIHtcbiAgICAgICAgZGF0YXNldHMgICAgOiBbXSxcbiAgICAgICAgc2VydmljZVR5cGUgOiBudWxsLFxuICAgICAgICBocmVmICAgICAgICA6IG51bGxcbiAgICB9KTtcbiAgICByZXR1cm4gb2JqIGFzIFNlcnZpY2U7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZURhdGFzZXQoKSA6IERhdGFzZXQge1xuICAgIGxldCBvYmogPSBjcmVhdGVBc3NldChJdGVtVHlwZXMuREFUQVNFVCwgeyBzZXJ2aWNlcyA6IFtdIH0pO1xuICAgIHJldHVybiBvYmogYXMgRGF0YXNldDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlR2FsbGVyeSgpIDogR2FsbGVyeSB7XG4gICAgbGV0IG9iaiA9IGNyZWF0ZUFzc2V0KEl0ZW1UeXBlcy5HQUxMRVJZLCB7IGl0ZW1zIDogW10gfSk7XG4gICAgcmV0dXJuIG9iaiBhcyBHYWxsZXJ5O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDb21tdW5pdHkoKSA6IENvbW11bml0eSB7XG4gICAgbGV0IG9iaiA9IGNyZWF0ZUFzc2V0KEl0ZW1UeXBlcy5DT01NVU5JVFkpO1xuICAgIHJldHVybiBvYmogYXMgQ29tbXVuaXR5O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDb25jZXB0KCkgOiBDb25jZXB0IHtcbiAgICBsZXQgb2JqID0gY3JlYXRlSXRlbShJdGVtVHlwZXMuQ09OQ0VQVCwgeyBzY2hlbWUgOiBudWxsIH0pO1xuICAgIHJldHVybiBvYmogYXMgQ29uY2VwdDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29uY2VwdFNjaGVtZSgpIDogQ29uY2VwdFNjaGVtZSB7XG4gICAgbGV0IG9iaiA9IGNyZWF0ZUl0ZW0oSXRlbVR5cGVzLkNPTkNFUFRfU0NIRU1FKTtcbiAgICByZXR1cm4gb2JqIGFzIENvbmNlcHRTY2hlbWU7XG59XG5cblxuZnVuY3Rpb24gY3JlYXRlT3JnKCkgOiBPcmdhbml6YXRpb24ge1xuICAgIGxldCBvYmogPSBjcmVhdGVJdGVtKEl0ZW1UeXBlcy5PUkdBTklaQVRJT04sIHsgc3ViT3JnT2YgOiBudWxsIH0pO1xuICAgIHJldHVybiBvYmogYXMgT3JnYW5pemF0aW9uO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDb250YWN0KCkgOiBDb250YWN0IHtcbiAgICBsZXQgb2JqID0gY3JlYXRlSXRlbShJdGVtVHlwZXMuQ09OVEFDVCwge1xuICAgICAgICBmdWxsTmFtZSA6IG51bGwsXG4gICAgICAgIGVtYWlsICAgIDogbnVsbCxcbiAgICAgICAgdGVsICAgICAgOiBudWxsLFxuICAgICAgICBmYXggICAgICA6IG51bGwsXG4gICAgICAgIGFkZHJlc3MgIDoge1xuICAgICAgICAgICAgc3RyZWV0MTogbnVsbCxcbiAgICAgICAgICAgIHN0cmVldDI6IG51bGwsXG4gICAgICAgICAgICBjaXR5OiAgICBudWxsLFxuICAgICAgICAgICAgc3RhdGU6ICAgbnVsbCxcbiAgICAgICAgICAgIHppcDogICAgIG51bGxcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvYmogYXMgQ29udGFjdDtcbn1cblxuXG5cblxuXG5cbmZ1bmN0aW9uIGRlZmF1bHRBcnJheVZhbHVlKGl0ZW0sIHByb3BlcnR5KSB7XG4gICAgaWYoIWl0ZW0gfHwgIXByb3BlcnR5KSByZXR1cm47XG4gICAgaWYoIGl0ZW1bcHJvcGVydHldID09PSBudWxsIHx8IGl0ZW1bcHJvcGVydHldID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgdHlwZW9mKGl0ZW1bcHJvcGVydHldKSA9PT0gJ3VuZGVmaW5lZCcgKVxuICAgICAgICBpdGVtW3Byb3BlcnR5XSA9IFtdO1xufVxuXG5mdW5jdGlvbiBkZWZhdWx0VG9OdWxsVmFsdWUoaXRlbSwgcHJvcGVydHkpIHtcbiAgICBpZighaXRlbSB8fCAhcHJvcGVydHkpIHJldHVybjtcbiAgICBpZiggdHlwZW9mKGl0ZW1bcHJvcGVydHldKSA9PT0gJ3VuZGVmaW5lZCcgKVxuICAgICAgICBpdGVtW3Byb3BlcnR5XSA9IG51bGw7XG59XG5cblxuXG5leHBvcnQgY2xhc3MgSXRlbUZhY3Rvcnkge1xuXG4gICAgc3RhdGljIGNyZWF0ZSh0eXBlKSB7XG4gICAgICAgIHN3aXRjaCh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5NQVAgOiByZXR1cm4gY3JlYXRlTWFwKCk7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5MQVlFUiA6IHJldHVybiBjcmVhdGVMYXllcigpO1xuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuU0VSVklDRSA6IHJldHVybiBjcmVhdGVTZXJ2aWNlKCk7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5EQVRBU0VUIDogcmV0dXJuIGNyZWF0ZURhdGFzZXQoKTtcbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLkdBTExFUlkgOiByZXR1cm4gY3JlYXRlR2FsbGVyeSgpO1xuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuQ09NTVVOSVRZOiByZXR1cm4gY3JlYXRlQ29tbXVuaXR5KCk7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05DRVBUIDogcmV0dXJuIGNyZWF0ZUNvbmNlcHQoKTtcbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLkNPTkNFUFRfU0NIRU1FOiByZXR1cm4gY3JlYXRlQ29uY2VwdFNjaGVtZSgpO1xuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuT1JHQU5JWkFUSU9OOiByZXR1cm4gY3JlYXRlT3JnKCk7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05UQUNUOiByZXR1cm4gY3JlYXRlQ29udGFjdCgpO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgZml4KGl0ZW0pIHtcblxuICAgICAgICBkZWZhdWx0QXJyYXlWYWx1ZShpdGVtLCAncmVzb3VyY2VUeXBlcycpO1xuXG4gICAgICAgIGlmKEl0ZW1IZWxwZXIuaXNBc3NldChpdGVtKSkge1xuICAgICAgICAgICAgZGVmYXVsdEFycmF5VmFsdWUoaXRlbSwgJ2tleXdvcmRzJyk7XG4gICAgICAgICAgICBkZWZhdWx0QXJyYXlWYWx1ZShpdGVtLCAnYWx0ZXJuYXRlVGl0bGVzJyk7XG4gICAgICAgICAgICBkZWZhdWx0QXJyYXlWYWx1ZShpdGVtLCAndGhlbWVzJyk7XG4gICAgICAgICAgICBkZWZhdWx0QXJyYXlWYWx1ZShpdGVtLCAnY29udGFjdHMnKTtcbiAgICAgICAgICAgIGRlZmF1bHRBcnJheVZhbHVlKGl0ZW0sICdwdWJsaXNoZXJzJyk7XG4gICAgICAgICAgICBkZWZhdWx0QXJyYXlWYWx1ZShpdGVtLCAnY29udHJpYnV0b3JzJyk7XG4gICAgICAgICAgICBkZWZhdWx0QXJyYXlWYWx1ZShpdGVtLCAnZGlzdHJpYnV0aW9ucycpO1xuICAgICAgICAgICAgZGVmYXVsdEFycmF5VmFsdWUoaXRlbSwgJ2lkZW50aWZpZXJzJyk7XG4gICAgICAgICAgICBkZWZhdWx0QXJyYXlWYWx1ZShpdGVtLCAndXNlZEJ5Jyk7XG4gICAgICAgICAgICBkZWZhdWx0QXJyYXlWYWx1ZShpdGVtLCAncmVsYXRlZCcpO1xuICAgICAgICAgICAgZGVmYXVsdEFycmF5VmFsdWUoaXRlbSwgJ2FjY2Vzc1JpZ2h0cycpO1xuXG4gICAgICAgICAgICBkZWZhdWx0VG9OdWxsVmFsdWUoaXRlbSwgJ3B1cnBvc2UnKTtcbiAgICAgICAgICAgIGRlZmF1bHRUb051bGxWYWx1ZShpdGVtLCAnbGFuZGluZ1BhZ2UnKTtcbiAgICAgICAgICAgIGRlZmF1bHRUb051bGxWYWx1ZShpdGVtLCAnc3RhdHVzJyk7XG4gICAgICAgICAgICBkZWZhdWx0VG9OdWxsVmFsdWUoaXRlbSwgJ3Zpc2liaWxpdHknKTtcblxuICAgICAgICAgICAgaWYoIWl0ZW0udGVtcG9yYWwpIHtcbiAgICAgICAgICAgICAgICBpdGVtLnRlbXBvcmFsID0ge3N0YXJ0RGF0ZTogbnVsbCwgZW5kRGF0ZTogbnVsbH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighaXRlbS5leHRlbnQpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmV4dGVudCA9IHsgbWlueDogLTE3OSwgbWlueTogLTg5LCBtYXh4OiAxNzksIG1heHk6IDg5IH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn1cbiJdfQ==