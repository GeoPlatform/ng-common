{"version":3,"sources":["geoplatform.common.js","module.js","directives/datepicker.js","directives/geolocation.js","directives/header-menu.js","directives/iframe.js","directives/image.js","directives/notifications.js","directives/pagination.js","directives/responsive.js","directives/slick-forms.js","directives/social.js","directives/sort.js","filters/filters.js","services/socket.js","services/uuid.js","auth.js","lang.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","_typeof","Symbol","iterator","obj","constructor","jQuery","angular","module","constant","GeoPlatform","idspUrl","idmUrl","value","directive","$timeout","scope","label","format","date","onChange","template","join","controller","$scope","$element","$attrs","toggle","event","preventDefault","stopPropagation","this","opened","promise","debounce","cancel","$watch","listener","$on","$window","restrict","btnLabel","loading","available","navigator","geolocation","error","geolocate","getCurrentPosition","position","$apply","$emit","coords","latitude","longitude","code","Config","AuthenticationService","brand","showHomeLink","transclude","replace","link","ctrl","transcludeFn","portalUrl","getUserQ","then","user","find","replaceWith","$location","update","path","homeLink","substring","menu","removeClass","dd","closest","addClass","parent","each","a","$a","$","href","attr","indexOf","homeHref","$rootScope","$root","callback","element","attrs","on","off","onImgFail","jqEl","service","Service","items","getItems","addItem","item","push","$broadcast","removeItem","bind","index","splice","msg","dismiss","type","message","canDismiss","success","info","NotificationService","expiration","timer","removeOldest","oldest","$watchCollection","Controller","ostart","start","osize","pageSize","pages","Math","ceil","maxPagination","total","numPages","currentPage","floor","s","e","min","pageStart","pageEnd","tooltip","active","pageSizeOpts","sort","previous","max","next","setPage","arg","page","setPageSize","size","hasPrevious","hasNext","provider","$windowProvider","Helper","window","$get","getWidth","innerWidth","outerWidth","isXS","isSM","width","isMD","isLG","helper","responsiveHelper","el","resizeFn","w","$attr","hh","offsetHeight","tp","changes","top","css","inputLinkFunction","ngModelController","validate","input","isDirty","hasClass","newValue","$setViewValue","$render","required","elId","random","innerValue","$viewValue","displayValue","placeholder","isReadOnly","t","readOnly","toLowerCase","edit","editing","focus","select","done","save","onKeyPress","$event","undefined","which","onKeyUp","$destroy","require","help","pattern","icon","INPUT_TEMPLATE","TEXTAREA_TEMPLATE","$filter","DATE_TEMPLATE","inline","$modelValue","copy","open","uibopts","isNaN","codeList","SELECT_TEMPLATE","getSelect","$select","selectOptions","map","opt","o","onTypeaheadSelection","$item","$model","$label","onTypeaheadKeyUp","func","wait","immediate","timeout","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","twttr","className","renderTwitterButton","url","innerHTML","widgets","createShareButton","count","text","via","hashtags","dnt","$observe","ngModel","$viewChangeListeners","$eval","ngChange","filter","endsWith","toUpperCase","arr","facetName","f","startsWith","delimiter","emptyValue","defVal","keys","SocketService","id","socket","socketId","tracking","events","CREATED","UPDATED","DELETED","EDITING","io","console","log","connect","eventName","_this","data","emit","_this2","forEach","end","close","objId","clientId","idx","factory","UUID","cache","onClose","hasOwnProperty","onbeforeunload","existing","hexDigits","substr","isDEV","location","hostname","$q","$http","User","opts","p","username","toJSON","name","email","org","clone","compare","TEST_USER","_user","TEST_NO_AUTH","STATUS","NONE","INITIALIZING","INITIALIZED","self","status","deferred","defer","getUser","resolve","check","login","current","encodeURIComponent","logout","get","response","content","JSON","parse","reject","Success","mail","first_name","last_name","organization","headers","catch","err","minimal","idpUrl","watcher","newUser","Array","results","String","str","Date","plus","offset","offsetMS","d","getTime","threshold"],"mappings":"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","file":"geoplatform.common.min.js","sourcesContent":["\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function (jQuery, angular) {\n\n    \"use strict\";\n\n    angular.module(\"gp-common\", [])\n\n    //Assumes a global has been set\n    // Don't use these... deprecated\n    .constant('idspBaseUrl', GeoPlatform.idspUrl).constant('idmBaseUrl', GeoPlatform.idmUrl)\n\n    //Assumes a global object containing configuration values for GeoPlatform exists \n    // prior to this module being declared\n    // (using 'value' since config might change)\n    .value('GPConfig', GeoPlatform);\n})(jQuery, angular);\n(function (jQuery, angular) {\n\n    'use strict';\n\n    angular.module('gp-common').directive('gpDatePicker', ['$timeout', function ($timeout) {\n\n        return {\n            scope: {\n                label: '@',\n                format: '@',\n                date: '=',\n                onChange: '&?'\n            },\n            template: ['<div class=\"input-group-slick\">', '    <input type=\"text\" class=\"form-control\" placeholder=\"{{::label}}\"', '        datepicker-popup=\"{{format}}\" ng-model=\"date\" is-open=\"opened\" />', '    <span class=\"glyphicon glyphicon-calendar\" ng-click=\"toggle($event)\"></span>', '</div>', '<p class=\"help-block\"><small><em>Ex: \"2015-01-31\" or \"Jan 31 2015\"</em></small></p>'].join(' '),\n\n            controller: function controller($scope, $element, $attrs) {\n\n                //toggle date picker\n                $scope.toggle = function (event) {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    this.opened = !this.opened;\n                };\n\n                if (!$scope.format) $scope.format = 'MMM dd yyyy';\n\n                var promise = null;\n\n                $scope.debounce = function () {\n                    if (promise) $timeout.cancel(promise);\n                    promise = $timeout(function () {\n                        promise = null;\n                        if ($scope.onChange) $scope.onChange();\n                    }, 200);\n                };\n\n                $scope.$watch('date', function () {\n                    $scope.debounce();\n                });\n\n                var listener = $scope.$on('$destroy', function () {\n\n                    listener(); //deregister listener\n\n                    if (promise) $timeout.cancel(promise);\n                    promise = null;\n\n                    $scope.opened = false; //close picker if open\n                    $scope.onChange = null;\n                    $scope.format = null;\n                    $scope.debounce = null;\n                });\n            }\n        };\n    }]);\n})(jQuery, angular);\n(function (jQuery, angular) {\n\n    \"use strict\";\n\n    angular.module(\"gp-common\")\n\n    /**\n     * Geolocation directive\n     */\n    .directive('gpGeolocation', ['$window', function ($window) {\n\n        var defaultBtnLabel = \"Locate\";\n\n        return {\n            scope: {\n                label: '=?'\n            },\n            restrict: \"EA\",\n            template: ['<a class=\"btn btn-primary\" ng-click=\"geolocate()\" ng-if=\"available\">', '  <span class=\"glyphicon glyphicon-screenshot\" ng-if=\"!loading\"></span>', '  <span class=\"glyphicon glyphicon-hourglass glyphicon-spin\" ng-if=\"loading\"></span>', '  {{btnLabel}}', '</a>', '<div ng-if=\"error\">{{error}}</div>'].join(' '),\n            controller: function controller($scope) {\n\n                $scope.btnLabel = $scope.label || defaultBtnLabel;\n                $scope.loading = false;\n                $scope.available = $window.navigator && $window.navigator.geolocation;\n\n                if (!$scope.available) $scope.error = \"Your browser does not support determining location\";\n\n                $scope.geolocate = function () {\n\n                    $scope.loading = true;\n                    $window.navigator.geolocation.getCurrentPosition(function (position) {\n\n                        $scope.$apply(function () {\n                            $scope.loading = false;\n                        });\n                        $scope.$emit('map:geolocation', position.coords.latitude, position.coords.longitude);\n                    }, function (error) {\n                        switch (error.code) {\n                            case 1:\n                                $scope.error = \"Permission was denied while attempting to determine location\";\n                                break;\n                            case 2:\n                                $scope.error = \"Unable to determine your location\";\n                                break;\n                            case 3:\n                                $scope.error = \"Unable to determine location in a reasonable amount of time\";\n                                break;\n                        }\n                    });\n                };\n            }\n        };\n    }]);\n})(jQuery, angular);\n(function (jQuery, angular) {\n\n    \"use strict\";\n\n    angular.module(\"gp-common\")\n\n    /**\n     * Header directive for GeoPlatform Angular-based web applications\n     * \n     * Uses transclusion to inject links into the nav-menu which floats to the right.\n     * The menu already provides a \"Home\" link (to app home) and Sign In/User Info button.\n     * The home link is not enabled by default but can be shown using 'show-home-link=\"true\"' \n     * parameter on the directive.\n     *\n     * Note: any links transcluded should reference '$parent.user' to access authenticated user info\n     * \n     * ex:\n     * \n     *   <div gp-header brand=\"Map Manager\" show-home-link=\"true\" class=\"navbar-fixed-top\">\n     *     <li><a href=\"#/maps\">Maps</a></li>\n     *     <li><a href=\"#/galleries\">Galleries</a></li>\n     *     <li><a ng-if=\"$parent.user!==null\" href=\"#/agol\">AGOL</a></li>\n     *     <li><a href=\"#/help\">Help</a></li>\n     *   </div>\n     */\n    .directive('gpHeader', ['GPConfig', 'AuthenticationService', function (Config, AuthenticationService) {\n\n        return {\n\n            scope: {\n                brand: \"@\",\n                showHomeLink: \"@\"\n            },\n            restrict: \"AE\",\n            transclude: true,\n            replace: true,\n            template: ['<header>', '  <div class=\"container-fluid\">', '    <div class=\"row\">', '      <div class=\"col-md-12\">', '        <ul role=\"menu\" class=\"header__menu\" gp-header-menu>', '          <li ng-if=\"showHomeLink\">', '            <a href=\"#/goHome\">', '                <span class=\"glyphicon glyphicon-home\"></span> ', '                <span class=\"hidden-xs hidden-sm\">Home</span>', '            </a>', '          </li>', '          <div class=\"transcluded\"></div>', '          <li><span gp-login-button></span></li>', '        </ul>', '        <h4 class=\"brand\">', '          <a href=\"{{portalUrl}}\" title=\"Go to the GeoPlatform Home Page\">', '            <span class=\"icon-gp\"></span>', '            <span class=\"hidden-xs\">GeoPlatform</span>', '          </a>', '          {{brand}}', '        </h4>', '      </div>', '    </div>', '  </div>', '</header>'].join(' '),\n\n            // controller: function($rootScope, $scope, $element) {\n            //     $scope.portalUrl = $rootScope.portalUrl;\n            // }, \n\n            link: function link($scope, $element, $attrs, ctrl, transcludeFn) {\n\n                $scope.showHomeLink = $scope.showHomeLink === 'true' || false;\n\n                $scope.portalUrl = Config.portalUrl;\n\n                AuthenticationService.getUserQ().then(function (user) {\n                    $scope.user = user;\n                });\n\n                $element.find('.transcluded').replaceWith(transcludeFn());\n            }\n\n        };\n    }])\n\n    /**\n     * Header Menu\n     *\n     * Monitors the current page URL and updates the header links \n     * to highlight whichever one is associated with the current page\n     *\n     * Usage: \n     *\n     *  <ul role=\"menu\" class=\"header__menu\" gp-header-menu>\n     *      <li><a href=\"#/maps\">Maps</a></li>\n     *      <li><a href=\"#/galleries\">Galleries</a></li>\n     *      ...\n     *  </ul>\n     *\n     */\n    .directive('gpHeaderMenu', ['$location', function ($location) {\n\n        //default href for \"home\" link in header__menu\n        //uses 'goHome' to avoid angular-route issues with empty hash not \n        // triggering a page reload. Relies upon the \"otherwise\" condition\n        // being configured inside a routeProvider within the application.\n        var homeLink = 'goHome';\n\n        function update($element) {\n\n            var path = $location.path();\n\n            if (path === '/' || path === '/#' || path === '/#/') path = homeLink;\n\n            if (path[0] === '/') path = path.substring(1);\n\n            var menu = $element;\n            menu.find('li.active').removeClass('active');\n\n            var link = menu.find('li > a[href=\"#/' + path + '\"]');\n            if (link.length) {\n                //check if link is within a dropdown in the header menu\n                var dd = link.closest('.dropdown-menu');\n                if (dd.length) {\n                    //find next ancestor that is a list element and mark it active\n                    dd.closest('li').addClass('active');\n                } else {\n                    //not in a dropdown, mark this link active\n                    link.parent().addClass('active');\n                }\n            }\n\n            menu.find('li > a').each(function (i, a) {\n                var $a = $(a),\n                    href = $a.attr('href');\n                if (!href) return;\n                href = href.replace('#/', '');\n                if (path.indexOf(href) === 0) $a.parent().addClass('active');\n            });\n        }\n\n        return {\n            scope: {\n                homeHref: '@'\n            },\n            restrict: \"A\",\n\n            controller: function controller($rootScope, $scope, $element) {\n                if ($scope.homeHref) homeLink = $scope.homeHref;\n            },\n\n            link: function link($scope, $element) {\n\n                update($element);\n\n                $scope.$root.$on('$locationChangeSuccess', function () {\n                    update($element);\n                });\n            }\n        };\n    }]);\n})(jQuery, angular);\n\n(function (angular) {\n\n    \"use strict\";\n\n    angular.module('gp-common').directive('iframeOnload', function () {\n        return {\n            scope: {\n                callback: '&iframeOnload'\n            },\n            link: function link(scope, element, attrs) {\n                element.on('load', function (event) {\n                    element.off('load');\n                    return scope.callback(event);\n                });\n            }\n        };\n    });\n})(angular);\n(function (angular) {\n\n    \"use strict\";\n\n    angular.module(\"gp-common\").directive('onImgFail', function () {\n        return {\n            scope: {\n                onImgFail: '@'\n            },\n            link: function link($scope, $element) {\n                var jqEl = jQuery($element);\n                jqEl.on('error', function () {\n                    jqEl.attr('src', $scope.onImgFail);\n                });\n            }\n        };\n    });\n})(angular);\n(function (angular) {\n\n    \"use strict\";\n\n    angular.module('gp-common')\n\n    //\n    .service('NotificationService', ['$rootScope', function ($rootScope) {\n        var Service = function Service() {\n            this.items = [];\n        };\n        Service.prototype = {\n            getItems: function getItems() {\n                return this.items;\n            },\n            /**\n             * @param item object\n             * @return function to cancel the notification\n             */\n            addItem: function addItem(item) {\n                this.items.push(item);\n                $rootScope.$broadcast('gp:notifications:new', item);\n\n                var fn = function fn(item) {\n                    this.removeItem(item);\n                };\n                return fn.bind(this, item);\n            },\n            removeItem: function removeItem(item) {\n                var index = this.items.indexOf(item);\n                if (index >= 0) return this.items.splice(index, 1);\n                return null;\n            },\n            error: function error(label, msg, dismiss) {\n                return this.addItem({ type: 'error', label: label, message: msg, canDismiss: dismiss });\n            },\n            success: function success(label, msg, dismiss) {\n                return this.addItem({ type: 'success', label: label, message: msg, canDismiss: dismiss });\n            },\n            info: function info(label, msg, dismiss) {\n                return this.addItem({ type: 'info', label: label, message: msg, canDismiss: dismiss });\n            }\n        };\n        return new Service();\n    }])\n\n    // Usage: <gp-notifications />\n    .directive('gpNotifications', ['$timeout', 'NotificationService', function ($timeout, NotificationService) {\n        return {\n            scope: {\n                expiration: '@'\n            },\n            template: ['<div class=\"notifications ng-hide\" ng-show=\"items.length\">', '  <div class=\"notification\" ng-repeat=\"item in items\"', '    ng-class=\"{\\'notification--success\\':item.type===\\'success\\', \\'notification--error\\':item.type===\\'error\\', \\'notification--info\\':item.type===\\'info\\'}\">', '    <h5 class=\"notification__title\">', '        <span class=\"pull-right glyphicon\" ', '            ng-class=\"{\\'glyphicon-ok-sign\\':item.type===\\'success\\',\\'glyphicon-exclamation-sign\\':item.type===\\'error\\',\\'glyphicon-info-sign\\':item.type===\\'info\\'}\">', '        </span>', '        {{item.label}}', '    </h5>', '    <p class=\"notification__content\" ng-bind-html=\"item.message\"></p>', '    <div class=\"notification__actions\" ng-if=\"item.canDismiss\">', '        <button type=\"button\" class=\"btn btn-link\" ng-click=\"dismiss(item)\">dismiss</button>', '    </div>', '  </div>', '</div>'].join(' '),\n\n            link: function link($scope, $element, $attrs) {\n\n                $scope.expiration = ($scope.expiration || 2000) * 1;\n\n                $scope.items = [];\n\n                function update() {\n                    $scope.items = NotificationService.getItems();\n\n                    //if updated before timer expired, reset timer\n                    if ($scope.timer) {\n                        $timeout.cancel($scope.timer);\n                        $scope.timer = null;\n                    }\n\n                    //set timer to kill earliest item after time\n                    $scope.timer = $timeout(function () {\n                        $scope.timer = null;\n                        //will ultimately call update() and thus trigger timeout again\n                        $scope.removeOldest();\n                    }, $scope.expiration);\n                }\n                update();\n\n                $scope.removeOldest = function () {\n                    //find oldest that can be removed\n                    var oldest = $scope.items.find(function (item) {\n                        return item.canDismiss;\n                    });\n                    if (oldest) NotificationService.removeItem(oldest);\n                };\n\n                $scope.dismiss = function (item) {\n                    //remove item using service\n                    NotificationService.removeItem(item);\n                };\n\n                $scope.$watchCollection(function () {\n                    return NotificationService.getItems();\n                }, update);\n\n                // $scope.$on('gp:notifications:new', function(event, item) { update(); });\n            }\n        };\n    }]);\n})(angular);\n(function (jQuery, angular) {\n\n    \"use strict\";\n\n    angular.module('gp-common').directive('gpPagination', function () {\n\n        function Controller($scope, $element) {\n\n            if (!$scope.pageSizeOpts) {\n                $scope.pageSizeOpts = [5, 10, 25, 50];\n            }\n            if ($scope.pageSize && $scope.pageSizeOpts.indexOf($scope.pageSize * 1) < 0) {\n                $scope.pageSizeOpts.push($scope.pageSize * 1).sort();\n            }\n\n            $scope.previous = function () {\n                $scope.start = Math.max(0, $scope.start * 1 - $scope.pageSize * 1);\n                $scope.$emit('pagination:change', $scope.start, $scope.pageSize);\n            };\n\n            $scope.next = function () {\n                $scope.start = Math.min($scope.total, $scope.start * 1 + $scope.pageSize * 1);\n                $scope.$emit('pagination:change', $scope.start, $scope.pageSize);\n            };\n\n            $scope.setPage = function (arg) {\n                var page = arg * 1;\n                $scope.start = (page - 1) * ($scope.pageSize * 1);\n                $scope.$emit('pagination:change', $scope.start, $scope.pageSize);\n            };\n\n            $scope.setPageSize = function (size) {\n\n                $scope.pageSize = size * 1;\n                //move start cursor to beginning of new current page based on updated pagesize\n                var currentPage = Math.floor($scope.start / $scope.pageSize) + 1;\n                $scope.setPage(currentPage);\n            };\n\n            $scope.hasPrevious = function () {\n                return $scope.start > 0;\n            };\n\n            $scope.hasNext = function () {\n                return $scope.start + $scope.pageSize < $scope.total;\n            };\n\n            function update() {\n\n                var ostart = $scope.start * 1;\n                var osize = $scope.pageSize * 1;\n\n                //calculate # of pages needed\n                var pages = [];\n                var maxPagination = 5;\n                var maxPaginationMidPoint = maxPagination % 2 !== 0 ? Math.ceil(maxPagination / 2) : maxPagination / 2;\n\n                if ($scope.total > 0) {\n\n                    var numPages = Math.ceil($scope.total / osize);\n                    var currentPage = Math.floor(ostart / osize);\n\n                    var s = 0;\n                    if (currentPage > Math.floor(maxPagination / 2)) {\n                        //  1 2 '3' 4 5\n                        s = currentPage - Math.floor(maxPagination / 2); //  1 2 3 '4' 5\n                        //  ...\n                    } else {\n                        //  '1' 2 3 4 5\n                        s = 0; //  1 '2' 3 4 5\n                        //  ...\n                    }\n\n                    var e = Math.min(s + maxPagination, numPages);\n\n                    //ensure at least <maxPagination> # of page links are shown\n                    // even if near the end of the results\n                    while (s > 0 && e - s < maxPagination) {\n                        s -= 1;\n                    }for (var i = s; i < e; ++i) {\n                        var pageStart = i * osize + 1;\n                        var pageEnd = Math.min(pageStart + osize - 1, $scope.total);\n                        pages.push({\n                            label: i + 1 + \"\",\n                            tooltip: \"Results \" + pageStart + \"-\" + pageEnd\n                        });\n                        if (i == currentPage) pages[pages.length - 1].active = true;\n                    }\n                }\n\n                $scope.pages = pages;\n            }\n\n            update();\n\n            $scope.$watch('start', update);\n            $scope.$watch('pageSize', update);\n            $scope.$watch('total', update);\n        }\n\n        return {\n\n            scope: {\n                start: '=',\n                pageSize: '=',\n                total: '=',\n                pageSizeOpts: '='\n            },\n            replace: true,\n            template: ['<div>', '  <div class=\"visible-xs row\">', '    <div class=\"col-xs-6\">{{total}} results</div>', '    <div class=\"col-xs-6\">', '      <select class=\"form-control\" ng-model=\"pageSize\">', '        <option ng-repeat=\"ps in pageSizeOpts\" ', '          ng-selected=\"pageSize===ps\" ', '          value=\"{{ps}}\">{{ps}} per page</option>', '      </select>', '    </div>', '  </div>', '  <ul class=\"pagination\">', '    <li class=\"info hidden-xs\">', '      <a>{{total}} results</a>', '    </li>', '    <li class=\"pagination-control hidden-xs\" ng-if=\"total>0\">', '      <span uib-dropdown>', '        <a href=\"\" uib-dropdown-toggle title=\"Change the number of results returned\">', '          {{pageSize}} per page <span class=\"caret\"></span>', '        </a>', '        <ul class=\"dropdown-menu\" role=\"menu\">', '          <li ng-repeat=\"ps in pageSizeOpts\"><a ng-click=\"setPageSize(ps)\">{{ps}} per page</a></li>', '        </ul>', '      </span>', '    </li>', '    <li class=\"separator hidden-xs\"></li>', '    <li ng-if=\"hasPrevious()\">', '      <a ng-click=\"previous()\">', '        <span class=\"glyphicon glyphicon-backward\"></span>', '      </a>', '    </li>', '    <li ng-repeat=\"page in pages\" ng-class=\"{active:page.active,disabled:page.disabled}\">', '      <a ng-click=\"setPage(page.label)\" title=\"{{::page.tooltip}}\">{{::page.label}}</a>', '    </li>', '    <li ng-if=\"hasNext()\">', '      <a ng-click=\"next()\">', '        <span class=\"glyphicon glyphicon-forward\"></span>', '      </a>', '    </li>', '  </ul>', '</div>'].join(' '),\n\n            controller: Controller\n\n        };\n    });\n})(jQuery, angular);\n(function (jQuery, angular) {\n\n    \"use strict\";\n\n    angular.module('gp-common')\n\n    //helper to determine size of window for responsive breakpoint purposes\n    .provider('responsiveHelper', [\"$windowProvider\", function ($windowProvider) {\n\n        var $window = $windowProvider.$get();\n\n        function Helper($window) {\n            this.window = $window;\n        }\n        Helper.prototype = {\n            getWidth: function getWidth() {\n                return $window.innerWidth || $window.outerWidth;\n            },\n            isXS: function isXS() {\n                var width = this.getWidth();return width < 768;\n            },\n            isSM: function isSM() {\n                var width = this.getWidth();return width >= 768 && width < 992;\n            },\n            isMD: function isMD() {\n                var width = this.getWidth();return width >= 992 && width < 1200;\n            },\n            isLG: function isLG() {\n                var width = this.getWidth();return width >= 1200;\n            }\n        };\n\n        var helper = new Helper($window);\n\n        this.$get = function () {\n            return helper;\n        };\n    }])\n\n    //directive which appends appropriate responsive breakpoint classNames to the element\n    // on which it's set\n    .directive('gpResponsive', ['$window', 'responsiveHelper', function ($window, responsiveHelper) {\n\n        return {\n            restrict: \"A\",\n            link: function link($scope, $element, $attrs) {\n\n                function update(el, helper) {\n                    if (helper.isXS()) el.addClass('gp-responsive-xs');else el.removeClass('gp-responsive-xs');\n\n                    if (helper.isSM()) el.addClass('gp-responsive-sm');else el.removeClass('gp-responsive-sm');\n\n                    if (helper.isMD()) el.addClass('gp-responsive-md');else el.removeClass('gp-responsive-md');\n\n                    if (helper.isLG()) el.addClass('gp-responsive-lg');else el.removeClass('gp-responsive-lg');\n                }\n\n                update($element, responsiveHelper);\n\n                var resizeFn = function resizeFn() {\n                    update($element, responsiveHelper);\n                };\n\n                var w = angular.element($window);\n                var listener = w.on('resize', resizeFn);\n\n                $scope.$on('$destroy', function () {\n                    w.off('resize', resizeFn);\n                });\n            }\n        };\n    }]).directive('gpResize', function ($window, $timeout) {\n        return function ($scope, $element, $attr) {\n\n            var resizeFn = function resizeFn() {\n                var hh = jQuery('header')[0].offsetHeight;\n                // var fh = jQuery('footer')[0].offsetHeight;\n                // console.log('hh & fh', hh, fh);                    \n\n                var tp = hh + 2;\n                // var bt = fh + 2;\n                // console.log('tp & bt', tp, bt);                \n\n                var changes = {\n                    // bottom: bt + 'px',\n                    top: tp + 'px'\n                };\n                $element.css(changes);\n                $scope.$apply();\n            };\n\n            var w = angular.element($window);\n            w.on('resize', resizeFn);\n\n            $timeout(resizeFn, 200);\n\n            $scope.$on('$destroy', function () {\n                w.off('resize', resizeFn);\n            });\n        };\n    });\n})(jQuery, angular);\n(function (jQuery, angular) {\n\n    \"use strict\";\n\n    function inputLinkFunction($scope, $element, $attrs, ngModelController, $timeout) {\n\n        if (!$scope.type) $scope.type = \"text\";\n        if ($scope.required === 'true') $scope.required = true;else $scope.required = false;\n\n        $scope.elId = 'input_' + Math.ceil(Math.random() * 9999);\n        $scope.size = $scope.size || 'medium';\n        $scope.type = $scope.type || 'text';\n\n        //listen for changes to the inner value by way of the form-control\n        $element.find('.form-control').on('change', function onChange() {\n            validate($scope.innerValue);\n        });\n\n        /* ------------- private methods --------------- */\n\n        function validate() {\n\n            //check form-control for ng-invalid\n            var input = $element.find('.form-control');\n\n            $scope.isDirty = input.hasClass('ng-dirty');\n\n            if (input.hasClass('ng-invalid')) {\n                if (input.hasClass(\"ng-empty\")) $scope.error = \"This field requires a value\";else $scope.error = \"Invalid value provided\";\n            } else $scope.error = null;\n        }\n\n        function update(newValue) {\n            // call $parsers pipeline then update $modelValue\n            ngModelController.$setViewValue(newValue);\n            // update the local view\n            ngModelController.$render();\n        }\n\n        // when model change, update our view (just update the div content)\n        ngModelController.$render = function () {\n\n            var value = ngModelController.$viewValue;\n\n            //create copy of passed in model value that can be used\n            // by the controls here allowing us to cancel and \n            // commit changes at our own leisure\n            $scope.innerValue = value;\n\n            $scope.displayValue = value || $scope.placeholder || \"No value provided\";\n\n            validate(value);\n        };\n\n        /* ------------- private methods --------------- */\n\n        $scope.isReadOnly = function () {\n            var t = _typeof(this.readOnly);\n            if (t === 'undefined') return false;\n            if (t === 'string') return this.readOnly.toLowerCase() === 'true';\n            if (t === 'number') return this.readOnly === 1;\n            if (t === 'boolean') return this.readOnly;\n            return false;\n        };\n\n        //enter edit mode\n        $scope.edit = function () {\n            if ($scope.isReadOnly()) return;\n            $scope.editing = true;\n            //auto-focus on form-control when entering edit mode\n            $timeout(function () {\n                $element.find('.form-control').focus().select();\n            }, 200);\n        };\n        //leave edit mode (regardless of save() or cancel())\n        $scope.done = function () {\n            $scope.editing = false;\n            $scope.error = null;\n        };\n\n        $scope.save = function () {\n            //update display with new value\n            update($scope.innerValue);\n            $scope.done();\n        };\n        $scope.cancel = function () {\n            //reset inner value\n            $scope.innerValue = ngModelController.$viewValue;\n            $scope.done();\n        };\n\n        $scope.onKeyPress = function ($event, code) {\n            // console.log(\"Pressed \" + code);\n            if ((code === undefined || code === 0) && $event.which !== undefined) code = $event.which;\n            if ($scope.type === 'number') {\n\n                //NOTE: Chrome does not catch Backspace onKeyPress, so it \n                // skips this handler. FF does, so we need to watch for \n                // backspace, delete, and numbers\n\n                if (code === 8 || //backspace\n                code === 46 || //delete  \n                code >= 44 && code <= 57) //comma, hyphen, period and numbers (0-9)\n                    return;\n\n                //NOTE: keyPress period is 46. keyDown it is 190\n\n                $event.preventDefault();\n                return false; //ignore key\n            }\n        };\n        $scope.onKeyUp = function ($event, code) {\n            // console.log(\"Up \" + code);\n            if ((code === undefined || code === 0) && $event.which !== undefined) code = $event.which;\n            if (code === 13 && !$scope.error) $scope.done(); //enter\n            else if (code === 27) $scope.cancel(); //esc\n                else {\n\n                        if (code !== 8 && //backspace\n                        code !== 46 && //delete\n                        code !== 190 && ( //period\n                        code < 48 || code > 90) && ( //letters and numbers (a-z, 0-9)\n                        code < 106 || code > 111) && code < 186) return;\n\n                        validate();\n                    }\n        };\n\n        $scope.$destroy = function () {\n            $element.off('change');\n        };\n    }\n\n    angular.module(\"gp-common\").directive('gpSlickFormInput', ['$timeout', function ($timeout) {\n\n        return {\n            restrict: 'AE',\n            require: 'ngModel',\n            scope: {\n                label: \"@\",\n                placeholder: '@',\n                help: '=',\n                // validator: '&',\n                // validationExpr: '@',\n                type: '@',\n                pattern: \"@\",\n                required: '@',\n                readOnly: '@',\n                size: '@',\n                icon: '@'\n            },\n            template: INPUT_TEMPLATE,\n            link: function link($scope, $element, $attrs, ngModelController) {\n                inputLinkFunction($scope, $element, $attrs, ngModelController, $timeout);\n            }\n        };\n    }]).directive('gpSlickFormTextarea', ['$timeout', function ($timeout) {\n\n        return {\n            restrict: 'AE',\n            require: 'ngModel',\n            scope: {\n                label: \"@\",\n                placeholder: '@',\n                help: \"@\",\n                readOnly: \"@\",\n                size: \"@\",\n                icon: \"@\"\n            },\n            template: TEXTAREA_TEMPLATE,\n            link: function link($scope, $element, $attrs, ngModelController) {\n                inputLinkFunction($scope, $element, $attrs, ngModelController, $timeout);\n            }\n        };\n    }])\n\n    /**\n     *\n     * Notes:\n     *  - use 'form form-inline' classes for editable date so the field doesn't take up whole line\n     */\n    .directive('gpSlickFormDate', ['$timeout', '$filter', function ($timeout, $filter) {\n\n        return {\n            restrict: 'AE',\n            require: 'ngModel',\n            scope: {\n                label: \"@\",\n                format: \"@\",\n                placeholder: '@',\n                required: \"@\",\n                readOnly: \"@\",\n                size: '@',\n                icon: '@'\n            },\n            template: DATE_TEMPLATE,\n\n            controller: function controller($scope, $element) {\n                if (!$scope.format || $scope.format.length < 3) $scope.format = \"mediumDate\";\n                $scope.inline = $element.hasClass(\"inline\");\n            },\n\n            /**\n             *\n             */\n            link: function link($scope, $element, $attrs, ngModelController) {\n\n                if ($scope.required === 'true') $scope.required = true;else $scope.required = false;\n\n                $scope.elId = 'input_' + Math.ceil(Math.random() * 9999);\n                $scope.size = $scope.size || 'medium';\n                $scope.type = $scope.type || 'text';\n\n                function validate(value) {\n                    // console.log(\"Validating '\" + value + \"'\");\n\n                    //check form-control for ng-invalid\n                    var input = $element.find('.form-control');\n                    if (input.hasClass('ng-invalid')) {\n                        if (input.hasClass(\"ng-empty\")) $scope.error = \"This field requires a value\";else $scope.error = \"Invalid value provided\";\n                    } else $scope.error = null;\n                }\n\n                function update(newValue) {\n                    // call $parsers pipeline then update $modelValue\n                    ngModelController.$setViewValue(newValue);\n                    // update the local view\n                    ngModelController.$render();\n                }\n\n                // when model change, update our view (just update the div content)\n                ngModelController.$render = function () {\n\n                    var value = ngModelController.$viewValue;\n\n                    //create copy of passed in model value that can be used\n                    // by the controls here allowing us to cancel and \n                    // commit changes at our own leisure\n                    $scope.innerValue = value;\n\n                    $scope.displayValue = value ? $filter('date')(ngModelController.$modelValue, $scope.format) : $scope.placeholder || \"No value provided\";\n\n                    validate(value);\n                };\n\n                $scope.isReadOnly = function () {\n                    var t = _typeof(this.readOnly);\n                    if (t === 'undefined') return false;\n                    if (t === 'string') return this.readOnly.toLowerCase() === 'true';\n                    if (t === 'number') return this.readOnly === 1;\n                    if (t === 'boolean') return this.readOnly;\n                    return false;\n                };\n\n                //enter edit mode\n                $scope.edit = function () {\n                    if ($scope.isReadOnly()) return;\n\n                    $scope.editing = true;\n\n                    //auto-focus on form-control when entering edit mode\n                    // $timeout(function() { $element.find('.form-control').focus().select(); }, 200);\n                };\n                //leave edit mode (regardless of save() or cancel())\n                $scope.done = function () {\n                    $scope.opened = false;\n                    $scope.editing = false;\n                    $scope.error = null;\n                };\n\n                $scope.save = function () {\n                    //update display with new value\n                    update($scope.innerValue);\n                    $scope.done();\n                };\n                $scope.cancel = function () {\n                    //reset inner value\n                    $scope.innerValue = angular.copy(ngModelController.$modelValue);\n                    $scope.done();\n                };\n\n                $scope.open = function () {\n                    //must wrap 'opened' variable in an object for \n                    // angular to properly track its value changes\n                    // from within children scope (ie, the date picker)\n                    if (typeof $scope.uibopts === 'undefined') {\n                        $scope.uibopts = {};\n                    }\n                    $scope.uibopts.opened = true;\n                };\n\n                $scope.onKeyUp = function (code) {\n                    if (code === 13) {\n                        //enter\n                        $scope.done();\n                    } else if (code === 27) {\n                        //esc\n                        $scope.cancel();\n                    }\n                };\n                $scope.onChange = function (date) {\n                    if (isNaN(ngModelController.$modelValue) && $scope.required) {\n                        $scope.error = \"This field requires a value\";\n                    } else $scope.error = null;\n                };\n            }\n        };\n    }]).directive('gpSlickFormSelect', ['$timeout', function ($timeout) {\n\n        return {\n            restrict: 'AE',\n            require: 'ngModel',\n            scope: {\n                label: \"@\",\n                codeList: \"=\",\n                help: '=',\n                required: \"@\",\n                readOnly: \"@\",\n                size: '@',\n                icon: '@'\n            },\n            template: SELECT_TEMPLATE,\n            link: function link($scope, $element, $attrs, ngModelController) {\n\n                if (!$scope.type) $scope.type = \"text\";\n                if ($scope.required === 'true') $scope.required = true;else $scope.required = false;\n\n                $scope.elId = 'input_' + Math.ceil(Math.random() * 9999);\n                $scope.size = $scope.size || 'medium';\n                $scope.type = $scope.type || 'text';\n\n                var $select = null;\n\n                function getSelect() {\n                    if (!$select || !$select.length) $select = $element.find('.form-control');\n                    return $select;\n                }\n\n                if ($scope.codeList) {\n                    $scope.selectOptions = $scope.codeList.map(function (item) {\n                        if ((typeof item === \"undefined\" ? \"undefined\" : _typeof(item)) !== 'object' || !item.value) return { value: item, label: item };else if (!item.label) return { value: item.value, label: item.value };\n                        return item;\n                    });\n                } else $scope.selectOptions = [];\n\n                //listen for changes to the inner value by way of the form-control\n                // $element.find('.form-control').on('change', function onChange() { \n                //     validate($scope.innerValue); \n                // });\n\n\n                /* ------------- private methods --------------- */\n\n                function validate() {\n\n                    //check form-control for ng-invalid\n                    var select = getSelect();\n\n                    $scope.isDirty = select.hasClass('ng-dirty');\n\n                    if (select.hasClass('ng-invalid')) {\n                        if (select.hasClass(\"ng-empty\")) $scope.error = \"This field requires a value\";else $scope.error = \"Invalid value provided\";\n                    } else $scope.error = null;\n                }\n\n                function update(newValue) {\n                    // call $parsers pipeline then update $modelValue\n                    ngModelController.$setViewValue(newValue);\n                    // update the local view\n                    ngModelController.$render();\n                }\n\n                // when model change, update our view (just update the div content)\n                ngModelController.$render = function () {\n\n                    var value = ngModelController.$viewValue;\n\n                    //@see https://github.com/angular/angular.js/commit/7fda214c4f65a6a06b25cf5d5aff013a364e9cef\n\n                    //create copy of passed in model value that can be used\n                    // by the controls here allowing us to cancel and \n                    // commit changes at our own leisure\n                    $scope.innerValue = value;\n\n                    $scope.displayValue = $scope.placeholder || \"No value provided\";\n\n                    if (value) {\n                        //values are objects, not literals\n                        var opt = $scope.selectOptions.find(function (o) {\n                            return o.value == value;\n                        });\n                        $scope.displayValue = opt.label;\n                    }\n\n                    validate();\n                };\n\n                /* ------------- private methods --------------- */\n\n                $scope.onChange = function (value) {\n\n                    // console.log(\"Changing value \" + value + \" vs \" + $scope.innerValue);\n                    $scope.innerValue = value;\n                    $timeout(function () {\n                        validate();\n                    }, 200);\n                };\n\n                $scope.onTypeaheadSelection = function ($item, $model, $label, $event) {\n\n                    $scope.innerValue = $item ? $item.value : null;\n                    $timeout(function () {\n                        validate();\n                    }, 200);\n                };\n\n                $scope.isReadOnly = function () {\n                    var t = _typeof(this.readOnly);\n                    if (t === 'undefined') return false;\n                    if (t === 'string') return this.readOnly.toLowerCase() === 'true';\n                    if (t === 'number') return this.readOnly === 1;\n                    if (t === 'boolean') return this.readOnly;\n                    return false;\n                };\n\n                //enter edit mode\n                $scope.edit = function () {\n                    if ($scope.isReadOnly()) return;\n                    $scope.editing = true;\n                    //auto-focus on form-control when entering edit mode\n                    $timeout(function () {\n                        $select.focus().select();\n                    }, 200);\n                };\n                //leave edit mode (regardless of save() or cancel())\n                $scope.done = function () {\n                    $scope.editing = false;\n                    $scope.error = null;\n                };\n\n                $scope.save = function () {\n                    //update display with new value\n                    update($scope.innerValue);\n                    $scope.done();\n                };\n                $scope.cancel = function () {\n                    //reset inner value\n                    $scope.innerValue = ngModelController.$viewValue;\n                    $scope.done();\n                };\n\n                $scope.onKeyUp = function (code) {\n                    if (code === 13 && !$scope.error) {\n                        //enter\n                        $scope.save();\n                    } else if (code === 27) {\n                        //esc\n                        $scope.cancel();\n                    }\n                };\n\n                $scope.onTypeaheadKeyUp = function (code) {\n                    validate();\n                };\n\n                $scope.$destroy = function () {\n                    // $element.off('change');\n                };\n            }\n        };\n    }]);\n\n    var INPUT_TEMPLATE = ['<div class=\"form-group form-group-slick\">', '   <label for=\"{{::elId}}\" class=\"control-label\">{{::label}}</label>', '   <div class=\"input__display\" ', '       ng-class=\"{\\'is-read-only\\':isReadOnly(), \\'has-error\\':!!error,\\'text-lg\\':size===\\'large\\'}\" ', '       ng-show=\"!editing\" ng-click=\"edit()\" ', '       title=\"{{!!error?error:(!isReadOnly()?\\'Click to edit\\':\\'\\')}}\">', '      {{displayValue}}', '   </div>', '   <div ng-show=\"editing\">', '      <div class=\"input-group\" ng-class=\"{\\'input-group-lg\\':size===\\'large\\'}\">', '           <div class=\"input-group-slick\" ng-class=\"{\\'input-group-slick--lg\\':size===\\'large\\'}\">', '               <span ng-if=\"icon\" class=\"{{::icon}}\"></span>', '               <input id=\"{{::elId}}\" type=\"{{::type}}\" class=\"form-control\" ', '                   pattern=\"{{pattern}}\" ', '                   ng-model=\"innerValue\" ', '                   ng-required=\"{{required}}\" ', '                   ng-keypress=\"onKeyPress($event, $event.keyCode)\" ', '                   ng-keyup=\"onKeyUp($event, $event.keyCode)\" >', '               <span class=\"indicators\">', '                   <span class=\"is-valid glyphicon glyphicon-ok-sign\"></span>', '                  <span class=\"is-invalid glyphicon glyphicon-exclamation-sign\"></span>', '              </span>', '           </div>', '          <span class=\"input-group-btn\">', '               <button type=\"button\" class=\"btn btn-default\" ', '                   ng-class=\"{\\'btn-lg\\':size===\\'large\\'}\"', '                   ng-click=\"cancel()\" title=\"Cancel changes\">', '                   <span class=\"glyphicon glyphicon-ban-circle\"></span>', '              </button>', '               <button type=\"button\" class=\"btn btn-default\" ', '                   ng-class=\"{disabled:!!error||!isDirty,\\'btn-lg\\':size===\\'large\\'}\"', '                   ng-disabled=\"{{!!error}}\" ', '                   ng-click=\"save()\" title=\"Save changes\">', '                  <span class=\"glyphicon glyphicon-ok\"></span>', '               </button>', '           </span>', '       </div>', '       <div ng-if=\"error && error.length\"><small class=\"help-block text-danger\">{{error}}</small></div>', '       <div ng-if=\"help && help.length\"><small class=\"help-block\">{{help}}</small></div>', '   </div>', '</div>'].join(' ');\n\n    var TEXTAREA_TEMPLATE = ['<div class=\"form-group form-group-slick\">', '   <label for=\"{{::elId}}\" class=\"control-label\">{{::label}}</label>', '   <div class=\"input__display\" ', '       ng-class=\"{\\'is-read-only\\':isReadOnly(), \\'has-error\\':!!error,\\'text-lg\\':size===\\'large\\'}\" ', '       ng-show=\"!editing\" ng-click=\"edit()\" ', '       title=\"{{!!error?error:(!isReadOnly()?\\'Click to edit\\':\\'\\')}}\">', '      {{displayValue}}', '   </div>', '   <div ng-show=\"editing\">', '      <div class=\"input-group\" ng-class=\"{\\'input-group-lg\\':size===\\'large\\'}\">', '           <div class=\"input-group-slick\" ng-class=\"{\\'input-group-slick--lg\\':size===\\'large\\'}\">', '               <span ng-if=\"icon\" class=\"{{::icon}}\"></span>', '               <textarea rows=\"3\" id=\"{{::elId}}\" class=\"form-control\" ', '                   ng-required=\"{{required}}\" ng-model=\"innerValue\"', '                   ng-keypress=\"onKeyPress($event, $event.keyCode)\" ', '                   ng-keyup=\"onKeyUp($event, $event.keyCode)\"></textarea>', '               <span class=\"indicators\">', '                   <span class=\"is-valid glyphicon glyphicon-ok-sign\"></span>', '                  <span class=\"is-invalid glyphicon glyphicon-exclamation-sign\"></span>', '              </span>', '           </div>', '          <span class=\"input-group-btn\">', '               <button type=\"button\" class=\"btn btn-default\" ', '                   ng-class=\"{\\'btn-lg\\':size===\\'large\\'}\"', '                   ng-click=\"cancel()\" title=\"Cancel changes\">', '                   <span class=\"glyphicon glyphicon-ban-circle\"></span>', '              </button>', '               <button type=\"button\" class=\"btn btn-default\" ', '                   ng-class=\"{disabled:!!error||!isDirty,\\'btn-lg\\':size===\\'large\\'}\"', '                   ng-disabled=\"{{!!error}}\" ', '                   ng-click=\"save()\" title=\"Save changes\">', '                  <span class=\"glyphicon glyphicon-ok\"></span>', '               </button>', '           </span>', '       </div>', '       <div ng-if=\"error && error.length\"><small class=\"help-block text-danger\">{{error}}</small></div>', '       <div ng-if=\"help && help.length\"><small class=\"help-block\">{{help}}</small></div>', '   </div>', '</div>'].join(' ');\n\n    var DATE_TEMPLATE = ['<div class=\"form-group form-group-slick\">', '   <label for=\"{{::elId}}\" class=\"control-label\">{{::label}}</label>', '   <div class=\"input__display\" ', '       ng-class=\"{\\'is-read-only\\':isReadOnly(), \\'has-error\\':!!error}\" ', '       ng-show=\"!editing\" ng-click=\"edit()\" ', '       title=\"{{!!error?error:(!isReadOnly()?\\'Click to edit\\':\\'\\')}}\">', '      {{displayValue}}', '   </div>', '   <div ng-show=\"editing\">', '       <div uib-datepicker ng-required=\"{{required}}\" ng-model=\"innerValue\" datepicker-options=\"{showWeeks:false}\"></div>', '       <div ng-if=\"error && error.length\"><small class=\"help-block text-danger\">{{error}}</small></div>', '       <div ng-if=\"help && help.length\"><small class=\"help-block\">{{help}}</small></div>', '       <button type=\"button\" class=\"btn btn-default\" ', '           ng-class=\"{\\'btn-lg\\':size===\\'large\\'}\"', '           ng-click=\"cancel()\" title=\"Cancel changes\">', '           <span class=\"glyphicon glyphicon-ban-circle\"></span>', '      </button>', '      <button type=\"button\" class=\"btn btn-default\" ', '           ng-class=\"{disabled:!!error,\\'btn-lg\\':size===\\'large\\'}\"', '          ng-disabled=\"{{!!error}}\" ', '           ng-click=\"save()\" title=\"Save changes\">', '           <span class=\"glyphicon glyphicon-ok\"></span>', '      </button>', '   </div>', '</div>'].join(' ');\n\n    var SELECT_TEMPLATE = ['<div class=\"form-group form-group-slick\">', '   <label for=\"{{::elId}}\" class=\"control-label\">{{::label}}</label>', '   <div class=\"input__display\" ', '       ng-class=\"{\\'is-read-only\\':isReadOnly(), \\'has-error\\':!!error}\" ', '       ng-show=\"!editing\" ng-click=\"edit()\" ', '       title=\"{{!!error?error:(!isReadOnly()?\\'Click to edit\\':\\'\\')}}\">', '      {{displayValue}}', '   </div>', '   <div ng-show=\"editing\">', '      <div class=\"input-group\" ng-class=\"{\\'input-group-lg\\':size===\\'large\\'}\">', '           <div class=\"input-group-slick\" ng-class=\"{\\'input-group-slick--lg\\':size===\\'large\\'}\">', '               <span ng-if=\"icon\" class=\"{{::icon}}\"></span>', '               <select class=\"form-control input__field\" ', '                   ng-if=\"codeList.length<=12\" ', '                   ng-model=\"innerValue\" ', '                   ng-options=\"opt.value as opt.label for opt in selectOptions\" ', '                   ng-required=\"{{required}}\" ', '                   ng-change=\"onChange(innerValue)\" ', '                   ng-keyUp=\"onKeyUp($event.keyCode)\" >', '                   <option value=\"\">Select One</option>', '               </select>', '               <input type=\"text\" class=\"form-control input__field\" ng-if=\"codeList.length>12\" ', '                   ng-model=\"innerValue\" ', '                   ng-required=\"{{required}}\" ', '                   ng-keyUp=\"onTypeaheadKeyUp($event.keyCode)\" ', '                   typeahead-on-select=\"onTypeaheadSelection($item, $model, $label, $event)\" ', '                   uib-typeahead=\"opt.value as opt.label for opt in selectOptions | filter:{value:$viewValue} | limitTo:12\" ', '                   typeahead-min-length=\"0\" ', '                   typeahead-editable=\"false\">', '               <span class=\"indicators\">', '                   <span class=\"is-valid glyphicon glyphicon-ok-sign\"></span>', '                  <span class=\"is-invalid glyphicon glyphicon-exclamation-sign\"></span>', '              </span>', '           </div>', '          <span class=\"input-group-btn\">', '               <button type=\"button\" class=\"btn btn-default\" ', '                   ng-class=\"{\\'btn-lg\\':size===\\'large\\'}\"', '                   ng-click=\"cancel()\" title=\"Cancel changes\">', '                   <span class=\"glyphicon glyphicon-ban-circle\"></span>', '              </button>', '               <button type=\"button\" class=\"btn btn-default\" ', '                   ng-class=\"{disabled:!!error||!isDirty,\\'btn-lg\\':size===\\'large\\'}\"', '                   ng-disabled=\"{{!!error}}\" ', '                   ng-click=\"save()\" title=\"Save changes\">', '                  <span class=\"glyphicon glyphicon-ok\"></span>', '               </button>', '           </span>', '       </div>', '       <div ng-if=\"error && error.length\"><small class=\"help-block text-danger\">{{error}}</small></div>', '       <div ng-if=\"help && help.length\"><small class=\"help-block\">{{help}}</small></div>', '   </div>', '</div>'].join(' ');\n})(jQuery, angular);\n(function (angular) {\n\n    \"use strict\";\n\n    angular.module(\"gp-common\").directive('gpTweetButton', ['$timeout', function ($timeout) {\n\n        function debounce(func, wait, immediate) {\n            var timeout;\n            return function () {\n                var context = this,\n                    args = arguments;\n                var later = function later() {\n                    timeout = null;\n                    if (!immediate) func.apply(context, args);\n                };\n                var callNow = immediate && !timeout;\n                clearTimeout(timeout);\n                timeout = setTimeout(later, wait);\n                if (callNow) func.apply(context, args);\n            };\n        }\n\n        return {\n            link: function link(scope, element, attr) {\n\n                if (typeof twttr === 'undefined') {\n                    element.className += ' disabled';\n                    return;\n                }\n\n                var renderTwitterButton = debounce(function () {\n                    if (attr.url) {\n                        $timeout(function () {\n                            element[0].innerHTML = '';\n                            twttr.widgets.createShareButton(attr.url, element[0], function () {}, {\n                                count: attr.count,\n                                text: attr.text,\n                                via: attr.via,\n                                size: attr.size,\n                                hashtags: attr.hashtags,\n                                dnt: attr.dnt\n                            });\n                        });\n                    }\n                }, 75);\n                attr.$observe('url', renderTwitterButton);\n                attr.$observe('text', renderTwitterButton);\n            }\n        };\n    }]);\n})(angular);\n(function (angular) {\n\n    \"use strict\";\n\n    angular.module(\"gp-common\").directive('sortOrder', function () {\n        return {\n\n            replace: true,\n            require: 'ngModel',\n\n            template: ['<div>', '<a class=\"btn btn-default\" title=\"Click to sort in ascending order\" href ng-if=\"value===\\'dsc\\'\" ng-click=\"toggle()\">', '    <span class=\"glyphicon glyphicon-sort-by-attributes-alt\"></span>', '</a>', '<a class=\"btn btn-default\" title=\"Click to sort in descending order\" href ng-if=\"value===\\'asc\\'\" ng-click=\"toggle()\">', '    <span class=\"glyphicon glyphicon-sort-by-attributes\"></span>', '</a>', '</div>'].join(' '),\n\n            link: function link($scope, element, attrs, ngModel) {\n                ngModel.$viewChangeListeners.push(function () {\n                    $scope.$eval(attrs.ngChange);\n                });\n                ngModel.$render = function () {\n                    $scope.value = ngModel.$modelValue;\n                };\n                $scope.toggle = function () {\n                    $scope.value = $scope.value === 'asc' ? 'dsc' : 'asc';\n                    ngModel.$setViewValue($scope.value);\n                };\n            }\n        };\n    });\n})(angular);\n(function (jQuery, angular) {\n\n    \"use strict\";\n\n    angular.module(\"gp-common\")\n\n    /**\n     * Custom filter to make label values visually helpful by \n     * replacing bad characters with spaces or meaningful equivalents\n     */\n    .filter('fixLabel', function () {\n        return function (input) {\n            input = input || '';\n            return input.replace(/_/g, ' ');\n        };\n    }).filter('pluralize', function () {\n        return function (text) {\n            if (!text || !text.length) return \"\";\n            if (text.endsWith('ss')) return text + 'es'; //classes, etc\n            if (text.endsWith('s')) return text; //already plural\n            return text + 's';\n            //TODO support irregular words like \"foot\" -> \"feet\"\n            // and words that need duplicate letters: \"quiz\" -> \"quizzes\"\n        };\n    }).filter('capitalize', function () {\n        return function (text) {\n            return text[0].toUpperCase() + text.substring(1);\n        };\n    }).filter('facets', function () {\n\n        return function (arr, facetName) {\n            if (!facetName) return arr;\n            if (!arr || !arr.length) return [];\n            return arr.filter(function (f) {\n                return f.toLowerCase().startsWith(facetName + \":\");\n            }).map(function (f) {\n                return f.substring(f.indexOf(':') + 1, f.length);\n            });\n        };\n    }).filter('joinBy', function () {\n        return function (input, delimiter, emptyValue) {\n            if (input.length) return input.join(delimiter || ', ');else return emptyValue || '';\n        };\n    }).filter('defaultValue', function () {\n        return function (text, defVal) {\n            if (typeof text === 'undefined' || !text.length) return defVal;\n            return text;\n        };\n    }).filter('count', function () {\n        return function (input) {\n            if (typeof input !== 'undefined') {\n                if (typeof input.push === 'function') return input.length;\n                if ((typeof input === \"undefined\" ? \"undefined\" : _typeof(input)) === 'object') {\n                    if (typeof Object.keys !== 'undefined') {\n                        return Object.keys(input);\n                    }\n                }\n            }\n            return 0;\n        };\n    });\n})(jQuery, angular);\n(function (angular) {\n\n    'use strict';\n\n    /* *********************************************\n     * Requires socket.io be in the global namespace\n     * tested with version 2.x\n     * ********************************************* */\n\n    /*\n       Usage:\n        let service = ...\n        let svcId = service.getId();\n        //listen to events from the server\n       service.on('testing', (event) => { \n           if(event.clientId === svcId) return; //ignore our own events\n           ... do something ...\n       });\n       \n       //sends out a message to others\n       service.emit( service.events.CREATED, 'test');\n        //sends out a message to others\n       service.begin(service.events.EDITING, 'test');\n        //sends out a message to others\n       service.end(service.events.EDITING, 'test');\n        //stop listening and close the socket\n       service.close();\n      */\n\n    var SocketService = function () {\n        function SocketService(id, url) {\n            _classCallCheck(this, SocketService);\n\n            this.socket = null;\n            this.socketId = id;\n\n            //list of ids of things being tracked, such as \n            // items edited, in order to send messages\n            // about the things lifecycle\n            this.tracking = [];\n\n            //events supported.\n            // Note that lifecycles can be added by using the \n            // begin() and end() methods on the service,\n            // which appends '_start' and '_end' respectively\n            this.events = {\n                CREATED: 'created',\n                UPDATED: 'updated',\n                DELETED: 'deleted',\n                EDITING: 'editing'\n            };\n\n            if (typeof io === 'undefined') {\n                console.log(\"Socket.IO not found in global namespace\");\n                return;\n            }\n\n            if (!url) {\n                //TODO validate URL with regex?\n                console.log(\"No web socket URL configured for this app to communicate with\");\n                return;\n            }\n\n            this.socket = io.connect(url);\n        }\n\n        _createClass(SocketService, [{\n            key: \"getId\",\n            value: function getId() {\n                return this.socketId;\n            }\n\n            /**\n             * @param {string} eventName\n             * @param {Function} callback\n             * @return {Function} to remove the listener\n             */\n\n        }, {\n            key: \"on\",\n            value: function on(eventName, callback) {\n                var _this = this;\n\n                if (!this.socket) return;\n\n                // let handle =  () => {  \n                //     var args = arguments;\n                //     $rootScope.$apply( () => {\n                //         callback.apply(this.socket, args);\n                //     });\n                // };\n\n                this.socket.on(eventName, callback);\n\n                return function () {\n                    _this.socket.off(eventName, callback);\n                };\n            }\n\n            /**\n             *\n             */\n\n        }, {\n            key: \"emit\",\n            value: function emit(eventName, data /*, callback*/) {\n                if (!this.socket) return;\n\n                this.socket.emit(eventName, data, function () {\n                    /*\n                    var args = arguments;\n                    $rootScope.$apply(() => {\n                        if (callback) {\n                            callback.apply(this.socket, args);\n                        }\n                    });\n                    */\n                });\n            }\n\n            /**\n             * Closes this service's socket\n             */\n\n        }, {\n            key: \"close\",\n            value: function close() {\n                var _this2 = this;\n\n                //if this app was editing an obj, notify listeners that it is no longer\n                if (this.tracking && this.tracking.length) {\n                    angular.forEach(this.tracking, function (id) {\n                        _this2.end(id);\n                    });\n                }\n\n                if (this.socket) {\n                    this.socket.close();\n                    this.socket = null;\n                }\n\n                return null;\n            }\n\n            /**\n             * @param {string} event - name of the event being started\n             * @param {string} objId - identifier of the item being tracked\n             */\n\n        }, {\n            key: \"begin\",\n            value: function begin(event, objId) {\n                this.tracking.push(objId);\n                this.emit('client', {\n                    event: event + '_start',\n                    clientId: this.socketId,\n                    data: { id: objId }\n                });\n            }\n\n            /**\n             * @param {string} event - name of the event being ended\n             * @param {string} objId - identifier of the item being tracked\n             */\n\n        }, {\n            key: \"end\",\n            value: function end(event, objId) {\n                var idx = this.tracking.indexOf(objId);\n                if (idx >= 0) {\n                    this.tracking.splice(idx, 1);\n\n                    this.emit('client', {\n                        event: event + '_end',\n                        clientId: this.socketId,\n                        data: { id: objId }\n                    });\n                }\n            }\n        }]);\n\n        return SocketService;\n    }();\n\n    /** \n     * Factory to get a Service used to listen for WebSocket messages from a server\n     *\n     * Usage: \n     *\n     * let wsUrl = ...\n     * let service = SocketServiceFactory(wsUrl);\n     *\n     */\n\n\n    angular.module('gp-common').factory('SocketServiceFactory', function ($rootScope, $window, UUID) {\n\n        var cache = {};\n\n        //disconnect whenever the app is closed\n        var onClose = function onClose(e) {\n            for (var url in cache) {\n                if (cache.hasOwnProperty(url)) {\n                    cache[url].close();\n                }\n            }\n            cache = null;\n            return null;\n        };\n\n        //needed for reload/backbtn\n        if ($window.onbeforeunload === 'function') {\n            var existing = $window.onbeforeunload;\n            $window.onbeforeunload = function (e) {\n                onClose(e);\n                return existing(e);\n            };\n        } else {\n            $window.onbeforeunload = onClose;\n        }\n\n        $rootScope.$on('$destroy', onClose);\n        //-------------------\n\n\n        return function (url) {\n\n            if (!url) return null;\n            if (cache[url]) return cache[url];\n\n            var service = new SocketService(UUID(), url);\n            cache[url] = service;\n            return service;\n        };\n    });\n})(angular);\n(function (angular) {\n\n    'use strict';\n\n    angular.module(\"gp-common\").factory('UUID', function () {\n\n        function s4() {\n            return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n        }\n\n        /*\n        return function() {\n                return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n                    s4() + '-' + s4() + s4() + s4();\n            }\n         */\n\n        return function () {\n            // http://www.ietf.org/rfc/rfc4122.txt\n            var s = [];\n            var hexDigits = \"0123456789abcdef\";\n            for (var i = 0; i < 36; i++) {\n                s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n            }\n            s[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n            s[19] = hexDigits.substr(s[19] & 0x3 | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n            s[8] = s[13] = s[18] = s[23] = \"-\";\n            return s.join(\"\");\n        };\n    });\n})(angular);\n(function (angular) {\n\n    'use strict';\n\n    //flag on whether we're in dev env\n\n    function isDEV() {\n        return \"localhost\" === window.location.hostname || ~window.location.hostname.indexOf(\"192.168\") || ~window.location.hostname.indexOf(\"10.0\");\n    }\n\n    /** \n     * GeoPlatform Common Module Authentication Support\n     *\n     * Contains re-usable services, directives, and other angular components\n     *\n     * \n     * NOTE: This module uses certain variables in $rootScope in order to \n     * perform actions like authentication.  The following variables should be\n     * set before using any service/directive in this file:\n     *\n     *   - idspUrl : the url to the identity service provider server\n     *   - idmUrl : the url to the identity management server\n     *   - portalUrl : the url to the main landing page of GeoPlatform (www.geoplatform.gov in production) \n     */\n    angular.module('gp-common')\n\n    /**\n     * Authentication Service\n     * \n     * Because the auth service redirects the page to the IDM portal\n     * and WMV is reloaded once the login/logout processes are complete,\n     * there's no need to bind listeners informing other components of \n     * an auth change.\n     *\n     * Inside \"DEV\", you should close and re-open any components' widgets\n     * to get current auth status.\n     */\n    .service('AuthenticationService', ['$q', '$http', 'GPConfig', function ($q, $http, Config) {\n\n        // console.log(\"IDSP Base Url: \" + Config.idspUrl);\n\n        function User(opts) {\n            for (var p in opts) {\n                this[p] = opts[p];\n            }\n            if (!this.id && this.username) this.id = this.username;\n\n            this.toJSON = function () {\n                return {\n                    id: this.id,\n                    username: this.username,\n                    name: this.name,\n                    email: this.email,\n                    org: this.org\n                };\n            };\n            this.clone = function () {\n                return new User(this.toJSON());\n            };\n            this.compare = function (arg) {\n                if (arg instanceof User) {\n                    return this.id === arg.id;\n                } else if ((typeof arg === \"undefined\" ? \"undefined\" : _typeof(arg)) === 'object') {\n                    return typeof arg.id !== 'undefined' && arg.id === this.id;\n                }\n                return false;\n            };\n        }\n\n        var TEST_USER = new User({\n            id: \"tester\",\n            username: \"tester\",\n            email: \"tester@geoplatform.us\",\n            name: \"John Test\",\n            org: \"Other\"\n        });\n\n        var _user = null;\n\n        if (isDEV()) {\n\n            /*\n             * If testing when user is not logged in, inject the following before\n             *  this ng-common library is included in the page:\n             * \n             *     GeoPlatform.TEST_NO_AUTH = true;\n             * \n             *  but be sure to inject AFTER the GeoPlatform configuration object exists!\n             */\n            if (GeoPlatform && GeoPlatform.TEST_NO_AUTH) _user = null;else _user = TEST_USER.clone();\n        }\n\n        var STATUS = {\n            NONE: 0,\n            INITIALIZING: -1, //auth check in progress\n            INITIALIZED: 1 //auth check completed\n        };\n\n        /**\n         * Authentication Service\n         */\n        var Service = function Service() {\n\n            var self = this;\n\n            this.status = STATUS.NONE;\n\n            //$q version of getUser\n            this.getUserQ = function () {\n                var deferred = $q.defer();\n                this.getUser(function (user) {\n                    deferred.resolve(user);\n                });\n                return deferred.promise;\n            };\n\n            /**\n             * If the callback parameter is specified, this method\n             * will return undefined. Otherwise, it returns the user (or null).\n             *\n             * @param callback optional function to invoke with the user\n             * @return object representing current user\n             */\n            this.getUser = function (callback) {\n                if (callback && typeof callback === 'function') {\n\n                    // console.log(\"Getting user info: \" + self.status + \", \" + JSON.stringify(_user||{empty:true}));\n\n                    //if already checked, return what we have\n                    if (self.status === STATUS.INITIALIZED) callback(_user);\n                    //if not in process of checking, check\n                    else if (self.status !== STATUS.INITIALIZING) {\n                            //if hasn't been checked for auth yet, do that now\n                            self.check().then(function (_user) {\n                                self.status = STATUS.INITIALIZED;\n                                callback(_user);\n                            }, function () {\n                                self.status = STATUS.INITIALIZED;\n                                callback(null);\n                            });\n                        }\n                        //if in process of checking, wait until it finishes\n                        else {\n                                setTimeout(function () {\n                                    self.getUser(callback);\n                                }, 500);\n                            }\n                    return;\n                }\n                return _user;\n            };\n\n            /**\n             * Redirects the page to the login site\n             */\n            this.login = function () {\n                if (isDEV() && !(GeoPlatform && GeoPlatform.TEST_NO_AUTH)) {\n                    _user = TEST_USER.clone();\n                    return _user;\n                }\n                var current = window.location.href;\n                window.location = Config.idspUrl + '/module.php/core/as_login.php?AuthId=geosaml&ReturnTo=' + encodeURIComponent(current);\n            };\n\n            /**\n             * Redirects the page to the logout site\n             */\n            this.logout = function () {\n                if (isDEV()) {\n                    _user = null;\n                    return _user;\n                }\n                var current = window.location.href;\n                window.location = Config.idspUrl + '/module.php/core/as_logout.php?AuthId=geosaml&ReturnTo=' + encodeURIComponent(current);\n            };\n\n            /**\n             * Queries simplesamlphp if the current session is authenticated\n             * @return promise - then(function(user) {}, function(response){})\n             */\n            this.check = function () {\n\n                var deferred = $q.defer();\n\n                if (isDEV()) {\n                    // console.log(\"Dev env\");\n                    setTimeout(function () {\n                        deferred.resolve(_user);\n                    }, 1000);\n                    return deferred.promise;\n                }\n\n                self.status = STATUS.INITIALIZING;\n\n                //check authentication on load\n                var promise = $http.get(Config.idspUrl + '/authenticategeosaml.php?as=geosaml');\n                promise.then(function (response) {\n\n                    var content = response.data ? response.data : response;\n\n                    // console.log(\"Received from SP: \" + content);\n                    if (typeof content === 'string') {\n                        try {\n                            content = JSON.parse(content);\n                        } catch (e) {\n                            deferred.reject(e);\n                            return;\n                        }\n                    }\n\n                    if (content.Success) {\n                        //authenticated\n                        _user = new User({\n                            id: content.name[0],\n                            username: content.name[0],\n                            email: content.mail[0],\n                            name: content.first_name[0] + ' ' + content.last_name[0],\n                            org: content.organization[0]\n                        });\n                        // console.log(\"Authenticated user: \" + JSON.stringify(_user));\n                    } else {\n                        _user = null; //not authenticated\n                        // console.log(\"Failed to authenticate user\");\n                    }\n\n                    deferred.resolve(_user);\n                }, function (data, status, headers) {\n                    // failed check\n                    // console.log(\"Authentication call failed\");\n                    deferred.reject(data);\n                }).catch(function (e) {\n                    // console.log(\"Authentication check caught an error: \" + e.message);\n                    deferred.reject(e.message);\n                });\n\n                return deferred.promise;\n            };\n\n            //=====================================================\n\n            //initialize with auth check\n            this.check().then(function (user) {\n                self.status = STATUS.INITIALIZED;\n            }, function (err) {\n                self.status = STATUS.INITIALIZED;\n            }).catch(function (e) {\n                // console.log(\"Initial auth check errored\");\n            });\n        };\n\n        return new Service();\n    }]).directive('gpLoginButton', ['$timeout', 'AuthenticationService', 'GPConfig', function ($timeout, AuthenticationService, Config) {\n        return {\n            scope: {\n                minimal: '@'\n            },\n            replace: true,\n            template: ['<div class=\"btn-account btn-group\">' +\n\n            //not logged in\n            '  <a class=\"btn btn-link\" ng-click=\"login()\" ng-if=\"!user\">Sign In</a>' +\n\n            //logged in\n            '  <button type=\"button\" class=\"btn btn-link dropdown-toggle\" data-toggle=\"dropdown\" ' + '   aria-expanded=\"false\" ng-if=\"user\">' + '     <span class=\"glyphicon glyphicon-user\"></span> ' + '     <span class=\"hidden-xs\">{{::user.name}}</span> ' + '     <span class=\"caret\"></span>' + '  </button>' + '  <ul class=\"dropdown-menu dropdown-menu-right\" role=\"menu\" ng-if=\"user\">' + '    <li class=\"account-details\">' + '      <div class=\"media\">' + '        <div class=\"media-left\">' + '          <div class=\"media-object\">' + '            <span class=\"glyphicon glyphicon-user glyphicon-xlg\"></span>' + '          </div>' + '        </div>' + '        <div class=\"media-body\">' + '          <div class=\"media-heading\">{{::user.name}}</div>' + '          <div><em>{{::user.username}}</em></div>' + '          <div>{{::user.email}}</div>' + '          <div>{{::user.org}}</div>' + '        </div>' + '      </div>' + '    </li>' + '    <li class=\"divider\"></li>' + '    <li><a href=\"{{::idpUrl}}/modifyuser.html\">Edit Info</a></li>' + '    <li><a href=\"{{::idpUrl}}/changepassword.html\">Change Password</a></li>' + '    <li><a href ng-click=\"logout()\">Sign Out</a></li>' + '  </ul>' + '</div>'].join(' '),\n            controller: function controller($scope, $element) {\n\n                if ($scope.minimal === 'true') $scope.minimal = true;\n                if ($scope.minimal !== true) $scope.minimal = false;\n\n                $scope.idpUrl = Config.idmUrl;\n                // console.log(\"IDM Base Url: \" + Config.idmUrl);\n\n                AuthenticationService.getUser(function (user) {\n                    $timeout(function () {\n                        $scope.user = user;\n                    }, 100);\n                });\n\n                $scope.login = function () {\n                    $scope.user = AuthenticationService.login();\n                };\n\n                $scope.logout = function () {\n                    $scope.user = AuthenticationService.logout();\n                };\n\n                //watch user for changes (timeouts)\n                var watcher = $scope.$watch(function () {\n                    return AuthenticationService.getUser();\n                }, function (newUser) {\n                    $scope.user = newUser;\n                });\n\n                $scope.$on('$destroy', function () {\n                    watcher(); //destroy watcher\n                });\n            }\n        };\n    }]).directive('gpAccountDetails', ['$timeout', 'AuthenticationService', 'GPConfig', function ($timeout, AuthenticationService, Config) {\n\n        return {\n            scope: {},\n            replace: true,\n            template: ['<div>' + '  <div class=\"media\">', '    <div class=\"media-left\">', '        <div class=\"media-object\">', '            <span class=\"glyphicon glyphicon-user glyphicon-xlg\"></span>', '        </div>', '    </div>', '    <div class=\"media-body\" ng-if=\"user\">', '       <div class=\"media-heading\">{{::user.name}}</div>' + '       <div><small><em>{{::user.username}}</em></small></div>' + '       <div><small>{{::user.email}}</small></div>' + '       <div><small>{{::user.org}}</small></div>' + '    </div>', '    <div class=\"media-body\" ng-if=\"!user\">', '       <div class=\"media-heading\">Please Sign In</div>' + '       <div><small>Sign in to your GeoPlatform account or register a new account.</small></div>' + '    </div>', '  </div>', '  <hr/>', '  <div ng-if=\"user\">', '    <button type=\"button\" class=\"btn btn-sm btn-accent pull-right\" ng-click=\"logout()\">Sign Out</button>' + '    <a class=\"btn btn-sm btn-default\" href=\"{{::idpUrl}}/modifyuser.html\">Edit Details</a>' + '  </div>', '  <div ng-if=\"!user\">', '    <button type=\"button\" class=\"btn btn-sm btn-accent pull-right\" ng-click=\"login()\">Sign In</button>' + '    <a class=\"btn btn-sm btn-default\" href=\"{{::idpUrl}}/registeruser.html\">Register</a>' + '  </div>', '</div>'].join(' '),\n            controller: function controller($scope, $element) {\n\n                $scope.idpUrl = Config.idmUrl;\n\n                AuthenticationService.getUser(function (user) {\n                    $timeout(function () {\n                        $scope.user = user;\n                    }, 100);\n                });\n\n                $scope.login = function () {\n                    $scope.user = AuthenticationService.login();\n                };\n\n                $scope.logout = function () {\n                    $scope.user = AuthenticationService.logout();\n                };\n\n                //watch user for changes (timeouts)\n                var watcher = $scope.$watch(function () {\n                    return AuthenticationService.getUser();\n                }, function (newUser) {\n                    $scope.user = newUser;\n                });\n\n                $scope.$on('$destroy', function () {\n                    watcher(); //destroy watcher\n                });\n            }\n        };\n    }]);\n})(angular);\n(function () {\n\n    \"use strict\";\n\n    if (typeof Array.prototype.find === 'undefined') {\n        Array.prototype.find = function (callback) {\n            for (var i = 0; i < this.length; ++i) {\n                if (callback(this[i], i, this)) return this[i];\n            }\n            return null;\n        };\n    }\n    if (typeof Array.prototype.filter === 'undefined') {\n        Array.prototype.filter = function (callback) {\n            var results = [];\n            for (var i = 0; i < this.length; ++i) {\n                if (callback(this[i], i, this)) results.push(this[i]);\n            }\n            return results;\n        };\n    }\n    if (typeof Array.prototype.each === 'undefined') {\n        Array.prototype.each = function (callback) {\n            for (var i = 0; i < this.length; ++i) {\n                callback(this[i], i, this);\n            }\n        };\n    }\n    if (typeof String.prototype.startsWith === 'undefined') {\n        String.prototype.startsWith = function (value) {\n            var str = this;\n            if (!str.length) return false;\n            if (!value.length) return false;\n            if (str.length < value.length) return false;\n            return str.indexOf(value) === 0;\n        };\n    }\n    if (typeof String.prototype.endsWith === 'undefined') {\n        String.prototype.endsWith = function (value) {\n            var str = this;\n            if (!str.length) return false;\n            if (!value.length) return false;\n            if (str.length < value.length) return false;\n            var substr = str.substring(str.length - value.length, str.length);\n            return substr == value;\n        };\n    }\n\n    if (typeof Date.prototype.plus === 'undefined') {\n        Date.prototype.plus = function (offset) {\n\n            var type = typeof offset === \"undefined\" ? \"undefined\" : _typeof(offset);\n            if (type === 'undefined') return this;\n\n            var offsetMS = 0;\n            if (type === 'string') {\n                switch (offset) {\n                    case 'hour':\n                        offsetMS = 1000 * 60 * 60;break;\n                    case 'day':\n                        offsetMS = 1000 * 60 * 60 * 24;break;\n                    case 'week':\n                        offsetMS = 1000 * 60 * 60 * 24 * 7;break;\n                    case 'month':\n                        offsetMS = 1000 * 60 * 60 * 24 * 31;break;\n                    case 'year':\n                        offsetMS = 1000 * 60 * 60 * 24 * 365;break;\n                }\n            } else if (type === 'number') {\n                offsetMS = offset;\n            } else return this;\n\n            var d = this;\n            return new Date(d.getTime() + offsetMS);\n        };\n    }\n\n    if (typeof Date.prototype.random === 'undefined') {\n        Date.prototype.random = function (threshold) {\n\n            var type = typeof threshold === \"undefined\" ? \"undefined\" : _typeof(threshold);\n            if (type === 'undefined') return this;\n\n            var offsetMS = 0;\n            if (type === 'string') {\n                switch (threshold) {\n                    case 'hour':\n                        offsetMS = 1000 * 60 * 60;break;\n                    case 'day':\n                        offsetMS = 1000 * 60 * 60 * 24;break;\n                    case 'week':\n                        offsetMS = 1000 * 60 * 60 * 24 * 7;break;\n                    case 'month':\n                        offsetMS = 1000 * 60 * 60 * 24 * 31;break;\n                    case 'year':\n                        offsetMS = 1000 * 60 * 60 * 24 * 365;break;\n                }\n            } else if (type === 'number') {\n                offsetMS = threshold;\n            } else return this;\n\n            var d = this;\n            return new Date(d.getTime() + Math.floor(Math.random() * offsetMS));\n        };\n    }\n})();","(function(jQuery, angular) {\n    \n    \"use strict\"; \n    \n    angular.module(\"gp-common\", [])\n\n    //Assumes a global has been set\n    // Don't use these... deprecated\n    .constant('idspBaseUrl', GeoPlatform.idspUrl)\n    .constant('idmBaseUrl', GeoPlatform.idmUrl)\n\n    //Assumes a global object containing configuration values for GeoPlatform exists \n    // prior to this module being declared\n    // (using 'value' since config might change)\n    .value('GPConfig', GeoPlatform)\n\n    ;\n\n})(jQuery, angular);","(function(jQuery, angular) {\n    \n    'use strict';\n\n    angular.module('gp-common').directive('gpDatePicker', ['$timeout', function($timeout) {\n\n        return {\n            scope: {\n                label: '@',\n                format: '@',\n                date: '=',\n                onChange: '&?'\n            },\n            template: [\n                '<div class=\"input-group-slick\">',\n                '    <input type=\"text\" class=\"form-control\" placeholder=\"{{::label}}\"',\n                '        datepicker-popup=\"{{format}}\" ng-model=\"date\" is-open=\"opened\" />',\n                '    <span class=\"glyphicon glyphicon-calendar\" ng-click=\"toggle($event)\"></span>',\n                '</div>',\n                '<p class=\"help-block\"><small><em>Ex: \"2015-01-31\" or \"Jan 31 2015\"</em></small></p>'\n            ].join(' '),\n\n            controller: function($scope, $element, $attrs) {\n\n                //toggle date picker\n                $scope.toggle = function(event) {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    this.opened = !this.opened;\n                };\n\n                if(!$scope.format)\n                    $scope.format = 'MMM dd yyyy';\n\n                var promise = null;\n\n                $scope.debounce = function() {\n                    if(promise) $timeout.cancel(promise);\n                    promise = $timeout(function() { \n                        promise = null;\n                        if($scope.onChange)\n                            $scope.onChange();\n                    }, 200);\n                };\n\n                $scope.$watch('date', function() {\n                    $scope.debounce();\n                });\n\n                var listener = $scope.$on('$destroy', function() {\n                    \n                    listener();             //deregister listener\n                    \n                    if(promise) $timeout.cancel(promise);\n                    promise = null;\n\n                    $scope.opened = false;    //close picker if open\n                    $scope.onChange = null;\n                    $scope.format = null;\n                    $scope.debounce = null;\n                });\n\n            }\n        };\n\n    }]);\n\n})(jQuery, angular);","(function(jQuery, angular) {\n    \n    \"use strict\"; \n    \n    angular.module(\"gp-common\")\n\n    /**\n     * Geolocation directive\n     */\n    .directive('gpGeolocation', ['$window',function ($window) {\n        \n        var defaultBtnLabel = \"Locate\";\n\n        return {\n            scope: {\n                label: '=?'\n            },\n            restrict: \"EA\",\n            template: [\n                '<a class=\"btn btn-primary\" ng-click=\"geolocate()\" ng-if=\"available\">',\n                '  <span class=\"glyphicon glyphicon-screenshot\" ng-if=\"!loading\"></span>',\n                '  <span class=\"glyphicon glyphicon-hourglass glyphicon-spin\" ng-if=\"loading\"></span>',\n                '  {{btnLabel}}',\n                '</a>',\n                '<div ng-if=\"error\">{{error}}</div>'\n            ].join(' '),\n            controller: function($scope) {\n\n                $scope.btnLabel = $scope.label || defaultBtnLabel;\n                $scope.loading = false;\n                $scope.available = ($window.navigator && $window.navigator.geolocation);\n\n                if(!$scope.available) \n                    $scope.error = \"Your browser does not support determining location\";\n\n                $scope.geolocate = function() {\n\n                    $scope.loading = true;\n                    $window.navigator.geolocation.getCurrentPosition(function(position){\n\n                        $scope.$apply(function() {$scope.loading = false;});\n                        $scope.$emit('map:geolocation', position.coords.latitude, position.coords.longitude);\n\n                    }, function(error) {\n                        switch (error.code) {\n                          case 1:\n                            $scope.error = \"Permission was denied while attempting to determine location\";\n                            break;\n                          case 2:\n                            $scope.error = \"Unable to determine your location\";\n                            break;\n                          case 3:\n                            $scope.error = \"Unable to determine location in a reasonable amount of time\";\n                            break;\n                        }\n                    });\n                }; \n            }\n        };\n\n    }])\n\n    ;\n\n})(jQuery, angular);","(function(jQuery, angular) {\n    \n    \"use strict\"; \n    \n    angular.module(\"gp-common\")\n\n\n    /**\n     * Header directive for GeoPlatform Angular-based web applications\n     * \n     * Uses transclusion to inject links into the nav-menu which floats to the right.\n     * The menu already provides a \"Home\" link (to app home) and Sign In/User Info button.\n     * The home link is not enabled by default but can be shown using 'show-home-link=\"true\"' \n     * parameter on the directive.\n     *\n     * Note: any links transcluded should reference '$parent.user' to access authenticated user info\n     * \n     * ex:\n     * \n     *   <div gp-header brand=\"Map Manager\" show-home-link=\"true\" class=\"navbar-fixed-top\">\n     *     <li><a href=\"#/maps\">Maps</a></li>\n     *     <li><a href=\"#/galleries\">Galleries</a></li>\n     *     <li><a ng-if=\"$parent.user!==null\" href=\"#/agol\">AGOL</a></li>\n     *     <li><a href=\"#/help\">Help</a></li>\n     *   </div>\n     */\n    .directive('gpHeader', ['GPConfig', 'AuthenticationService', function(Config, AuthenticationService) {\n\n        return {\n\n            scope: {\n                brand: \"@\",\n                showHomeLink: \"@\"\n            },\n            restrict: \"AE\",\n            transclude: true,\n            replace: true,\n            template: [\n                '<header>',\n                '  <div class=\"container-fluid\">',\n                '    <div class=\"row\">',\n                '      <div class=\"col-md-12\">',\n                '        <ul role=\"menu\" class=\"header__menu\" gp-header-menu>',\n                '          <li ng-if=\"showHomeLink\">',\n                '            <a href=\"#/goHome\">',\n                '                <span class=\"glyphicon glyphicon-home\"></span> ',\n                '                <span class=\"hidden-xs hidden-sm\">Home</span>',\n                '            </a>',\n                '          </li>',\n                '          <div class=\"transcluded\"></div>',\n                '          <li><span gp-login-button></span></li>',\n                '        </ul>',\n                '        <h4 class=\"brand\">',\n                '          <a href=\"{{portalUrl}}\" title=\"Go to the GeoPlatform Home Page\">',\n                '            <span class=\"icon-gp\"></span>',\n                '            <span class=\"hidden-xs\">GeoPlatform</span>',\n                '          </a>',\n                '          {{brand}}',\n                '        </h4>',\n                '      </div>',\n                '    </div>',\n                '  </div>',\n                '</header>'\n            ].join(' '),\n\n            // controller: function($rootScope, $scope, $element) {\n            //     $scope.portalUrl = $rootScope.portalUrl;\n            // }, \n\n            link: function($scope, $element, $attrs, ctrl, transcludeFn) {\n\n                $scope.showHomeLink = $scope.showHomeLink === 'true' || false;\n\n                $scope.portalUrl = Config.portalUrl;\n\n                AuthenticationService.getUserQ().then(function(user) {\n                    $scope.user = user;    \n                });\n                \n                $element.find('.transcluded').replaceWith(transcludeFn());\n            }            \n\n        };\n\n    }])\n\n\n    \n    /**\n     * Header Menu\n     *\n     * Monitors the current page URL and updates the header links \n     * to highlight whichever one is associated with the current page\n     *\n     * Usage: \n     *\n     *  <ul role=\"menu\" class=\"header__menu\" gp-header-menu>\n     *      <li><a href=\"#/maps\">Maps</a></li>\n     *      <li><a href=\"#/galleries\">Galleries</a></li>\n     *      ...\n     *  </ul>\n     *\n     */\n    .directive('gpHeaderMenu', ['$location', function($location) {\n\n        //default href for \"home\" link in header__menu\n        //uses 'goHome' to avoid angular-route issues with empty hash not \n        // triggering a page reload. Relies upon the \"otherwise\" condition\n        // being configured inside a routeProvider within the application.\n        var homeLink = 'goHome';\n\n        function update($element) {\n\n            var path = $location.path();\n            \n            if(path === '/' || path === '/#' || path === '/#/')\n                path = homeLink;\n\n            if(path[0] === '/') \n                path = path.substring(1);\n\n            var menu = $element;\n            menu.find('li.active').removeClass('active');\n            \n            var link = menu.find('li > a[href=\"#/' + path + '\"]');\n            if(link.length) {\n                //check if link is within a dropdown in the header menu\n                var dd = link.closest('.dropdown-menu');\n                if(dd.length) {\n                    //find next ancestor that is a list element and mark it active\n                    dd.closest('li').addClass('active');\n                } else {\n                    //not in a dropdown, mark this link active\n                    link.parent().addClass('active');\n                }\n            }\n            \n            menu.find('li > a').each(function(i,a) {\n                var $a = $(a), href = $a.attr('href');\n                if(!href) return;\n                href = href.replace('#/', '');\n                if(path.indexOf(href) === 0)\n                    $a.parent().addClass('active');\n            });\n        }\n\n        return {\n            scope: {\n                homeHref: '@'\n            },\n            restrict: \"A\",\n            \n            controller: function($rootScope, $scope, $element) {\n                if($scope.homeHref)\n                    homeLink = $scope.homeHref;\n            },\n\n            link: function($scope, $element) {\n\n                update($element);\n\n                $scope.$root.$on('$locationChangeSuccess', function() {\n                    update($element);\n                });\n\n            }\n        };\n    }]);\n\n})(jQuery, angular);\n","(function(angular) {\n\n\n    \"use strict\";\n\n    angular.module('gp-common').directive('iframeOnload', function(){\n        return {\n            scope: {\n                callback: '&iframeOnload'\n            },\n            link: function(scope, element, attrs){\n                element.on('load', function(event){\n                    element.off('load');\n                    return scope.callback(event);\n                });\n            }\n        };\n    });\n\n}) (angular);","(function(angular) {\n    \n    \"use strict\";\n\n    angular.module(\"gp-common\").directive('onImgFail', function() {\n        return {\n            scope: {\n                onImgFail: '@'\n            },\n            link: function($scope, $element) {\n                var jqEl = jQuery($element);\n                jqEl.on('error', function() {\n                    jqEl.attr('src', $scope.onImgFail);\n                });\n            }\n        };\n    });\n\n}) (angular);","(function(angular) {\n    \n    \"use strict\";\n\n\n    angular.module('gp-common')\n\n\n    //\n    .service('NotificationService', ['$rootScope', function($rootScope) {\n        var Service = function() {\n            this.items = [];\n        };\n        Service.prototype = {\n            getItems: function() { return this.items; },\n            /**\n             * @param item object\n             * @return function to cancel the notification\n             */\n            addItem: function(item) { \n                this.items.push(item); \n                $rootScope.$broadcast('gp:notifications:new', item);\n\n                var fn = function(item) { this.removeItem(item); };\n                return fn.bind(this, item);\n            },\n            removeItem: function(item) {\n                var index = this.items.indexOf(item);\n                if(index >= 0)\n                    return this.items.splice(index, 1);\n                return null;\n            },\n            error: function(label, msg, dismiss) { \n                return this.addItem({ type: 'error', label: label, message: msg, canDismiss: dismiss });\n            },\n            success: function(label, msg, dismiss) { \n                return this.addItem({ type: 'success', label: label, message: msg, canDismiss: dismiss });\n            },\n            info: function(label, msg, dismiss) { \n                return this.addItem({ type: 'info', label: label, message: msg, canDismiss: dismiss });\n            }\n        };\n        return new Service();\n    }])\n\n\n    // Usage: <gp-notifications />\n    .directive('gpNotifications', ['$timeout', 'NotificationService', function($timeout, NotificationService) {\n        return {\n            scope: {\n                expiration: '@'\n            },\n            template: [\n                '<div class=\"notifications ng-hide\" ng-show=\"items.length\">',\n                '  <div class=\"notification\" ng-repeat=\"item in items\"',\n                '    ng-class=\"{\\'notification--success\\':item.type===\\'success\\', \\'notification--error\\':item.type===\\'error\\', \\'notification--info\\':item.type===\\'info\\'}\">',\n                '    <h5 class=\"notification__title\">',\n                '        <span class=\"pull-right glyphicon\" ',\n                '            ng-class=\"{\\'glyphicon-ok-sign\\':item.type===\\'success\\',\\'glyphicon-exclamation-sign\\':item.type===\\'error\\',\\'glyphicon-info-sign\\':item.type===\\'info\\'}\">',\n                '        </span>',\n                '        {{item.label}}',\n                '    </h5>',\n                '    <p class=\"notification__content\" ng-bind-html=\"item.message\"></p>',\n                '    <div class=\"notification__actions\" ng-if=\"item.canDismiss\">',\n                '        <button type=\"button\" class=\"btn btn-link\" ng-click=\"dismiss(item)\">dismiss</button>',\n                '    </div>',\n                '  </div>',\n                '</div>'\n            ].join(' '),\n\n            link: function($scope, $element, $attrs) {\n\n                $scope.expiration = ($scope.expiration || 2000)*1;\n\n                $scope.items = [];\n\n\n                function update() {\n                    $scope.items = NotificationService.getItems();\n\n                    //if updated before timer expired, reset timer\n                    if($scope.timer) {\n                        $timeout.cancel($scope.timer);\n                        $scope.timer = null;\n                    }\n\n                    //set timer to kill earliest item after time\n                    $scope.timer = $timeout(function() {\n                        $scope.timer = null;\n                        //will ultimately call update() and thus trigger timeout again\n                        $scope.removeOldest();\n                    }, $scope.expiration);\n                }\n                update();\n\n                $scope.removeOldest = function() {\n                    //find oldest that can be removed\n                    var oldest = $scope.items.find(function(item) {return item.canDismiss;});\n                    if(oldest)\n                        NotificationService.removeItem(oldest);\n                };\n\n                $scope.dismiss = function(item) {\n                    //remove item using service\n                    NotificationService.removeItem(item);\n                };\n\n                $scope.$watchCollection(function() {\n                    return NotificationService.getItems();\n                }, update);\n\n                // $scope.$on('gp:notifications:new', function(event, item) { update(); });\n\n            }\n        };\n    }]);\n\n\n})(angular);","(function(jQuery, angular) {\n    \n    \"use strict\";\n\n    angular.module('gp-common').directive('gpPagination', function() {\n\n\n        function Controller($scope, $element) {\n\n            if(!$scope.pageSizeOpts) {\n                $scope.pageSizeOpts = [5, 10, 25, 50];\n            }\n            if($scope.pageSize && $scope.pageSizeOpts.indexOf($scope.pageSize*1)<0) {\n                $scope.pageSizeOpts.push($scope.pageSize*1).sort();\n            }\n\n            $scope.previous = function() { \n                $scope.start = Math.max(0, $scope.start*1 - $scope.pageSize*1);\n                $scope.$emit('pagination:change', $scope.start, $scope.pageSize);\n            };\n\n            $scope.next = function() {\n                $scope.start = Math.min($scope.total, $scope.start*1 + $scope.pageSize*1);\n                $scope.$emit('pagination:change', $scope.start, $scope.pageSize);\n            };\n\n            $scope.setPage = function(arg) {\n                var page = arg*1;\n                $scope.start = (page-1) * ($scope.pageSize*1);\n                $scope.$emit('pagination:change', $scope.start, $scope.pageSize);\n            };\n\n            $scope.setPageSize = function(size) {\n\n                $scope.pageSize = size*1;\n                //move start cursor to beginning of new current page based on updated pagesize\n                var currentPage = Math.floor($scope.start / $scope.pageSize) + 1;\n                $scope.setPage(currentPage);\n            };\n\n            $scope.hasPrevious = function() {\n                return $scope.start > 0;\n            };\n\n            $scope.hasNext = function() {\n                return ($scope.start+$scope.pageSize) < $scope.total;\n            };\n\n\n            function update() {\n            \n                var ostart = $scope.start*1;\n                var osize = $scope.pageSize*1;\n                \n                //calculate # of pages needed\n                var pages = [];\n                var maxPagination = 5;\n                var maxPaginationMidPoint = ((maxPagination % 2) !== 0) ? Math.ceil(maxPagination / 2) : maxPagination / 2;\n\n                if($scope.total > 0) {\n                    \n                    var numPages = Math.ceil($scope.total / osize);\n                    var currentPage = Math.floor(ostart / osize);\n\n                    var s = 0;\n                    if(currentPage > Math.floor(maxPagination/2)) {     //  1 2 '3' 4 5\n                        s = currentPage-Math.floor(maxPagination/2);    //  1 2 3 '4' 5\n                                                                        //  ...\n\n                    } else {                                            //  '1' 2 3 4 5\n                        s = 0;                                          //  1 '2' 3 4 5\n                                                                        //  ...\n                    }\n\n                    var e = Math.min(s+maxPagination, numPages);\n\n                    //ensure at least <maxPagination> # of page links are shown\n                    // even if near the end of the results\n                    while(s>0 && ((e-s) < maxPagination))\n                        s-=1;\n\n                    for(var i=s; i<e; ++i) {\n                        var pageStart = (i*osize)+1;\n                        var pageEnd = Math.min(pageStart + osize - 1, $scope.total);\n                        pages.push({\n                            label: (i+1)+\"\",\n                            tooltip: \"Results \" + pageStart + \"-\" + pageEnd\n                        });\n                        if(i == currentPage)\n                            pages[pages.length-1].active = true;\n                    }\n\n                }\n\n                $scope.pages = pages;\n\n            }\n\n            update();\n\n            $scope.$watch('start',      update);\n            $scope.$watch('pageSize',   update);\n            $scope.$watch('total',      update);\n\n        }\n\n\n\n        return {\n\n            scope: {\n                start: '=',\n                pageSize: '=',\n                total: '=',\n                pageSizeOpts: '='\n            },\n            replace: true,\n            template: [\n                '<div>',\n                '  <div class=\"visible-xs row\">',\n                '    <div class=\"col-xs-6\">{{total}} results</div>',\n                '    <div class=\"col-xs-6\">',\n                '      <select class=\"form-control\" ng-model=\"pageSize\">',\n                '        <option ng-repeat=\"ps in pageSizeOpts\" ',\n                '          ng-selected=\"pageSize===ps\" ',\n                '          value=\"{{ps}}\">{{ps}} per page</option>',\n                '      </select>',\n                '    </div>',\n                '  </div>',\n                '  <ul class=\"pagination\">',\n                '    <li class=\"info hidden-xs\">',\n                '      <a>{{total}} results</a>',\n                '    </li>',\n                '    <li class=\"pagination-control hidden-xs\" ng-if=\"total>0\">',\n                '      <span uib-dropdown>',\n                '        <a href=\"\" uib-dropdown-toggle title=\"Change the number of results returned\">',\n                '          {{pageSize}} per page <span class=\"caret\"></span>',\n                '        </a>',\n                '        <ul class=\"dropdown-menu\" role=\"menu\">',\n                '          <li ng-repeat=\"ps in pageSizeOpts\"><a ng-click=\"setPageSize(ps)\">{{ps}} per page</a></li>',\n                '        </ul>',\n                '      </span>',\n                '    </li>',\n                '    <li class=\"separator hidden-xs\"></li>',\n                '    <li ng-if=\"hasPrevious()\">',\n                '      <a ng-click=\"previous()\">',\n                '        <span class=\"glyphicon glyphicon-backward\"></span>',\n                '      </a>',\n                '    </li>',\n                '    <li ng-repeat=\"page in pages\" ng-class=\"{active:page.active,disabled:page.disabled}\">',\n                '      <a ng-click=\"setPage(page.label)\" title=\"{{::page.tooltip}}\">{{::page.label}}</a>',\n                '    </li>',\n                '    <li ng-if=\"hasNext()\">',\n                '      <a ng-click=\"next()\">',\n                '        <span class=\"glyphicon glyphicon-forward\"></span>',\n                '      </a>',\n                '    </li>',\n                '  </ul>',\n                '</div>'\n            ].join(' '),\n\n            controller: Controller\n\n        };\n\n    });\n\n\n})(jQuery, angular);","(function(jQuery, angular) {\n\n    \"use strict\";\n\n\n    angular.module('gp-common')\n\n\n    //helper to determine size of window for responsive breakpoint purposes\n    .provider('responsiveHelper', [\"$windowProvider\", function ($windowProvider) {\n        \n        var $window  = $windowProvider.$get();\n\n        function Helper($window) {\n            this.window = $window;\n        }\n        Helper.prototype = {\n            getWidth: function() { return $window.innerWidth || $window.outerWidth; },\n            isXS: function () { var width = this.getWidth(); return width < 768; },\n            isSM: function () { var width = this.getWidth(); return width >= 768 && width < 992; },\n            isMD: function () { var width = this.getWidth(); return width >= 992 && width < 1200; },\n            isLG: function () { var width = this.getWidth(); return width >= 1200; }\n        };\n\n        var helper = new Helper($window);\n\n        this.$get = function() {\n            return helper;\n        };\n    }])\n\n\n    //directive which appends appropriate responsive breakpoint classNames to the element\n    // on which it's set\n    .directive('gpResponsive', ['$window', 'responsiveHelper', function($window, responsiveHelper) {\n\n        return {\n            restrict: \"A\",\n            link: function($scope, $element, $attrs) {\n\n                function update(el, helper) {\n                    if(helper.isXS())\n                        el.addClass('gp-responsive-xs');\n                    else\n                        el.removeClass('gp-responsive-xs');\n\n                    if(helper.isSM())\n                        el.addClass('gp-responsive-sm');\n                    else \n                        el.removeClass('gp-responsive-sm');\n\n                    if(helper.isMD())\n                        el.addClass('gp-responsive-md');\n                    else \n                        el.removeClass('gp-responsive-md');\n\n                    if(helper.isLG())\n                        el.addClass('gp-responsive-lg');\n                    else \n                        el.removeClass('gp-responsive-lg');\n                }\n\n                update($element, responsiveHelper);\n\n                var resizeFn = function() {\n                    update($element, responsiveHelper);\n                };\n\n                var w = angular.element($window);\n                var listener = w.on('resize', resizeFn);\n\n                $scope.$on('$destroy', function() {\n                    w.off('resize', resizeFn);\n                });\n\n            }\n        };\n\n    }])\n\n\n    .directive('gpResize', function($window, $timeout) {\n        return function($scope, $element, $attr) {\n\n            var resizeFn = function() {\n                var hh = jQuery('header')[0].offsetHeight;\n                // var fh = jQuery('footer')[0].offsetHeight;\n                // console.log('hh & fh', hh, fh);                    \n\n                var tp = hh + 2;\n                // var bt = fh + 2;\n                // console.log('tp & bt', tp, bt);                \n                \n                var changes = {\n                    // bottom: bt + 'px',\n                    top: tp + 'px',\n                };\n                $element.css(changes);\n                $scope.$apply();\n            };\n\n            var w = angular.element($window);\n            w.on('resize', resizeFn);\n\n            $timeout(resizeFn, 200);\n\n            $scope.$on('$destroy', function() {\n                w.off('resize', resizeFn);\n            });\n\n        };\n    });\n\n})(jQuery, angular);","(function(jQuery, angular) {\n    \n    \"use strict\";\n\n\n\n    function inputLinkFunction($scope, $element, $attrs, ngModelController, $timeout) {\n\n        if(!$scope.type) $scope.type = \"text\";\n        if($scope.required === 'true')\n            $scope.required = true;\n        else $scope.required = false;\n\n        $scope.elId = 'input_' + Math.ceil(Math.random()*9999);\n        $scope.size = $scope.size || 'medium';\n        $scope.type = $scope.type || 'text';\n\n\n\n        //listen for changes to the inner value by way of the form-control\n        $element.find('.form-control').on('change', function onChange() { \n            validate($scope.innerValue); \n        });\n        \n        \n\n        /* ------------- private methods --------------- */\n\n        function validate() {\n\n            //check form-control for ng-invalid\n            var input = $element.find('.form-control');\n\n            $scope.isDirty = input.hasClass('ng-dirty');\n\n            if(input.hasClass('ng-invalid')) {\n                if(input.hasClass(\"ng-empty\"))\n                    $scope.error = \"This field requires a value\";\n                else\n                    $scope.error = \"Invalid value provided\";\n            } else\n                $scope.error = null;\n\n        }\n\n        function update(newValue) {\n            // call $parsers pipeline then update $modelValue\n            ngModelController.$setViewValue(newValue);\n            // update the local view\n            ngModelController.$render();\n        }\n\n\n\n        // when model change, update our view (just update the div content)\n        ngModelController.$render = function() {\n                \n            var value = ngModelController.$viewValue;\n\n            //create copy of passed in model value that can be used\n            // by the controls here allowing us to cancel and \n            // commit changes at our own leisure\n            $scope.innerValue = value;\n            \n            $scope.displayValue = value || $scope.placeholder || \"No value provided\";\n\n            validate(value);\n        };\n\n\n        /* ------------- private methods --------------- */\n\n        $scope.isReadOnly = function() {\n            var t = typeof(this.readOnly);\n            if(t === 'undefined') return false;\n            if(t === 'string') return this.readOnly.toLowerCase() === 'true';\n            if(t === 'number') return this.readOnly === 1;\n            if(t === 'boolean') return this.readOnly;\n            return false;\n        };\n\n        //enter edit mode\n        $scope.edit = function() {\n            if($scope.isReadOnly()) return;\n            $scope.editing=true;\n            //auto-focus on form-control when entering edit mode\n            $timeout(function() { $element.find('.form-control').focus().select(); }, 200);\n        };\n        //leave edit mode (regardless of save() or cancel())\n        $scope.done = function() {\n            $scope.editing=false;\n            $scope.error = null;\n        };\n\n\n        $scope.save = function() {\n            //update display with new value\n            update($scope.innerValue);\n            $scope.done();\n        };\n        $scope.cancel = function() {\n            //reset inner value\n            $scope.innerValue = ngModelController.$viewValue;\n            $scope.done();\n        };\n\n\n        $scope.onKeyPress = function($event, code) {\n            // console.log(\"Pressed \" + code);\n            if((code === undefined || code === 0) && $event.which !== undefined)\n                code = $event.which;\n            if($scope.type === 'number') {\n                \n                //NOTE: Chrome does not catch Backspace onKeyPress, so it \n                // skips this handler. FF does, so we need to watch for \n                // backspace, delete, and numbers\n\n                if (code === 8  ||   //backspace\n                    code === 46 ||  //delete  \n                    (code >= 44 && code <= 57))    //comma, hyphen, period and numbers (0-9)\n                    return;\n                \n                //NOTE: keyPress period is 46. keyDown it is 190\n\n                $event.preventDefault();\n                return false;               //ignore key\n            }\n        };\n        $scope.onKeyUp = function($event, code) {\n            // console.log(\"Up \" + code);\n            if((code === undefined || code === 0) && $event.which !== undefined)\n                code = $event.which;\n            if(code === 13 && !$scope.error) $scope.done();  //enter\n            else if(code === 27)             $scope.cancel();//esc\n            else {\n            \n                if(code !== 8 &&                //backspace\n                    code !== 46 &&              //delete\n                    code !== 190 &&             //period\n                    (code < 48 || code > 90) && //letters and numbers (a-z, 0-9)\n                    (code < 106 || code > 111) && \n                    (code < 186)) \n                    return;\n\n                validate();\n            }\n        };\n\n\n        $scope.$destroy = function() {\n            $element.off('change');\n        };\n    }\n\n\n\n    angular.module(\"gp-common\")\n\n    .directive('gpSlickFormInput', ['$timeout', function($timeout) {\n\n        return {\n            restrict: 'AE',\n            require: 'ngModel',\n            scope: {\n                label: \"@\",\n                placeholder: '@',\n                help: '=',\n                // validator: '&',\n                // validationExpr: '@',\n                type: '@',\n                pattern: \"@\",\n                required: '@',\n                readOnly: '@',\n                size: '@',\n                icon: '@'\n            },\n            template: INPUT_TEMPLATE,\n            link: function($scope, $element, $attrs, ngModelController) {\n                inputLinkFunction($scope, $element, $attrs, ngModelController, $timeout);\n            }\n        };\n\n    }])\n\n\n    .directive('gpSlickFormTextarea', ['$timeout', function($timeout) {\n\n        return {\n            restrict: 'AE',\n            require: 'ngModel',\n            scope: {\n                label: \"@\",\n                placeholder: '@',\n                help: \"@\",\n                readOnly: \"@\",\n                size: \"@\",\n                icon: \"@\"\n            },\n            template: TEXTAREA_TEMPLATE,\n            link: function($scope, $element, $attrs, ngModelController) {\n                inputLinkFunction($scope, $element, $attrs, ngModelController, $timeout);\n            }\n        };\n\n    }])\n\n\n    /**\n     *\n     * Notes:\n     *  - use 'form form-inline' classes for editable date so the field doesn't take up whole line\n     */\n    .directive('gpSlickFormDate', ['$timeout', '$filter', function($timeout, $filter) {\n\n        return {\n            restrict: 'AE',\n            require: 'ngModel',\n            scope: {\n                label: \"@\",\n                format: \"@\",\n                placeholder: '@',\n                required: \"@\",\n                readOnly: \"@\",\n                size: '@',\n                icon: '@'\n            },\n            template: DATE_TEMPLATE,\n\n            controller: function($scope, $element) {\n                if(!$scope.format || $scope.format.length < 3) $scope.format = \"mediumDate\";\n                $scope.inline = $element.hasClass(\"inline\");\n            },\n\n            /**\n             *\n             */\n            link: function($scope, $element, $attrs, ngModelController) {\n\n                if($scope.required === 'true')\n                    $scope.required = true;\n                else $scope.required = false;\n                \n                $scope.elId = 'input_' + Math.ceil(Math.random()*9999);\n                $scope.size = $scope.size || 'medium';\n                $scope.type = $scope.type || 'text';\n\n\n                function validate(value) {\n                    // console.log(\"Validating '\" + value + \"'\");\n\n                    //check form-control for ng-invalid\n                    var input = $element.find('.form-control');\n                    if(input.hasClass('ng-invalid')) {\n                        if(input.hasClass(\"ng-empty\"))\n                            $scope.error = \"This field requires a value\";\n                        else\n                            $scope.error = \"Invalid value provided\";\n                    } else\n                        $scope.error = null;\n                }\n\n                function update(newValue) {\n                    // call $parsers pipeline then update $modelValue\n                    ngModelController.$setViewValue(newValue);\n                    // update the local view\n                    ngModelController.$render();\n                }\n\n\n                // when model change, update our view (just update the div content)\n                ngModelController.$render = function() {\n\n                    var value = ngModelController.$viewValue;\n\n                    //create copy of passed in model value that can be used\n                    // by the controls here allowing us to cancel and \n                    // commit changes at our own leisure\n                    $scope.innerValue = value;\n                    \n                    $scope.displayValue = value ? $filter('date')(ngModelController.$modelValue, $scope.format) :\n                        $scope.placeholder || \"No value provided\";\n\n                    validate(value);\n\n                };\n\n\n\n\n                $scope.isReadOnly = function() {\n                    var t = typeof(this.readOnly);\n                    if(t === 'undefined') return false;\n                    if(t === 'string') return this.readOnly.toLowerCase() === 'true';\n                    if(t === 'number') return this.readOnly === 1;\n                    if(t === 'boolean') return this.readOnly;\n                    return false;\n                };\n\n\n                //enter edit mode\n                $scope.edit = function() {\n                    if($scope.isReadOnly()) return;\n                    \n                    $scope.editing=true;\n                    \n                    //auto-focus on form-control when entering edit mode\n                    // $timeout(function() { $element.find('.form-control').focus().select(); }, 200);\n                };\n                //leave edit mode (regardless of save() or cancel())\n                $scope.done = function() {\n                    $scope.opened = false;\n                    $scope.editing=false;\n                    $scope.error = null;\n                };\n\n\n                $scope.save = function() {\n                    //update display with new value\n                    update($scope.innerValue);\n                    $scope.done();\n                };\n                $scope.cancel = function() {\n                    //reset inner value\n                    $scope.innerValue = angular.copy(ngModelController.$modelValue);\n                    $scope.done();\n                };\n\n\n                \n                \n\n                $scope.open = function() {\n                    //must wrap 'opened' variable in an object for \n                    // angular to properly track its value changes\n                    // from within children scope (ie, the date picker)\n                    if (typeof($scope.uibopts) === 'undefined'){\n                       $scope.uibopts = {};\n                    }\n                    $scope.uibopts.opened = true;\n                };\n\n                $scope.onKeyUp = function(code) {\n                    if(code === 13) {   //enter\n                        $scope.done();\n                    } else if(code === 27) {    //esc\n                        $scope.cancel();\n                    }\n                };\n                $scope.onChange = function(date) {\n                    if(isNaN(ngModelController.$modelValue) && $scope.required) {\n                        $scope.error = \"This field requires a value\";\n                    } else $scope.error = null;\n                };\n            }\n        };\n\n    }])\n\n\n\n    .directive('gpSlickFormSelect', ['$timeout', function($timeout) {\n\n        return {\n            restrict: 'AE',\n            require: 'ngModel',\n            scope: {\n                label: \"@\",\n                codeList: \"=\",\n                help: '=',\n                required: \"@\",\n                readOnly: \"@\",\n                size: '@',\n                icon: '@'\n            },\n            template: SELECT_TEMPLATE,\n            link: function($scope, $element, $attrs, ngModelController) {\n\n                if(!$scope.type) $scope.type = \"text\";\n                if($scope.required === 'true')\n                    $scope.required = true;\n                else $scope.required = false;\n\n                $scope.elId = 'input_' + Math.ceil(Math.random()*9999);\n                $scope.size = $scope.size || 'medium';\n                $scope.type = $scope.type || 'text';\n\n                var $select = null;\n\n                function getSelect() {\n                    if(!$select || !$select.length)\n                        $select = $element.find('.form-control');\n                    return $select;\n                }\n\n\n                if($scope.codeList) {\n                    $scope.selectOptions = $scope.codeList.map(function(item) {\n                        if(typeof(item) !== 'object' || !item.value)\n                            return {value: item, label: item};\n                        else if(!item.label)\n                            return {value: item.value, label: item.value};\n                        return item;\n                    });\n                } else \n                    $scope.selectOptions = [];\n\n\n\n                //listen for changes to the inner value by way of the form-control\n                // $element.find('.form-control').on('change', function onChange() { \n                //     validate($scope.innerValue); \n                // });\n                \n                \n\n                /* ------------- private methods --------------- */\n\n                function validate() {\n\n                    //check form-control for ng-invalid\n                    var select = getSelect();\n\n                    $scope.isDirty = select.hasClass('ng-dirty');\n\n                    if(select.hasClass('ng-invalid')) {\n                        if(select.hasClass(\"ng-empty\"))\n                            $scope.error = \"This field requires a value\";\n                        else\n                            $scope.error = \"Invalid value provided\";\n                    } else\n                        $scope.error = null;\n\n                }\n\n                function update(newValue) {\n                    // call $parsers pipeline then update $modelValue\n                    ngModelController.$setViewValue(newValue);\n                    // update the local view\n                    ngModelController.$render();\n                }\n\n\n\n                // when model change, update our view (just update the div content)\n                ngModelController.$render = function() {\n                        \n                    var value = ngModelController.$viewValue;\n\n                    //@see https://github.com/angular/angular.js/commit/7fda214c4f65a6a06b25cf5d5aff013a364e9cef\n\n                    //create copy of passed in model value that can be used\n                    // by the controls here allowing us to cancel and \n                    // commit changes at our own leisure\n                    $scope.innerValue = value;\n\n                    $scope.displayValue = $scope.placeholder || \"No value provided\";\n\n                    if(value) {\n                        //values are objects, not literals\n                        var opt = $scope.selectOptions.find(function(o){return o.value==value;});\n                        $scope.displayValue = opt.label;\n                    }\n                    \n                    validate();\n                };\n\n\n                /* ------------- private methods --------------- */\n\n                $scope.onChange = function(value) {\n                    \n                    // console.log(\"Changing value \" + value + \" vs \" + $scope.innerValue);\n                    $scope.innerValue = value;                \n                    $timeout(function() { validate(); }, 200);\n\n                };\n\n                $scope.onTypeaheadSelection = function($item, $model, $label, $event) {\n\n                    $scope.innerValue = $item ? $item.value : null;\n                    $timeout(function() { validate(); }, 200);\n\n                };\n\n                $scope.isReadOnly = function() {\n                    var t = typeof(this.readOnly);\n                    if(t === 'undefined') return false;\n                    if(t === 'string') return this.readOnly.toLowerCase() === 'true';\n                    if(t === 'number') return this.readOnly === 1;\n                    if(t === 'boolean') return this.readOnly;\n                    return false;\n                };\n\n                //enter edit mode\n                $scope.edit = function() {\n                    if($scope.isReadOnly()) return;\n                    $scope.editing=true;\n                    //auto-focus on form-control when entering edit mode\n                    $timeout(function() { $select.focus().select(); }, 200);\n                };\n                //leave edit mode (regardless of save() or cancel())\n                $scope.done = function() {\n                    $scope.editing=false;\n                    $scope.error = null;\n                };\n\n\n                $scope.save = function() {\n                    //update display with new value\n                    update($scope.innerValue);\n                    $scope.done();\n                };\n                $scope.cancel = function() {\n                    //reset inner value\n                    $scope.innerValue = ngModelController.$viewValue;\n                    $scope.done();\n                };\n\n                $scope.onKeyUp = function(code) {\n                    if(code === 13 && !$scope.error) {   //enter\n                        $scope.save();\n                    } else if(code === 27) {    //esc\n                        $scope.cancel();\n                    }\n                };\n\n                $scope.onTypeaheadKeyUp = function(code) {\n                    validate();\n                };\n\n\n                $scope.$destroy = function() {\n                    // $element.off('change');\n                };\n            }\n        };\n\n    }])\n\n\n\n    ;\n\n\n    var INPUT_TEMPLATE = [\n        \n        '<div class=\"form-group form-group-slick\">',\n        \n        '   <label for=\"{{::elId}}\" class=\"control-label\">{{::label}}</label>',\n        \n        '   <div class=\"input__display\" ',\n        '       ng-class=\"{\\'is-read-only\\':isReadOnly(), \\'has-error\\':!!error,\\'text-lg\\':size===\\'large\\'}\" ',\n        '       ng-show=\"!editing\" ng-click=\"edit()\" ',\n        '       title=\"{{!!error?error:(!isReadOnly()?\\'Click to edit\\':\\'\\')}}\">',\n        '      {{displayValue}}',\n        '   </div>',\n        \n        '   <div ng-show=\"editing\">',\n        '      <div class=\"input-group\" ng-class=\"{\\'input-group-lg\\':size===\\'large\\'}\">',\n        '           <div class=\"input-group-slick\" ng-class=\"{\\'input-group-slick--lg\\':size===\\'large\\'}\">',\n        \n        '               <span ng-if=\"icon\" class=\"{{::icon}}\"></span>',\n        \n        '               <input id=\"{{::elId}}\" type=\"{{::type}}\" class=\"form-control\" ',\n        '                   pattern=\"{{pattern}}\" ',\n        '                   ng-model=\"innerValue\" ',\n        '                   ng-required=\"{{required}}\" ',\n        '                   ng-keypress=\"onKeyPress($event, $event.keyCode)\" ',\n        '                   ng-keyup=\"onKeyUp($event, $event.keyCode)\" >',\n        \n        '               <span class=\"indicators\">',\n        '                   <span class=\"is-valid glyphicon glyphicon-ok-sign\"></span>',\n        '                  <span class=\"is-invalid glyphicon glyphicon-exclamation-sign\"></span>',\n        '              </span>',\n        \n        '           </div>',\n        \n        '          <span class=\"input-group-btn\">',\n        \n        '               <button type=\"button\" class=\"btn btn-default\" ',\n        '                   ng-class=\"{\\'btn-lg\\':size===\\'large\\'}\"' ,\n        '                   ng-click=\"cancel()\" title=\"Cancel changes\">',\n        '                   <span class=\"glyphicon glyphicon-ban-circle\"></span>',\n        '              </button>',\n        \n        '               <button type=\"button\" class=\"btn btn-default\" ',\n        '                   ng-class=\"{disabled:!!error||!isDirty,\\'btn-lg\\':size===\\'large\\'}\"' ,\n        '                   ng-disabled=\"{{!!error}}\" ',\n        '                   ng-click=\"save()\" title=\"Save changes\">',\n        '                  <span class=\"glyphicon glyphicon-ok\"></span>',\n        '               </button>',\n        \n        '           </span>',\n        \n        '       </div>', \n\n        '       <div ng-if=\"error && error.length\"><small class=\"help-block text-danger\">{{error}}</small></div>',\n        '       <div ng-if=\"help && help.length\"><small class=\"help-block\">{{help}}</small></div>',\n        \n        '   </div>',\n        \n        '</div>'\n\n    ].join(' ');\n\n    var TEXTAREA_TEMPLATE = [\n        '<div class=\"form-group form-group-slick\">',\n        \n        '   <label for=\"{{::elId}}\" class=\"control-label\">{{::label}}</label>',\n        \n        '   <div class=\"input__display\" ',\n        '       ng-class=\"{\\'is-read-only\\':isReadOnly(), \\'has-error\\':!!error,\\'text-lg\\':size===\\'large\\'}\" ',\n        '       ng-show=\"!editing\" ng-click=\"edit()\" ',\n        '       title=\"{{!!error?error:(!isReadOnly()?\\'Click to edit\\':\\'\\')}}\">',\n        '      {{displayValue}}',\n        '   </div>',\n        \n        '   <div ng-show=\"editing\">',\n        '      <div class=\"input-group\" ng-class=\"{\\'input-group-lg\\':size===\\'large\\'}\">',\n        '           <div class=\"input-group-slick\" ng-class=\"{\\'input-group-slick--lg\\':size===\\'large\\'}\">',\n        \n        '               <span ng-if=\"icon\" class=\"{{::icon}}\"></span>',\n        \n        '               <textarea rows=\"3\" id=\"{{::elId}}\" class=\"form-control\" ',\n        '                   ng-required=\"{{required}}\" ng-model=\"innerValue\"',\n        '                   ng-keypress=\"onKeyPress($event, $event.keyCode)\" ',\n        '                   ng-keyup=\"onKeyUp($event, $event.keyCode)\"></textarea>',\n        \n        '               <span class=\"indicators\">',\n        '                   <span class=\"is-valid glyphicon glyphicon-ok-sign\"></span>',\n        '                  <span class=\"is-invalid glyphicon glyphicon-exclamation-sign\"></span>',\n        '              </span>',\n        \n        '           </div>',\n        \n        '          <span class=\"input-group-btn\">',\n        \n        '               <button type=\"button\" class=\"btn btn-default\" ',\n        '                   ng-class=\"{\\'btn-lg\\':size===\\'large\\'}\"' ,\n        '                   ng-click=\"cancel()\" title=\"Cancel changes\">',\n        '                   <span class=\"glyphicon glyphicon-ban-circle\"></span>',\n        '              </button>',\n        \n        '               <button type=\"button\" class=\"btn btn-default\" ',\n        '                   ng-class=\"{disabled:!!error||!isDirty,\\'btn-lg\\':size===\\'large\\'}\"' ,\n        '                   ng-disabled=\"{{!!error}}\" ',\n        '                   ng-click=\"save()\" title=\"Save changes\">',\n        '                  <span class=\"glyphicon glyphicon-ok\"></span>',\n        '               </button>',\n        \n        '           </span>',\n        \n        '       </div>', \n\n        '       <div ng-if=\"error && error.length\"><small class=\"help-block text-danger\">{{error}}</small></div>',\n        '       <div ng-if=\"help && help.length\"><small class=\"help-block\">{{help}}</small></div>',\n        \n        '   </div>',\n        \n        '</div>'\n    ].join(' ');\n\n    var DATE_TEMPLATE = [\n\n        \n        '<div class=\"form-group form-group-slick\">',\n        \n        '   <label for=\"{{::elId}}\" class=\"control-label\">{{::label}}</label>',\n\n        '   <div class=\"input__display\" ',\n        '       ng-class=\"{\\'is-read-only\\':isReadOnly(), \\'has-error\\':!!error}\" ',\n        '       ng-show=\"!editing\" ng-click=\"edit()\" ',\n        '       title=\"{{!!error?error:(!isReadOnly()?\\'Click to edit\\':\\'\\')}}\">',\n        '      {{displayValue}}',\n        '   </div>',\n        \n        '   <div ng-show=\"editing\">',\n        '       <div uib-datepicker ng-required=\"{{required}}\" ng-model=\"innerValue\" datepicker-options=\"{showWeeks:false}\"></div>',\n        \n        '       <div ng-if=\"error && error.length\"><small class=\"help-block text-danger\">{{error}}</small></div>',\n        '       <div ng-if=\"help && help.length\"><small class=\"help-block\">{{help}}</small></div>',\n        \n        '       <button type=\"button\" class=\"btn btn-default\" ',\n        '           ng-class=\"{\\'btn-lg\\':size===\\'large\\'}\"' ,\n        '           ng-click=\"cancel()\" title=\"Cancel changes\">',\n        '           <span class=\"glyphicon glyphicon-ban-circle\"></span>',\n        '      </button>',\n        \n        '      <button type=\"button\" class=\"btn btn-default\" ',\n        '           ng-class=\"{disabled:!!error,\\'btn-lg\\':size===\\'large\\'}\"' ,\n        '          ng-disabled=\"{{!!error}}\" ',\n        '           ng-click=\"save()\" title=\"Save changes\">',\n        '           <span class=\"glyphicon glyphicon-ok\"></span>',\n        '      </button>',\n\n        '   </div>',\n\n        '</div>'\n\n    ].join(' ');\n\n    var SELECT_TEMPLATE = [\n        \n        '<div class=\"form-group form-group-slick\">',\n        \n        '   <label for=\"{{::elId}}\" class=\"control-label\">{{::label}}</label>',\n        \n        '   <div class=\"input__display\" ',\n        '       ng-class=\"{\\'is-read-only\\':isReadOnly(), \\'has-error\\':!!error}\" ',\n        '       ng-show=\"!editing\" ng-click=\"edit()\" ',\n        '       title=\"{{!!error?error:(!isReadOnly()?\\'Click to edit\\':\\'\\')}}\">',\n        '      {{displayValue}}',\n        '   </div>',\n        \n        '   <div ng-show=\"editing\">',\n\n        '      <div class=\"input-group\" ng-class=\"{\\'input-group-lg\\':size===\\'large\\'}\">',\n        \n        '           <div class=\"input-group-slick\" ng-class=\"{\\'input-group-slick--lg\\':size===\\'large\\'}\">',\n        \n        '               <span ng-if=\"icon\" class=\"{{::icon}}\"></span>',\n        \n        '               <select class=\"form-control input__field\" ',\n        '                   ng-if=\"codeList.length<=12\" ',\n        '                   ng-model=\"innerValue\" ',\n        '                   ng-options=\"opt.value as opt.label for opt in selectOptions\" ',\n        '                   ng-required=\"{{required}}\" ',\n        '                   ng-change=\"onChange(innerValue)\" ',\n        '                   ng-keyUp=\"onKeyUp($event.keyCode)\" >',\n        '                   <option value=\"\">Select One</option>',\n        '               </select>',\n\n        '               <input type=\"text\" class=\"form-control input__field\" ng-if=\"codeList.length>12\" ',\n        '                   ng-model=\"innerValue\" ',\n        '                   ng-required=\"{{required}}\" ',\n        '                   ng-keyUp=\"onTypeaheadKeyUp($event.keyCode)\" ',\n        '                   typeahead-on-select=\"onTypeaheadSelection($item, $model, $label, $event)\" ',\n        '                   uib-typeahead=\"opt.value as opt.label for opt in selectOptions | filter:{value:$viewValue} | limitTo:12\" ',\n        '                   typeahead-min-length=\"0\" ',\n        '                   typeahead-editable=\"false\">',\n        \n        '               <span class=\"indicators\">',\n        '                   <span class=\"is-valid glyphicon glyphicon-ok-sign\"></span>',\n        '                  <span class=\"is-invalid glyphicon glyphicon-exclamation-sign\"></span>',\n        '              </span>',\n        \n        '           </div>',\n        \n        '          <span class=\"input-group-btn\">',\n        \n        '               <button type=\"button\" class=\"btn btn-default\" ',\n        '                   ng-class=\"{\\'btn-lg\\':size===\\'large\\'}\"' ,\n        '                   ng-click=\"cancel()\" title=\"Cancel changes\">',\n        '                   <span class=\"glyphicon glyphicon-ban-circle\"></span>',\n        '              </button>',\n        \n        '               <button type=\"button\" class=\"btn btn-default\" ',\n        '                   ng-class=\"{disabled:!!error||!isDirty,\\'btn-lg\\':size===\\'large\\'}\"' ,\n        '                   ng-disabled=\"{{!!error}}\" ',\n        '                   ng-click=\"save()\" title=\"Save changes\">',\n        '                  <span class=\"glyphicon glyphicon-ok\"></span>',\n        '               </button>',\n        \n        '           </span>',\n        \n        '       </div>',\n        \n        '       <div ng-if=\"error && error.length\"><small class=\"help-block text-danger\">{{error}}</small></div>',\n        '       <div ng-if=\"help && help.length\"><small class=\"help-block\">{{help}}</small></div>',\n        \n        '   </div>',\n        \n        '</div>'\n\n    ].join(' ');\n\n})(jQuery, angular);","(function(angular) {\n    \n    \"use strict\";\n\n    angular.module(\"gp-common\").directive('gpTweetButton', ['$timeout', function($timeout) {\n        \n        function debounce(func, wait, immediate) {\n            var timeout;\n            return function() {\n                var context = this,\n                    args = arguments;\n                var later = function() {\n                    timeout = null;\n                    if (!immediate) func.apply(context, args);\n                };\n                var callNow = immediate && !timeout;\n                clearTimeout(timeout);\n                timeout = setTimeout(later, wait);\n                if (callNow) func.apply(context, args);\n            };\n        }\n\n        return {\n            link: function(scope, element, attr) {\n\n                if(typeof(twttr) === 'undefined') {\n                    element.className += ' disabled';\n                    return;\n                }\n\n                var renderTwitterButton = debounce(function() {\n                    if (attr.url) {\n                        $timeout(function() {\n                            element[0].innerHTML = '';\n                            twttr.widgets.createShareButton(\n                                attr.url,\n                                element[0],\n                                function() {}, {\n                                    count: attr.count,\n                                    text: attr.text,\n                                    via: attr.via,\n                                    size: attr.size,\n                                    hashtags: attr.hashtags,\n                                    dnt: attr.dnt\n                                }\n                            );\n                        });\n                    }\n                }, 75);\n                attr.$observe('url', renderTwitterButton);\n                attr.$observe('text', renderTwitterButton);\n            }\n        };\n    }]);\n\n}) (angular);","(function(angular) {\n\n    \"use strict\";\n\n    angular.module(\"gp-common\").directive('sortOrder', function() {\n        return {\n            \n            replace: true,\n            require: 'ngModel',\n            \n            template: [\n                '<div>',\n                '<a class=\"btn btn-default\" title=\"Click to sort in ascending order\" href ng-if=\"value===\\'dsc\\'\" ng-click=\"toggle()\">',\n                '    <span class=\"glyphicon glyphicon-sort-by-attributes-alt\"></span>',\n                '</a>',\n                '<a class=\"btn btn-default\" title=\"Click to sort in descending order\" href ng-if=\"value===\\'asc\\'\" ng-click=\"toggle()\">',\n                '    <span class=\"glyphicon glyphicon-sort-by-attributes\"></span>',\n                '</a>',\n                '</div>'\n            ].join(' '),\n\n            link: function($scope, element, attrs, ngModel) {\n                ngModel.$viewChangeListeners.push(function() {\n                    $scope.$eval(attrs.ngChange);\n                });\n                ngModel.$render = function() {\n                    $scope.value = ngModel.$modelValue;\n                };\n                $scope.toggle = function() {\n                    $scope.value = $scope.value === 'asc' ? 'dsc' : 'asc';\n                    ngModel.$setViewValue($scope.value);\n                };\n            }\n        };\n    });\n\n})(angular);","(function(jQuery, angular) {\n    \n    \"use strict\"; \n    \n    angular.module(\"gp-common\")\n\n    /**\n     * Custom filter to make label values visually helpful by \n     * replacing bad characters with spaces or meaningful equivalents\n     */\n    .filter('fixLabel', function() {\n        return function(input) {\n            input = input || '';\n            return input.replace(/_/g,' ');\n        };\n    })\n\n    .filter('pluralize', function() {\n        return function(text) {\n            if(!text || !text.length) return \"\";\n            if(text.endsWith('ss')) return text + 'es'; //classes, etc\n            if(text.endsWith('s')) return text;         //already plural\n            return text + 's';\n            //TODO support irregular words like \"foot\" -> \"feet\"\n            // and words that need duplicate letters: \"quiz\" -> \"quizzes\"\n        };\n    })    \n\n    .filter('capitalize', function() {\n        return function(text) {\n            return text[0].toUpperCase() + text.substring(1);\n        };\n    })\n\n\n    .filter('facets', function() {\n\n        return function(arr,facetName) {\n            if(!facetName) return arr;\n            if(!arr || !arr.length) return [];\n            return arr.filter(function(f){return f.toLowerCase().startsWith(facetName + \":\");})\n                .map(function(f) {return f.substring(f.indexOf(':')+1, f.length);});\n        };\n\n    })\n\n    .filter('joinBy', function () {\n        return function (input,delimiter,emptyValue) {\n            if(input.length) return input.join(delimiter || ', ');\n            else             return emptyValue || '';\n        };\n    })\n\n\n\n    .filter('defaultValue', function() {\n        return function(text, defVal) {\n            if(typeof(text)==='undefined' || !text.length) return defVal;\n            return text;\n        };\n    })\n\n    .filter('count', function() {\n        return function(input) {\n            if(typeof(input) !== 'undefined') {\n                if(typeof(input.push) === 'function') \n                    return input.length;\n                if(typeof(input) === 'object') {\n                    if(typeof(Object.keys) !== 'undefined') {\n                        return Object.keys(input);\n                    }\n                }\n            }\n            return 0;\n        };\n    })\n\n    ;\n\n})(jQuery, angular);","(function(angular) {\n    \n    'use strict';\n\n\n    /* *********************************************\n     * Requires socket.io be in the global namespace\n     * tested with version 2.x\n     * ********************************************* */\n\n\n\n     /*\n        Usage:\n\n        let service = ...\n\n        let svcId = service.getId();\n\n        //listen to events from the server\n        service.on('testing', (event) => { \n            if(event.clientId === svcId) return; //ignore our own events\n            ... do something ...\n        });\n        \n        //sends out a message to others\n        service.emit( service.events.CREATED, 'test');\n\n        //sends out a message to others\n        service.begin(service.events.EDITING, 'test');\n\n        //sends out a message to others\n        service.end(service.events.EDITING, 'test');\n\n        //stop listening and close the socket\n        service.close();\n\n      */\n\n\n\n\n    class SocketService {\n\n        constructor (id, url) {\n\n            this.socket = null;\n            this.socketId = id;\n\n            //list of ids of things being tracked, such as \n            // items edited, in order to send messages\n            // about the things lifecycle\n            this.tracking = [];\n\n            //events supported.\n            // Note that lifecycles can be added by using the \n            // begin() and end() methods on the service,\n            // which appends '_start' and '_end' respectively\n            this.events = {\n                CREATED: 'created',\n                UPDATED: 'updated',\n                DELETED: 'deleted',\n                EDITING: 'editing'\n            };\n\n            if(typeof(io) === 'undefined') {\n                console.log(\"Socket.IO not found in global namespace\");\n                return;\n            }\n\n            if(!url) {   //TODO validate URL with regex?\n                console.log(\"No web socket URL configured for this app to communicate with\");\n                return;\n            }\n\n            this.socket = io.connect(url);\n\n        }\n\n        getId () { return this.socketId; }\n            \n        /**\n         * @param {string} eventName\n         * @param {Function} callback\n         * @return {Function} to remove the listener\n         */\n        on (eventName, callback) {\n            if(!this.socket) return;\n            \n            // let handle =  () => {  \n            //     var args = arguments;\n            //     $rootScope.$apply( () => {\n            //         callback.apply(this.socket, args);\n            //     });\n            // };\n\n            this.socket.on(eventName, callback);\n\n            return () => { this.socket.off(eventName, callback); };\n        }\n\n        /**\n         *\n         */\n        emit (eventName, data /*, callback*/) {\n            if(!this.socket) return;\n\n            this.socket.emit(eventName, data, () => {\n                /*\n                var args = arguments;\n                $rootScope.$apply(() => {\n                    if (callback) {\n                        callback.apply(this.socket, args);\n                    }\n                });\n                */\n            });  \n        }\n\n        /**\n         * Closes this service's socket\n         */\n        close () { \n\n            //if this app was editing an obj, notify listeners that it is no longer\n            if(this.tracking && this.tracking.length) {\n                angular.forEach(this.tracking, (id) => { this.end(id); });\n            }\n\n            if(this.socket) {\n                this.socket.close(); \n                this.socket = null;\n            }\n\n            return null;\n        }\n\n        /**\n         * @param {string} event - name of the event being started\n         * @param {string} objId - identifier of the item being tracked\n         */\n        begin (event, objId) {\n            this.tracking.push(objId);\n            this.emit('client', {\n                event: event + '_start',\n                clientId: this.socketId,\n                data: { id: objId }\n            });\n        }\n\n        /**\n         * @param {string} event - name of the event being ended\n         * @param {string} objId - identifier of the item being tracked\n         */\n        end (event, objId) {\n            let idx = this.tracking.indexOf(objId);\n            if(idx >= 0) {\n                this.tracking.splice(idx, 1);\n\n                this.emit('client', {\n                    event: event + '_end',\n                    clientId: this.socketId,\n                    data: { id: objId }\n                });\n            }\n        }\n\n    }\n\n\n\n\n    /** \n     * Factory to get a Service used to listen for WebSocket messages from a server\n     *\n     * Usage: \n     *\n     * let wsUrl = ...\n     * let service = SocketServiceFactory(wsUrl);\n     *\n     */\n     angular.module('gp-common').factory('SocketServiceFactory', function ($rootScope, $window, UUID) {\n\n        var cache = {};\n\n\n        //disconnect whenever the app is closed\n        var onClose = (e) => { \n            for(var url in cache) {\n                if(cache.hasOwnProperty(url)) {\n                    cache[url].close();\n                }\n            }\n            cache = null;\n            return null;\n        };\n        \n        //needed for reload/backbtn\n        if($window.onbeforeunload === 'function') {\n            let existing = $window.onbeforeunload;\n            $window.onbeforeunload = function(e) {\n                onClose(e);\n                return existing(e);\n            };\n        } else {\n            $window.onbeforeunload = onClose;      \n        }\n\n        $rootScope.$on('$destroy', onClose);\n        //-------------------\n\n\n        return function(url) {\n\n            if(!url) return null;\n            if(cache[url]) return cache[url];\n\n            let service = new SocketService(UUID(), url);\n            cache[url] = service;\n            return service;\n\n        };\n\n    });\n\n}) (angular);","(function(angular) {\n    \n    'use strict';\n\n    angular.module(\"gp-common\").factory('UUID', function() {\n            \n        function s4() {\n            return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n        }\n\n        /*\n        return function() {\n                return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n                    s4() + '-' + s4() + s4() + s4();\n            }\n         */\n\n        return function() {\n            // http://www.ietf.org/rfc/rfc4122.txt\n            var s = [];\n            var hexDigits = \"0123456789abcdef\";\n            for (var i = 0; i < 36; i++) {\n                s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n            }\n            s[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n            s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n            s[8] = s[13] = s[18] = s[23] = \"-\";\n            return s.join(\"\");\n        }\n        \n    });\n\n})(angular);","(function(angular) {\n    \n    'use strict';\n\n    //flag on whether we're in dev env\n    function isDEV() {\n        return \"localhost\" === window.location.hostname || \n            ~window.location.hostname.indexOf(\"192.168\")||\n            ~window.location.hostname.indexOf(\"10.0\");\n    }\n\n\n\n    /** \n     * GeoPlatform Common Module Authentication Support\n     *\n     * Contains re-usable services, directives, and other angular components\n     *\n     * \n     * NOTE: This module uses certain variables in $rootScope in order to \n     * perform actions like authentication.  The following variables should be\n     * set before using any service/directive in this file:\n     *\n     *   - idspUrl : the url to the identity service provider server\n     *   - idmUrl : the url to the identity management server\n     *   - portalUrl : the url to the main landing page of GeoPlatform (www.geoplatform.gov in production) \n     */\n    angular.module('gp-common')\n\n    /**\n     * Authentication Service\n     * \n     * Because the auth service redirects the page to the IDM portal\n     * and WMV is reloaded once the login/logout processes are complete,\n     * there's no need to bind listeners informing other components of \n     * an auth change.\n     *\n     * Inside \"DEV\", you should close and re-open any components' widgets\n     * to get current auth status.\n     */\n    .service('AuthenticationService', ['$q', '$http', 'GPConfig', function($q, $http, Config) {\n\n        // console.log(\"IDSP Base Url: \" + Config.idspUrl);\n\n        function User(opts) {\n            for(var p in opts) {\n                this[p] = opts[p];\n            }\n            if(!this.id && this.username)\n                this.id = this.username;\n\n            this.toJSON = function() {\n                return {\n                    id: this.id,\n                    username: this.username, \n                    name: this.name, \n                    email: this.email,\n                    org: this.org\n                };\n            };\n            this.clone = function() {\n                return new User(this.toJSON());\n            };\n            this.compare = function(arg) {\n                if(arg instanceof User) {\n                    return this.id === arg.id;\n                } else if(typeof(arg) === 'object') {\n                    return typeof(arg.id) !== 'undefined' && \n                        arg.id === this.id;\n                }\n                return false;\n            };\n        }\n\n\n        var TEST_USER = new User({\n            id: \"tester\",\n            username: \"tester\", \n            email: \"tester@geoplatform.us\",\n            name: \"John Test\", \n            org: \"Other\"\n        });\n\n\n        var _user = null;\n\n        if(isDEV()) {\n\n            /*\n             * If testing when user is not logged in, inject the following before\n             *  this ng-common library is included in the page:\n             * \n             *     GeoPlatform.TEST_NO_AUTH = true;\n             * \n             *  but be sure to inject AFTER the GeoPlatform configuration object exists!\n             */\n            if(GeoPlatform && GeoPlatform.TEST_NO_AUTH)\n                _user = null;\n            else \n                _user = TEST_USER.clone();\n        }    \n\n        var STATUS = {\n            NONE: 0,\n            INITIALIZING: -1,   //auth check in progress\n            INITIALIZED: 1      //auth check completed\n        };\n\n\n        /**\n         * Authentication Service\n         */\n        var Service = function() {\n\n            var self = this;\n            \n\n            this.status = STATUS.NONE;\n\n            //$q version of getUser\n            this.getUserQ = function() {\n                var deferred = $q.defer();\n                this.getUser(function(user) { deferred.resolve(user); });\n                return deferred.promise;\n            };\n\n            /**\n             * If the callback parameter is specified, this method\n             * will return undefined. Otherwise, it returns the user (or null).\n             *\n             * @param callback optional function to invoke with the user\n             * @return object representing current user\n             */\n            this.getUser = function(callback) {\n                if(callback && typeof(callback) === 'function') {\n\n                    // console.log(\"Getting user info: \" + self.status + \", \" + JSON.stringify(_user||{empty:true}));\n\n                    //if already checked, return what we have\n                    if(self.status === STATUS.INITIALIZED) \n                        callback(_user);\n                    //if not in process of checking, check\n                    else if(self.status !== STATUS.INITIALIZING) {\n                        //if hasn't been checked for auth yet, do that now\n                        self.check().then(function(_user) {\n                            self.status = STATUS.INITIALIZED;\n                            callback(_user);\n                        }, function() {\n                             self.status = STATUS.INITIALIZED;\n                             callback(null);\n                        });\n                    } \n                    //if in process of checking, wait until it finishes\n                    else {\n                        setTimeout(function() {\n                            self.getUser(callback);\n                        }, 500);\n                    }\n                    return;\n                }\n                return _user;\n            };\n\n            /**\n             * Redirects the page to the login site\n             */\n            this.login = function () {\n                if(isDEV() && !(GeoPlatform && GeoPlatform.TEST_NO_AUTH)) {\n                    _user = TEST_USER.clone();\n                    return _user;\n                }\n                var current = window.location.href;\n                window.location = Config.idspUrl + '/module.php/core/as_login.php?AuthId=geosaml&ReturnTo=' + encodeURIComponent(current);\n            };\n\n            /**\n             * Redirects the page to the logout site\n             */\n            this.logout = function() {\n                if(isDEV()) {\n                    _user = null;\n                    return _user;\n                }\n                var current = window.location.href;\n                window.location = Config.idspUrl + '/module.php/core/as_logout.php?AuthId=geosaml&ReturnTo=' + encodeURIComponent(current);\n            };\n\n\n            /**\n             * Queries simplesamlphp if the current session is authenticated\n             * @return promise - then(function(user) {}, function(response){})\n             */\n            this.check = function() {\n                \n                var deferred = $q.defer();\n                \n                if(isDEV()) {\n                    // console.log(\"Dev env\");\n                    setTimeout(function() {\n                        deferred.resolve(_user);\n                    }, 1000);\n                    return deferred.promise;\n                }\n\n                self.status = STATUS.INITIALIZING;\n\n                //check authentication on load\n                var promise = $http.get(Config.idspUrl + '/authenticategeosaml.php?as=geosaml');\n                promise.then(function(response) {\n                    \n                    var content = response.data ? response.data : response;\n\n                    // console.log(\"Received from SP: \" + content);\n                    if(typeof(content) === 'string') {\n                        try {\n                            content = JSON.parse(content);\n                        } catch(e) {\n                            deferred.reject(e);\n                            return;\n                        }\n                    }\n                    \n                    if(content.Success) {  //authenticated\n                        _user = new User({\n                            id       : content.name[0],\n                            username : content.name[0],\n                            email    : content.mail[0],\n                            name     : content.first_name[0] + ' ' + content.last_name[0],\n                            org      : content.organization[0]\n                        });\n                        // console.log(\"Authenticated user: \" + JSON.stringify(_user));\n\n                    } else {\n                        _user = null;       //not authenticated\n                        // console.log(\"Failed to authenticate user\");\n                    }\n\n                    deferred.resolve(_user);\n                    \n                }, function(data, status, headers) {   // failed check\n                    // console.log(\"Authentication call failed\");\n                    deferred.reject(data);\n                }).catch(function(e) {\n                    // console.log(\"Authentication check caught an error: \" + e.message);\n                    deferred.reject(e.message);\n                });\n\n                return deferred.promise;\n            };\n\n            //=====================================================\n\n            //initialize with auth check\n            this.check().then(function(user) {\n                self.status = STATUS.INITIALIZED;\n            }, function(err) {\n                self.status = STATUS.INITIALIZED;\n            }).catch(function(e) {\n                // console.log(\"Initial auth check errored\");\n            });\n\n        };\n\n        return new Service();\n\n    }])\n\n    .directive('gpLoginButton', ['$timeout', 'AuthenticationService', 'GPConfig', \n        function($timeout, AuthenticationService, Config) {\n        return {\n            scope: {\n                minimal: '@'\n            },\n            replace: true,\n            template: [\n\n                '<div class=\"btn-account btn-group\">' + \n\n                //not logged in\n                '  <a class=\"btn btn-link\" ng-click=\"login()\" ng-if=\"!user\">Sign In</a>' + \n                \n                //logged in\n                '  <button type=\"button\" class=\"btn btn-link dropdown-toggle\" data-toggle=\"dropdown\" ' + \n                '   aria-expanded=\"false\" ng-if=\"user\">' + \n                '     <span class=\"glyphicon glyphicon-user\"></span> ' +\n                '     <span class=\"hidden-xs\">{{::user.name}}</span> ' + \n                '     <span class=\"caret\"></span>' + \n                '  </button>' + \n                '  <ul class=\"dropdown-menu dropdown-menu-right\" role=\"menu\" ng-if=\"user\">' + \n                '    <li class=\"account-details\">' + \n                '      <div class=\"media\">' + \n                '        <div class=\"media-left\">' + \n                '          <div class=\"media-object\">' + \n                '            <span class=\"glyphicon glyphicon-user glyphicon-xlg\"></span>' + \n                '          </div>' + \n                '        </div>' + \n                '        <div class=\"media-body\">' + \n                '          <div class=\"media-heading\">{{::user.name}}</div>' + \n                '          <div><em>{{::user.username}}</em></div>' + \n                '          <div>{{::user.email}}</div>' + \n                '          <div>{{::user.org}}</div>' + \n                '        </div>' + \n                '      </div>' + \n                '    </li>' + \n                '    <li class=\"divider\"></li>' + \n                '    <li><a href=\"{{::idpUrl}}/modifyuser.html\">Edit Info</a></li>' + \n                '    <li><a href=\"{{::idpUrl}}/changepassword.html\">Change Password</a></li>' + \n                '    <li><a href ng-click=\"logout()\">Sign Out</a></li>' + \n                '  </ul>' + \n\n\n                '</div>'\n            ].join(' '),\n            controller: function($scope, $element) {\n\n                if($scope.minimal === 'true') $scope.minimal = true;\n                if($scope.minimal !== true) $scope.minimal = false;\n\n                $scope.idpUrl = Config.idmUrl;\n                // console.log(\"IDM Base Url: \" + Config.idmUrl);\n                \n                AuthenticationService.getUser(function(user) {\n                    $timeout(function() {\n                        $scope.user = user;\n                    },100);\n                });\n                \n                $scope.login = function() {\n                    $scope.user = AuthenticationService.login();\n                };\n\n                $scope.logout = function() {\n                    $scope.user = AuthenticationService.logout();\n                };\n\n                //watch user for changes (timeouts)\n                var watcher = $scope.$watch(function() { return AuthenticationService.getUser(); }, function(newUser) {\n                    $scope.user = newUser;\n                });\n\n                $scope.$on('$destroy', function() {\n                    watcher();  //destroy watcher\n                });\n            }\n        };\n    }])\n\n\n    \n    .directive('gpAccountDetails', ['$timeout', 'AuthenticationService', 'GPConfig', \n        function($timeout, AuthenticationService, Config) {\n\n        return {\n            scope: {},\n            replace: true,\n            template: [\n                '<div>' + \n                '  <div class=\"media\">',\n                '    <div class=\"media-left\">',\n                '        <div class=\"media-object\">',\n                '            <span class=\"glyphicon glyphicon-user glyphicon-xlg\"></span>',\n                '        </div>',\n                '    </div>',\n                '    <div class=\"media-body\" ng-if=\"user\">',\n                '       <div class=\"media-heading\">{{::user.name}}</div>' + \n                '       <div><small><em>{{::user.username}}</em></small></div>' + \n                '       <div><small>{{::user.email}}</small></div>' + \n                '       <div><small>{{::user.org}}</small></div>' +  \n                '    </div>',\n                '    <div class=\"media-body\" ng-if=\"!user\">',\n                '       <div class=\"media-heading\">Please Sign In</div>' + \n                '       <div><small>Sign in to your GeoPlatform account or register a new account.</small></div>' + \n                '    </div>',\n                '  </div>',\n                '  <hr/>',\n                '  <div ng-if=\"user\">',\n                '    <button type=\"button\" class=\"btn btn-sm btn-accent pull-right\" ng-click=\"logout()\">Sign Out</button>' + \n                '    <a class=\"btn btn-sm btn-default\" href=\"{{::idpUrl}}/modifyuser.html\">Edit Details</a>' + \n                '  </div>',\n                '  <div ng-if=\"!user\">',\n                '    <button type=\"button\" class=\"btn btn-sm btn-accent pull-right\" ng-click=\"login()\">Sign In</button>' + \n                '    <a class=\"btn btn-sm btn-default\" href=\"{{::idpUrl}}/registeruser.html\">Register</a>' + \n                '  </div>',\n                '</div>'\n            ].join(' '),\n            controller: function($scope, $element) {\n                \n                $scope.idpUrl = Config.idmUrl;\n\n                AuthenticationService.getUser(function(user) {\n                    $timeout(function() {\n                        $scope.user = user;\n                    },100);\n                });\n                \n                $scope.login = function() {\n                    $scope.user = AuthenticationService.login();\n                };\n\n                $scope.logout = function() {\n                    $scope.user = AuthenticationService.logout();\n                };\n\n                //watch user for changes (timeouts)\n                var watcher = $scope.$watch(function() { return AuthenticationService.getUser(); }, function(newUser) {\n                    $scope.user = newUser;\n                });\n\n                $scope.$on('$destroy', function() {\n                    watcher();  //destroy watcher\n                });\n\n            }\n        };\n    }])\n\n;\n\n})(angular);","(function() {\n\n    \"use strict\";\n\n    if(typeof(Array.prototype.find) === 'undefined') {\n        Array.prototype.find = function(callback) {\n            for(var i=0; i<this.length; ++i) {\n                if(callback(this[i], i, this))\n                    return this[i];\n            }\n            return null;\n        };\n    }\n    if(typeof(Array.prototype.filter) === 'undefined') {\n        Array.prototype.filter = function(callback) {\n            var results = [];\n            for(var i=0; i<this.length; ++i) {\n                if(callback(this[i], i, this))\n                    results.push(this[i]);\n            }\n            return results;\n        };\n    }\n    if(typeof(Array.prototype.each) === 'undefined') {\n        Array.prototype.each = function(callback) {\n            for(var i=0; i<this.length; ++i) {\n                callback(this[i], i, this);\n            }\n        };\n    }\n    if(typeof(String.prototype.startsWith) === 'undefined') {\n        String.prototype.startsWith = function(value) {\n            var str = this;\n            if(!str.length)     return false;\n            if(!value.length)   return false;\n            if(str.length < value.length) return false;\n            return str.indexOf(value) === 0;\n        };\n    }\n    if(typeof(String.prototype.endsWith) === 'undefined') {\n        String.prototype.endsWith = function(value) {\n            var str = this;\n            if(!str.length)     return false;\n            if(!value.length)   return false;\n            if(str.length < value.length) return false;\n            var substr = str.substring(\n                str.length - value.length,\n                str.length\n            );\n            return substr == value;\n        };\n    }\n\n\n\n\n    if(typeof(Date.prototype.plus) === 'undefined') {\n        Date.prototype.plus = function(offset) {\n            \n            var type = typeof(offset);\n            if(type === 'undefined') return this;\n\n            var offsetMS = 0;\n            if(type === 'string') {\n                switch(offset) {\n                    case 'hour':    offsetMS = 1000*60*60; break;\n                    case 'day':     offsetMS = 1000*60*60*24; break;\n                    case 'week':    offsetMS = 1000*60*60*24*7; break;\n                    case 'month':   offsetMS = 1000*60*60*24*31; break;\n                    case 'year':    offsetMS = 1000*60*60*24*365; break;\n                }\n            } else if(type === 'number') {\n                offsetMS = offset;\n            } else return this;\n\n            var d = this;\n            return new Date(d.getTime() + offsetMS);\n        };\n    }\n\n    if(typeof(Date.prototype.random) === 'undefined') {\n        Date.prototype.random = function(threshold) {\n\n            var type = typeof(threshold);\n            if(type === 'undefined') return this;\n\n            var offsetMS = 0;\n            if(type === 'string') {\n                switch(threshold) {\n                    case 'hour':    offsetMS = 1000*60*60; break;\n                    case 'day':     offsetMS = 1000*60*60*24; break;\n                    case 'week':    offsetMS = 1000*60*60*24*7; break;\n                    case 'month':   offsetMS = 1000*60*60*24*31; break;\n                    case 'year':    offsetMS = 1000*60*60*24*365; break;\n                }\n            } else if(type === 'number') {\n                offsetMS = threshold;\n            } else return this;\n\n            var d = this;\n            return new Date(d.getTime() + Math.floor(Math.random()*offsetMS));\n        };\n    }\n\n})();"],"sourceRoot":"/source/"}