{"version":3,"sources":["../../node_modules/tslib/tslib.es6.js","ng://@geoplatform/common/logger.ts","ng://@geoplatform/common/auth/authenticated.component.ts","ng://@geoplatform/common/auth/auth.factory.ts","ng://@geoplatform/common/auth/auth.service.ts","ng://@geoplatform/common/auth/login.ts","ng://@geoplatform/common/dialogs/list-select/list-select.ts","ng://@geoplatform/common/dialogs/message/message.ts","ng://@geoplatform/common/directives/icon.ts","ng://@geoplatform/common/components/header/header.component.ts","ng://@geoplatform/common/item-helper.ts","ng://@geoplatform/common/components/link/link.component.ts","ng://@geoplatform/common/event.ts","ng://@geoplatform/common/components/selected/selected.component.ts","ng://@geoplatform/common/components/thumbnail/thumbnail.component.ts","ng://@geoplatform/common/error.ts","ng://@geoplatform/common/error.service.ts","ng://@geoplatform/common/item-factory.ts","ng://@geoplatform/common/tracking.factory.ts","ng://@geoplatform/common/pipes.ts","ng://@geoplatform/common/resolvers.ts","ng://@geoplatform/common/search/search.service.ts","ng://@geoplatform/common/search/item/item-adapter.ts","ng://@geoplatform/common/search/item/item.component.ts","ng://@geoplatform/common/search/results/results.component.ts","ng://@geoplatform/common/search/filters/item-filter.component.ts","ng://@geoplatform/common/search/filters/community/community.component.ts","ng://@geoplatform/common/search/filters/creator/creator.component.ts","ng://@geoplatform/common/search/filters/keyword/keyword.component.ts","ng://@geoplatform/common/search/filters/publisher/publisher.component.ts","ng://@geoplatform/common/search/filters/scheme/scheme.component.ts","ng://@geoplatform/common/search/filters/semantic/semantic.dialog.ts","ng://@geoplatform/common/search/filters/semantic/semantic.component.ts","ng://@geoplatform/common/search/filters/service-types/service-types.component.ts","ng://@geoplatform/common/search/filters/similarity/similarity.component.ts","ng://@geoplatform/common/search/filters/theme/theme.component.ts","ng://@geoplatform/common/search/filters/topic/topic.component.ts","ng://@geoplatform/common/search/filters/type/type.component.ts","ng://@geoplatform/common/search/filters/modified/modified.component.ts","ng://@geoplatform/common/module.ts","ng://@geoplatform/common/public_api.ts","ng://@geoplatform/common/map-types.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__read","o","n","m","Symbol","iterator","e","call","ar","next","done","push","value","error","__spread","concat","LEVELS","logger","Logger","level","setLevel","Config","logLevel","LOG_LEVEL","indexOf","info","isVisible","log","arg","_this","addl","_i","msg","toStr","map","a","join","console","debug","apply","warn","JSON","stringify","AuthenticatedComponent","authService","ngOnInit","init","ngOnDestroy","destroy","obs","username","user","onUserChange","err","message","complete","gpAuthSubscription","subscribe","getUser","unsubscribe","isAuthenticated","getAuthToken","getToken","checkAuth","check","canUserEdit","item","isAuthorized","isAuthorOf","createdBy","AUTH_KEYS","authServiceFactory","environment","authSettings","gpGlobal","window","GeoPlatform","config","auth","APP_BASE_URL","wpUrl","forEach","v","ngGpoauthFactory","AppAuthService","rpm","observers","user$","Subject","sub","getMessenger","raw","name","then","getJWT","checkWithClient","token","setTimeout","Promise","resolve","login","logout","callback","dispose","Inject","args","RPMService","Injectable","providedIn","tslib_1.__param","LoginButtonComponent","_super","idpBaseUrl","IDP_BASE_URL","tslib_1.__extends","Component","selector","template","LoginModalComponent","showLoginModal","forceLogin","FORCE_LOGIN","cancel","ListSelectDialog","dialogRef","data","currentPage","totalSuggested","subject","query","clone","page","pipe","debounceTime","distinctUntilChanged","term","filterValues","onNoClick","close","onTermChange","immediate","termQuery","suggested","q","isLoading","service","search","response","hits","results","totalResults","catch","finally","addValue","isSelected","removeValue","selected","index","id","splice","find","s","onPageChange","pageNo","getSubHeading","subHeading","getLabelFrom","isArray","label","title","prefLabel","MatDialogRef","MAT_DIALOG_DATA","MessageDialog","type","className","getIconClass","tslib_1.__decorate","HostBinding","GeoPlatformIconDirective","el","themed","toLowerCase","replace","nativeElement","ElementRef","Input","Directive","HeaderComponent","appName","class","portalUrl","ASSETS","ItemTypes","DATASET","SERVICE","LAYER","MAP","GALLERY","COMMUNITY","APPLICATION","TOPIC","WEBSITE","ItemHelper","isAsset","getIcon","CONTACT","getLabel","ORGANIZATION","CONCEPT","CONCEPT_SCHEME","fn","fullName","pt","positionTitle","on","orgName","email","getTypeLabel","getTypeKey","determineIconType","getItemDetailsUrl","ResourceLinkComponent","external","showIcon","ualUrl","hasIcon","getType","EventTypes","CLOSE","OPEN","RESET","SELECT","SELECT_NONE","QUERY","ADDED","REMOVED","CHANGED","ERROR","SearchEvent","options","assign","getOptions","SelectedItemsComponent","onEvent","EventEmitter","ngOnChanges","changes","clear","event","emit","remove","Output","ImageFallbackDirective","fallback","onImgError","src","onImgLoad","host","(error)","(load)","[src]","ThumbnailComponent","sanitizer","getThumbnailUrl","thumbnail","url","getBackgroundImage","getFallbackBackgroundImage","mediaType","contentData","content","bypassSecurityTrustStyle","getFallbackUrl","isEmpty","hasURL","hasContentData","DomSanitizer","GeoPlatformError","code","_label","_code","_item","from","gpe","Error","GeoPlatformErrorService","updateSubject","BehaviorSubject","error$","asObservable","setError","Visibilities","PUBLIC","PRIVATE","Statuses","SUBMITTED","createItem","opts","uri","description","resourceTypes","lastModifiedBy","createAsset","keywords","alternateTitles","purpose","themes","contacts","publishers","contributors","distributions","classifiers","landingPage","status","visibility","identifiers","extent","minx","miny","maxx","maxy","temporal","startDate","endDate","statistics","numViews","numLikes","usedBy","related","rights","defaultArrayValue","property","undefined","defaultToNullValue","trackingServiceInst","ItemFactory","layers","baseLayer","annotations","width","height","services","subLayers","parentLayer","layerName","layerType","legend","datasets","serviceType","href","items","scheme","subOrgOf","tel","fax","address","street1","street2","city","state","zip","fix","ArrayedItemsPipe","transform","num","max","isNaN","slice","Pipe","LimitToPipe","start","st","SortByPipe","sort","FriendlyTypePipe","idx","substring","FixLabelPipe","result","trim","charAt","toUpperCase","ItemResolver","trackingService","route","paramMap","get","version","event_1","TrackingEventFactory","TrackingTypes","VIEWED","logEvent","of","ItemService","TrackingService","VersionResolver","NewItemResolver","router","params","navigateByUrl","skipLocationChange","empty","Router","ErrorResolver","INVALID_SUBJECT_ERROR","AbstractSearchService","_selected","createSubject","subject$","getError","_error","setQuery","andSearch","_query","getQuery","getResults","_results","setResults","select","it","_toggleItem","fireEvent","position","findIndex","compareItems","sortItems","hasSelected","getSelected","setSelected","sel","clearSelected","listener","onQueryChange","onResultsChange","onSelectedChange","GeoPlatformSearchService","getService","fullItem","GeoPlatformResultsItemAdapter","getId","getDescription","getAuthorName","getEditorName","getCreatedDate","created","getModifiedDate","modified","resTypes","SearchResultsItemComponent","canSelect","showDesc","hasPrimaryAction","adapter","constrainToUser","change","QueryParameters","CREATED_BY","DEFAULT_SORT_OPTIONS","SearchResultsComponent","dialog","sortOptions","sortValue","subscription","selectAllInPage","deselectAll","onItemEvent","$event","applyParameters","onPagingEvent","previous","getPage","current","pageIndex","setPageSize","pageSize","event_2","onSortChange","event_3","MatDialog","ItemFilterComponent","types","filterLabel","isCollapsed","initQuery","choices","openDialog","getDialogOptions","open","afterClosed","getKey","PAGE","notify","isSupported","Query","fields","facets","hasSelections","toggle","CommunityFilterComponent","USED_BY_ID","CreatedByFilterComponent","typeaheadValue","pagination","size","values","pagedValues","visibleAmount","fetchValues","outsideSelection","getIndexOf","QueryFacets","parameter","facet","buckets","bucket","count","updatePagedValues","nextPage","numPages","Math","ceil","min","prevPage","resetStart","filter","end","checkForOutsideSelections","getSelection","clearTypeAhead","toggleCurrentUser","getCurrentUserName","KeywordFilterComponent","placeholder","onKeyUp","text","onValueChange","searchString","PublisherFilterComponent","PUBLISHERS_ID","SchemeFilterComponent","SCHEMES_ID","getTypes","SemanticFilterDialog","kgQuery","KGQuery","suggest","SemanticFilterComponent","KGService","ServiceTypeFilterComponent","SERVICE_TYPES","resourceType","getCount","SimilarityFilterComponent","SIMILAR_TO","currentValue","ThemeFilterComponent","THEMES_ID","TopicFilterComponent","TOPIC_ID","TypeFilterComponent","TYPES","keys","STANDARD","RIGHTS_STATEMENT","ItemTypeLabels","valObj","BEFORE","AFTER","ModifiedFilterComponent","MODIFIED","format","debouncePromise","lastModifiedOptions","lastModifiedDir","onDateChanged","getTime","MODIFIED_BEFORE","MODIFIED_AFTER","onDirChange","ViewChild","MatDatepicker","static","TrackingServiceFactory","provider","RPMServiceFactory","ɵ1","GeoPlatformCommonModule","NgModule","imports","RouterModule","CommonModule","FormsModule","MatButtonModule","MatIconModule","MatInputModule","MatSelectModule","MatDialogModule","MatProgressBarModule","MatTabsModule","MatPaginatorModule","MatDatepickerModule","MatNativeDateModule","NativeDateModule","NgbModule","exports","declarations","providers","provide","useValue","ɵ0","useFactory","deps","entryComponents","AGOL","WMS","MapBox"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","\nimport { Config } from '@geoplatform/client';\n\nconst LEVELS = [\n    \"error\",\n    \"warn\",\n    \"info\",\n    \"debug\"\n];\n\nclass Logger {\n\n    private level : string = 'error';\n\n    constructor() {\n        this.setLevel(Config.logLevel || Config.LOG_LEVEL);\n    }\n\n    setLevel(level : string) {\n        if( level && LEVELS.indexOf(level) >= 0 ) {\n            this.level = level;\n        }\n        this.info(\"Log Level : \" + this.level);\n    }\n\n    isVisible(level : string) : boolean {\n        return LEVELS.indexOf(this.level) >= LEVELS.indexOf(level);\n    }\n\n    log(arg, ...addl) {\n        let msg = this.toStr(arg);\n        msg += addl.map( a => this.toStr(a) ).join('');\n        console.log(msg);\n    }\n\n    debug(arg, ...addl) {\n        if(!this.isVisible('debug')) return;\n        let msg = \"[DEBUG] \" + this.toStr(arg);\n        this.log(msg, ...addl);\n    }\n\n    info(arg, ...addl) {\n        if(!this.isVisible('info')) return;\n        let msg = \"[INFO] \" + this.toStr(arg);\n        this.log(msg, ...addl);\n    }\n\n    warn(arg, ...addl) {\n        if(!this.isVisible('warn')) return;\n        let msg = \"[WARN] \" + this.toStr(arg);\n        this.log(msg, ...addl);\n    }\n\n    error(arg, ...addl) {\n        let msg = \"[ERROR] \" + this.toStr(arg);\n        this.log(msg, ...addl);\n    }\n\n    toStr(arg) {\n        if(null === arg || typeof(arg) === 'undefined') return '';\n        if(typeof(arg) ===  'string') return arg;\n        return JSON.stringify(arg);\n    }\n}\n\nconst logger = new Logger();\n\nexport {\n    logger as default,\n    logger\n};\n","import { Observable, Observer, Subject, Subscription } from 'rxjs';\nimport { AuthService, GeoPlatformUser } from '@geoplatform/oauth-ng/angular';\n\nimport { AppAuthService } from './auth.service';\nimport { logger } from '../logger';\n\nconst EDIT_ROLE = 'gp_editor';\n\n\n/**\n * Base class that can be used to hook authentication notifications into\n * Angular @Component instances.\n */\nexport abstract class AuthenticatedComponent {\n\n    public user : GeoPlatformUser;\n    private gpAuthSubscription : Subscription;\n\n    constructor(protected authService : AppAuthService) {\n    }\n\n    //facade methods to mimic @Component lifecycle methods in case sub-classes\n    // want to use consistent names\n    ngOnInit() { this.init(); }\n    ngOnDestroy() { this.destroy(); }\n\n    /**\n     * Sub-classes must invoke this method in order to register listeners\n     * for authentication events\n     */\n    init() {\n\n        let obs : Observer<GeoPlatformUser> = {\n            next : (value: GeoPlatformUser) => {\n                logger.debug(\"AuthenticatedComponent : User changed to \" + (value ? value.username : 'null'));\n                this.user = value;\n                this.onUserChange(this.user);\n            },\n            error : (err: any) => {\n                logger.error(\"Unable to get authenticated user info: \" +\n                    (err as Error).message);\n            },\n            complete : () => { }\n        };\n\n        this.gpAuthSubscription = this.authService.subscribe( obs );\n\n        //for components that initialize AFTER a user has changed auth state,\n        // we need to fetch the current user details\n        this.user = this.authService.getUser();\n        this.onUserChange(this.user);\n    }\n\n    /**\n     * Sub-classes must invoke this method in order to de-register listeners\n     * for authentication events and clean up internals\n     */\n    destroy() {\n        if(this.gpAuthSubscription) {\n            this.gpAuthSubscription.unsubscribe();\n            this.gpAuthSubscription = null;\n        }\n        this.user = null;\n        this.authService = null;\n    }\n\n    /** @return {boolean} */\n    public isAuthenticated() : boolean { return !!this.user; }\n\n    /** @return {GeoPlatformUser} */\n    public getUser() : GeoPlatformUser { return this.user; }\n\n    /** @return {string} JWT token associated with the current user or null */\n    public getAuthToken() : string { return this.authService.getToken(); }\n\n    /** @return Promise containing current user or null */\n    public checkAuth() : Promise<GeoPlatformUser> { return this.authService.check(); }\n\n    /**\n     * @param item - optional object the user may be able to edit\n     * @return boolean indicating whether user can edit the requested item or is an editor if no item was specified\n     */\n    public canUserEdit(item ?: any) : boolean {\n        if(!this.user) return false;\n        if(this.user.isAuthorized(EDIT_ROLE)) return true;\n        return this.isAuthorOf(item);\n    }\n\n    /**\n     * @param item - object the user may be the owner of\n     * @return boolean indicating if the user is the associated creator/owner of the item\n     */\n    public isAuthorOf(item ?: any) : boolean {\n        if(!this.user || !item) return false;\n        return item.createdBy && item.createdBy === this.user.username;\n    }\n\n    /**\n     * @param {GeoPlatformUser} user - authenticated user object or null if not authed\n     */\n    protected onUserChange(user : GeoPlatformUser) { /* implement in sub-classes */ }\n\n\n}\n","import { ngGpoauthFactory, AuthService } from '@geoplatform/oauth-ng/angular';\n\nimport { logger } from \"../logger\";\n\n\n//should be exported by gp-ngoauth but isn't so we are declaring it here...\ninterface AuthConfig {\n    AUTH_TYPE?: 'grant' | 'token'\n    IDP_BASE_URL?: string\n    APP_BASE_URL?: string\n    ALLOW_SSO_LOGIN?: boolean\n    APP_ID?: boolean\n    ALLOW_IFRAME_LOGIN?: boolean\n    FORCE_LOGIN?: boolean\n    CALLBACK?: string\n    LOGIN_URL?: string\n    LOGOUT_URL?: string\n    ALLOW_DEV_EDITS?: boolean\n};\nconst AUTH_KEYS = [\n    'AUTH_TYPE', 'IDP_BASE_URL', 'APP_BASE_URL', 'ALLOW_SSO_LOGIN',\n    'APP_ID', 'ALLOW_IFRAME_LOGIN', 'FORCE_LOGIN', 'CALLBACK',\n    'LOGIN_URL', 'LOGOUT_URL', 'ALLOW_DEV_EDITS'\n];\n\n\n\n\nvar authService : AuthService = null;\n\n\nexport function authServiceFactory( environment : any ) {\n\n    //once service has been built, keep using it\n    if(authService) return authService;\n\n    //\n    //but the first time it's requested, it has to be built using env settings\n    let authSettings : AuthConfig = {};\n\n    let gpGlobal = (<any>window).GeoPlatform;\n    if(gpGlobal && gpGlobal.config && gpGlobal.config.auth) {\n        //auth library settings made available through WP via 'GeoPlatform' global\n        //https://geoplatform.atlassian.net/browse/DT-2307\n        authSettings = gpGlobal.config.auth;\n    } else {\n        authSettings.APP_BASE_URL = environment.wpUrl || '';\n        AUTH_KEYS.forEach( key => {\n            let v = environment[key];\n            if(typeof(v) !== 'undefined') {\n                if(~key.indexOf('ALLOW') || ~key.indexOf('FORCE')) {\n                    v = (v === true || v === 'true');\n                }\n                authSettings[key] = v;\n            }\n        });\n    }\n\n    logger.info(\"Configuring OAuth using: \");\n    logger.info(authSettings);\n\n    authService = ngGpoauthFactory(authSettings);\n    return authService;\n};\n","import { Inject, Injectable } from '@angular/core';\nimport { Observable, Observer, Subject, Subscription } from 'rxjs';\nimport { Config } from '@geoplatform/client';\nimport { RPMService } from '@geoplatform/rpm/src/iRPMService'\n\nimport {\n    ngGpoauthFactory, AuthService, GeoPlatformUser\n} from '@geoplatform/oauth-ng/angular';\n\nimport { authServiceFactory } from './auth.factory';\nimport { logger } from \"../logger\";\n\n\n\n@Injectable({providedIn: 'root'})\nexport class AppAuthService {\n\n    private user : GeoPlatformUser;\n    private user$ : Subject<GeoPlatformUser>;\n    private observers : { [key:string]: Observer<GeoPlatformUser> } =\n        {} as { [key:string]: Observer<GeoPlatformUser> };\n    private gpAuthSubscription : Subscription;\n    private authService : AuthService;\n    private rpm: RPMService;\n\n\n\n    constructor( @Inject(RPMService) rpm : RPMService ) {\n        this.authService = authServiceFactory(Config);\n        this.rpm = rpm;\n        this.init();\n    }\n\n\n    init() {\n\n        this.user$ = new Subject<GeoPlatformUser>();\n\n        if(!this.authService) return;\n\n        const sub = this.authService.getMessenger().raw();\n        this.gpAuthSubscription = sub.subscribe(msg => {\n            logger.debug(\"Received Auth Message: \" + msg.name);\n            switch(msg.name){\n                case 'userAuthenticated': this.onUserChange(msg.user); break;\n                case 'userSignOut': this.onUserChange(null); break;\n            }\n        });\n\n        this.authService.getUser().then( user => { this.onUserChange(user); });\n\n    }\n\n    onUserChange(user : GeoPlatformUser) {\n        logger.debug(\"AuthService.onUserChange() : User is \" + (user ? user.username : 'N/A'));\n        this.user = user;\n        // this.rpm.setUserId( user ? user.id : null);\n        this.user$.next(user);\n    }\n\n    /**\n     *\n     */\n    getMessenger() : Subject<any>{\n        return this.authService ? this.authService.getMessenger().raw() : null;\n    }\n\n\n    isAuthenticated() : boolean {\n        return !!this.user;\n    }\n\n    getUser() : GeoPlatformUser {\n        return this.user;\n    }\n\n    getToken() : string {\n        return this.authService ? this.authService.getJWT() : null;\n    }\n\n    /**\n     * Check the underlying authentication mechanism endpoint to validate the\n     * current JWT token (if one exists) is not expired or revoked.\n     * @return GeoPlatformUser or null\n     */\n    check() : Promise<GeoPlatformUser> {\n        if(!this.authService) return Promise.resolve(null);\n        return this.authService.checkWithClient()\n        .then( token => this.authService.getUser() )\n        .then( user => {\n            setTimeout( () => { this.onUserChange(user); },100 );\n            return user;\n        });\n    }\n\n    login() {\n        this.authService.login();\n    }\n\n    logout() {\n        this.authService.logout();\n    }\n\n    /**\n     *\n     */\n    subscribe( callback : Observer<GeoPlatformUser> ) : Subscription {\n        return this.user$.subscribe( callback );\n    }\n\n\n    dispose() {\n        if(this.gpAuthSubscription) {\n            this.gpAuthSubscription.unsubscribe();\n            this.gpAuthSubscription = null;\n        }\n        this.user = null;\n        this.user$ = null;\n        this.observers = null;\n        this.authService = null;\n    }\n}\n","\nimport { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Config } from '@geoplatform/client';\nimport { AuthService, GeoPlatformUser } from '@geoplatform/oauth-ng/angular';\n\nimport { AuthenticatedComponent } from './authenticated.component';\nimport { AppAuthService } from './auth.service';\nimport { logger } from '../logger';\n\n\n@Component({\n    selector: 'gp-login-button',\n    styles: [\n        `\n        .btn-login.btn-link {\n            padding: .375em .75em;\n            border-right: none;\n            margin: 0 0.5em;\n            font-weight: 700;\n        }\n        .btn-login.btn-link:hover {\n            background-color: #fff;\n            text-decoration: none;\n            color: #333;\n        }\n        .o-account-details {\n            display: flex;\n            justify-content: space-between;\n            align-items: stretch;\n            margin-top: -0.5em;\n            padding: 1em;\n            background: #185b8a;\n            color: #fff;\n        }\n        .o-account-details__avatar {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            font-size: 6em;\n            margin-right: 0.25em;\n            padding-top: 10px;\n            width: 100px;\n            height: 100px;\n            overflow: hidden;\n            background: #fff;\n            color: #777;\n            border-radius: 100%;\n        }\n        .dropdown-menu .btn.btn-link {\n            display: inline-block;\n            padding: 0.375rem 0.75rem;\n            border-right: none;\n        }\n        .dropdown-menu .btn.btn-link:after {\n            content: '';\n        }\n        .btn.btn-logout {\n            padding: 0.375rem 0.75rem;\n            margin-bottom: -0.5em;\n        }\n        `\n    ],\n    template:\n    `\n    <div class=\"btn-account btn-group\">\n        <!-- not logged in yet -->\n        <a class=\"btn-login btn btn-link\" (click)=\"login()\" *ngIf=\"!user\">Sign In</a>\n\n        <!-- logged in -->\n        <button type=\"button\" class=\"btn-login btn btn-link dropdown-toggle\" data-toggle=\"dropdown\"\n            aria-expanded=\"false\" *ngIf=\"user\">\n            <span class=\"fas fa-user\"></span>\n            <span class=\"d-xs-none\">{{user?.name}}</span>\n            <span class=\"caret\"></span>\n        </button>\n        <div class=\"dropdown-menu dropdown-menu-right\" role=\"menu\" *ngIf=\"user\">\n            <div class=\"o-account-details\">\n                <div class=\"o-account-details__avatar\">\n                    <span class=\"fas fa-user\"></span>\n                </div>\n                <div class=\"flex-1\">\n                    <div class=\"a-heading\">\n                        {{user?.name}}\n                        <small><em>({{user?.username}})</em></small>\n                    </div>\n                    <div class=\"u-text--sm\">{{user?.email}}</div>\n                    <div class=\"u-text--sm\">{{user?.org}}</div>\n                </div>\n            </div>\n            <div class=\"d-flex flex-justify-around u-mg-top--sm\">\n                <a class=\"btn btn-sm btn-link\" target=\"_blank\" href=\"{{idpBaseUrl}}/profile\">\n                    <span class=\"fas fa-pencil-alt\"></span> Edit Profile\n                </a>\n                <a class=\"btn btn-sm btn-link\" target=\"_blank\" href=\"{{idpBaseUrl}}/updatepw\">\n                    <span class=\"fas fa-key\"></span> Change Password\n                </a>\n            </div>\n            <div class=\"u-mg-top--sm\">\n                <a class=\"btn-logout btn btn-light btn-block\" (click)=\"logout()\">\n                    <span class=\"fas fa-power-off\"></span> Sign Out\n                </a>\n            </div>\n        </div>\n    </div>\n    `\n\n})\nexport class LoginButtonComponent extends AuthenticatedComponent implements OnInit {\n\n    public idpBaseUrl : string = Config.IDP_BASE_URL || 'https://accounts.geoplatform.gov';\n    public user : GeoPlatformUser =  null;\n\n    constructor( authService : AppAuthService ) {\n        super(authService);\n    }\n\n    ngOnInit() {\n        super.ngOnInit();\n\n        // this.authService.check();\n    }\n\n    ngOnDestroy() {\n        super.ngOnDestroy();\n    }\n\n    onUserChange(user : GeoPlatformUser) {\n        super.onUserChange(user);\n        logger.debug(\"LoginButton.onUserChange() : User is \" + (user ? user.username : 'null'));\n        this.user = user;\n    }\n\n    login() {\n        this.authService.login();\n    }\n\n    logout() {\n        this.authService.logout();\n    }\n\n}\n\n\n\n\n\n\n\n\n\n@Component({\n    selector: 'gp-login-modal',\n    styles: [\n    `\n        .gpLoginCover {\n            position: absolute;\n            top: 0;\n            left: 0;\n            bottom: 0;\n            right: 0;\n            background: rgba(0,0,0,0.6);\n            z-index: 5000;\n            width: 100vw;\n            height: 100vh;\n        }\n\n        .gpLoginCancelIframe {\n          z-index: 5001;\n          position: absolute;\n          right: 0px;\n        }\n\n        .gpLoginWindow {\n          top: 100px;\n          height: 60%;\n          width: 75%;\n          margin: 0 auto;\n          position: relative;\n          z-index: 5001;\n        \tborder: 5px solid #cccccc;\n          border-radius: 10px;\n        }\n\n        .gpLoginWindow iframe {\n          width: 100%;\n          height: 100%\n        }\n\n        .gpLoginWindow .btn-cancel {\n          color: white;\n          background-color: red;\n        }\n\n        .gpLoginWindow .btn {\n          display: inline-block;\n          padding: 6px 12px;\n          margin-bottom: 0;\n          font-size: 14px;\n          font-weight: 400;\n          line-height: 1.42857143;\n          text-align: center;\n          white-space: nowrap;\n          vertical-align: middle;\n          -ms-touch-action: manipulation;\n          touch-action: manipulation;\n          cursor: pointer;\n          -webkit-user-select: none;\n          -moz-user-select: none;\n          -ms-user-select: none;\n          user-select: none;\n          background-image: none;\n          border: 1px solid transparent;\n          border-radius: 4px;\n        }\n    `\n    ],\n    templateUrl: './login.html',\n\n})\nexport class LoginModalComponent implements OnInit, OnDestroy {\n\n    public showLoginModal : boolean = false;\n    public forceLogin : boolean = Config.FORCE_LOGIN;\n\n    constructor(private authService : AppAuthService) {\n\n    }\n\n    ngOnInit() {\n        if(!this.authService) return;\n\n        this.authService.getMessenger().subscribe(msg => {\n            logger.debug(\"LoginModal received auth message: \" + msg.name);\n            switch(msg.name){\n                case 'auth:requireLogin':\n                    this.showLoginModal = true;   //show the modal\n                    break;\n\n                case 'userAuthenticated':\n                case 'iframe:userAuthenticated':\n                    this.showLoginModal = false;  //hide the modal\n                    this.authService.onUserChange(msg.user);\n                    break;\n            }\n        });\n    }\n\n    ngOnDestroy() {\n        this.showLoginModal = false;\n    }\n\n    cancel() {\n        //hide the modal\n        this.showLoginModal = false;\n    }\n\n}\n","import { Inject, Component } from '@angular/core';\nimport { MatDialog, MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { Subject } from 'rxjs';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { Item, ItemService, Query, SearchResults } from \"@geoplatform/client\";\n\n\n\n\nexport interface ListSelectDialogData {\n    selected    : Item[];       //array of pre-selected values\n    service     : ItemService;  //service to query for new values\n    query       : Query;        //query defining how to search for new values\n    subHeading ?: string;       //optional data to display under title\n}\n\n\n\n\n@Component({\n  selector: 'gp-list-select-dialog',\n  templateUrl: 'list-select.html',\n  styleUrls: ['./list-select.less']\n})\nexport class ListSelectDialog {\n\n    public  suggested : any[];\n    public  termQuery : string;\n    public  isLoading : boolean;\n\n    //pagination\n    public  currentPage    : number = 0;\n    public  totalSuggested : number = 0;\n\n    private query     : Query;\n    private subject   : Subject<string> = new Subject<string>();\n\n\n    constructor (\n        public dialogRef: MatDialogRef<ListSelectDialog>,\n        @Inject(MAT_DIALOG_DATA) public data: ListSelectDialogData\n    ) {\n        this.query = data.query.clone().page(this.currentPage);\n\n        this.subject.pipe(\n            debounceTime(300),\n            distinctUntilChanged()\n        )\n        .subscribe( term => {\n            this.filterValues(term);\n        });\n    }\n\n    onNoClick () : void {\n        this.dialogRef.close();\n    }\n\n    onTermChange( term : string, immediate ?: boolean) {\n        if(true === immediate) {        //if needing to update without debounce\n            this.filterValues(term);\n        } else {                        //otherwise, debounce change\n            this.subject.next(term);\n        }\n    }\n\n    /**\n     * @param {string} value - user input to filter options with\n     * @return {Promise} resolving array of string options\n     */\n    filterValues ( value: string ) : void {\n\n        this.termQuery = value;\n\n        if(!value) {    //require user to provide input before searching\n            this.suggested = [];\n            this.totalSuggested = 0;\n            return;\n        }\n\n        this.query.q(value);\n\n        this.isLoading = true;\n\n        this.data.service.search(this.query)\n        .then( ( response : SearchResults ) => {\n            let hits = response.results;\n            this.suggested = hits;\n            this.totalSuggested = response.totalResults;\n        })\n        .catch(e => {\n            //display error message indicating an issue searching...\n        }).finally( () => {\n            this.isLoading = false;\n        });\n    }\n\n    addValue ( arg : Item) : void {\n        if(this.isSelected(arg)) {  //if already selected, remove it\n            this.removeValue(arg);  //...\n            return;                 //...\n        }\n        this.data.selected.push( arg );\n    }\n\n    removeValue ( value: Item ) : void {\n        let index = -1;\n        this.data.selected.forEach( (p,i) => { if(p.id === value.id) { index = i; } });\n        if (index >= 0) {\n            this.data.selected.splice(index, 1);\n        }\n    }\n\n    isSelected ( arg : Item ) : boolean {\n        return this.data.selected.length > 0 &&\n            !!this.data.selected.find( (s) => s.id === arg.id);\n    }\n\n\n    /**\n     * @param pageNo - new page number being requested\n     */\n    onPageChange( pageNo : number ) {\n        if(this.currentPage !== pageNo-1 ) {\n            this.query.page( pageNo-1 );\n            this.filterValues( this.termQuery );\n        }\n    }\n\n    getSubHeading(item : Item) : string {\n        let property = this.data.subHeading;\n        let value = item[property];\n        return this.getLabelFrom(value);\n    }\n\n    getLabelFrom( value : any ) : string {\n        if(value === null || typeof(value) === 'undefined') return '';\n        if(Array.isArray(value)) {\n            return (value as []).map( v => this.getLabelFrom(v) ).join(', ');\n        }\n        if(typeof(value) === 'object' && (value.label || value.title || value.prefLabel)) {\n            return value.label || value.title || value.prefLabel;\n        }\n        return '';\n    }\n}\n","import { Inject, Component, HostBinding } from '@angular/core';\nimport { MatDialog, MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { Subject } from 'rxjs';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\n\n\n\n\nexport interface MessageDialogData {\n    type     : 'error' | 'warn' | 'info';\n    label   ?: string;\n    message  : string;\n}\n\n\n\n\n@Component({\n  selector: 'gp-message-dialog',\n  templateUrl: 'message.html',\n  styleUrls: ['./message.less'],\n\n})\nexport class MessageDialog {\n\n    @HostBinding('class') className;\n\n    constructor (\n        public dialogRef: MatDialogRef<MessageDialog>,\n        @Inject(MAT_DIALOG_DATA) public data: MessageDialogData\n    ) {\n\n        switch(data.type) {\n            case 'error' : this.className = 'danger'; break;\n            case 'warn' : this.className = 'warning'; break;\n            case 'info' : this.className = 'info'; break;\n        }\n\n    }\n\n    close () : void {\n        this.dialogRef.close();\n    }\n\n    getIconClass() : string {\n        switch(this.data.type) {\n            case 'error' : return \"fas fa-exclamation-circle\";\n            case 'warn'  : return \"fas fa-exclamation-triangle\";\n            case 'info'  : return 'fas fa-info-circle'\n        }\n        return '';\n    }\n\n}\n","import { Directive, ElementRef, Input, OnInit } from '@angular/core';\nimport { Item } from \"@geoplatform/client\";\n\n\n@Directive({\n  selector: '[gpIcon]'\n})\nexport class GeoPlatformIconDirective {\n\n    @Input() item : Item;\n    @Input() themed : boolean = true;\n\n    constructor(private el: ElementRef) {\n\n    }\n\n    ngOnInit() {\n        if(!this.item) return;\n        let className = this.item.type.toLowerCase().replace(/^[a-z]+\\:/,'');\n        className = 'icon-' + className;\n        if(this.themed) {\n            className += \" is-themed\";\n        }\n        this.el.nativeElement.className = className;\n    }\n}\n","import { Component, Input, HostBinding } from '@angular/core';\nimport { Config } from '@geoplatform/client';\n\n@Component({\n    selector: 'gp-app-header',\n    templateUrl: './header.component.html',\n    styleUrls: ['./header.component.less']\n})\nexport class HeaderComponent {\n\n    @Input() appName : string = \"Application\";\n    @HostBinding('class') class = 'o-header'\n\n    public portalUrl : string = Config.portalUrl || 'https://www.geoplatform.gov';\n\n\n}\n","import { Injectable } from '@angular/core';\nimport { Config, ItemTypes } from \"@geoplatform/client\";\n\nconst ASSETS = [\n    ItemTypes.DATASET, ItemTypes.SERVICE,   ItemTypes.LAYER,       ItemTypes.MAP,\n    ItemTypes.GALLERY, ItemTypes.COMMUNITY, ItemTypes.APPLICATION, ItemTypes.TOPIC,\n    ItemTypes.WEBSITE\n];\n\n@Injectable()\nexport class ItemHelper {\n\n    constructor() { }\n\n    /**\n     * @param {any} item - either GP item or string type\n     * @return {boolean}\n     */\n    static isAsset(item : any) {\n        if(!item) return false;\n        let type = null;\n        if(typeof(item) === 'string')  type = item as string;\n        else if(item.type) type = item.type;\n        return type && ASSETS.indexOf(type) >= 0;\n    }\n\n    /**\n     * @param {any} item - either GP item or string type\n     * @return {string} url of icon for the type\n     */\n    static getIcon(item : any) :string {\n        let type = \"dataset\";\n        switch(item.type) {\n            case ItemTypes.CONTACT:         type =  'vcard'; break;\n            default: type = item.type.replace(/^[a-z]+\\:/i, '').toLowerCase();\n        }\n        return 'icon-' + type;\n    }\n\n    /**\n     * @param {any} item - either GP item\n     * @return {string} label for the item\n     */\n    static getLabel(item : any) {\n        if(!item || !item.type) return 'Unknown type';\n\n        let type = item.type;\n        switch(type) {\n\n            case ItemTypes.ORGANIZATION :\n            // case ItemTypes.PERSON :\n                return item.label || item.name || \"Un-titled resource\";\n\n            case ItemTypes.CONCEPT :\n            case ItemTypes.CONCEPT_SCHEME :\n                return item.label || item.prefLabel || \"Un-titled resource\";\n\n            case ItemTypes.CONTACT :\n                let fn = item.fullName || '';\n                let pt = item.positionTitle || '';\n                let on = item.orgName || '';\n                let label = fn + (fn.length?' - ':'') + pt + (pt.length?' - ':'') + on;\n                //if none of those fields have been provided, default to email or placeholder\n                if(!label.length) label = item.email || 'Untitled Contact';\n                return label;\n\n            default: return item.label || item.title || \"Un-titled resource\";\n        }\n    }\n\n    /**\n     * @param {any} item - either GP item or string type\n     * @return {string} label for the item's type\n     */\n    static getTypeLabel(item:any) {\n        if(!item) return 'Unknown Resource Type';\n\n        let type : string = null;\n        if(typeof(item) === 'string') type = item as string;\n        else if(item.type) type = item.type;\n        else return null;\n\n        switch(type) {\n            case ItemTypes.DATASET :\n            case ItemTypes.SERVICE :\n            // case ItemTypes.PERSON :\n            case ItemTypes.ORGANIZATION :\n            case ItemTypes.CONCEPT :\n                return type.replace(/^[a-z]+\\:/i, '');\n            case ItemTypes.CONCEPT_SCHEME : return \"Concept Scheme\";\n            case ItemTypes.WEBSITE : return \"Website\";\n            case ItemTypes.CONTACT : return \"Contact\";\n            default: return type;   //remainder are unprefixed\n        }\n    }\n\n\n    /**\n     * @param {any} item - either GP item or string type\n     * @return {string} key (plural) for the item's type\n     */\n    static getTypeKey(item:any) {\n        if(!item) return null;\n\n        let type : string = null;\n        if(typeof(item) === 'string') type = item as string;\n        else if(item.type) type = item.type;\n        else return null;\n\n        switch(type) {\n            //special plurality\n            case ItemTypes.GALLERY : return 'galleries';\n            case ItemTypes.COMMUNITY : return 'communities';\n            //different name\n            case ItemTypes.CONTACT : return 'contacts'; //instead of \"vcards\"\n            //remainder\n            default: return type.replace(/^[a-z]+\\:/i, '').toLowerCase() + 's';\n\n        }\n    }\n\n\n    /**\n     * @param {string} type - item type\n     * @return {string} string path to the type's icon\n     */\n    static determineIconType(type : string) {\n        let name = type.replace(/^[a-z]+\\:/i, '').toLowerCase();\n        return `/assets/icons/${name}.svg`;\n    }\n\n    static getItemDetailsUrl(item : any) {\n        if(!item || !item.type || !item.id) return null;\n\n        return Config.portalUrl + '/resources/' + this.getTypeKey(item) + '/' + item.id;\n    }\n\n}\n","import { Component, OnInit, Input } from '@angular/core';\nimport { Config, ItemTypes } from \"@geoplatform/client\";\n\nimport { ItemHelper } from '../../item-helper';\n\n@Component({\n  selector: 'gp-resource-link',\n  templateUrl: './link.component.html',\n  styleUrls: ['./link.component.less']\n})\nexport class ResourceLinkComponent implements OnInit {\n\n    @Input() item : any;\n    // @Input() icon : any;\n    @Input() external : boolean = false;    //open link in new window/tab\n    @Input() label : string;\n    @Input() showIcon : boolean = true;\n\n    public portalUrl : string;\n\n\n    constructor() { }\n\n    ngOnInit() {\n        if(Config.portalUrl) this.portalUrl= Config.portalUrl;\n        else {\n            this.portalUrl = Config.ualUrl.replace(\"sit-ual\",'sit')\n                .replace(\"stg-ual\",\"stg\").replace(\"ual\",\"www\");\n        }\n    }\n\n    hasIcon() : boolean {\n        return this.showIcon;\n    }\n\n    getIcon() : string {\n        return ItemHelper.getIcon(this.item);\n    }\n\n    getLabel() : string {\n        return this.label || ItemHelper.getLabel(this.item);\n    }\n\n    getType() : string {\n        return ItemHelper.getTypeKey(this.item);\n    }\n\n    getIconClass() : string {\n        let type = ItemHelper.getTypeLabel(this.item);\n        if(\"Contact\" === type) type = 'vcard';\n        if(\"Product\" === type) type = 'imageproduct';\n        return 'icon-' + type.toLowerCase();\n    }\n\n}\n","\n/**\n *\n */\nexport const EventTypes = {\n    CLOSE       : Symbol( \"Close\"      ),   //\n    OPEN        : Symbol( \"Open\"       ),   //\n    RESET       : Symbol( \"Reset\"      ),   // clearing query filters\n    SELECT      : Symbol( \"Select\"     ),   // selecting item(s)\n    SELECT_NONE : Symbol( \"SelectNone\" ),   // clearing selections\n    QUERY       : Symbol( \"Query\"      ),   // change to query\n    ADDED       : Symbol( \"Added\"      ),   //\n    REMOVED     : Symbol( \"Removed\"    ),   //\n    CHANGED     : Symbol( \"Changed\"    ),   //\n    ERROR       : Symbol( \"Error\"      )    //\n};\n\n\n\n/**\n * Search Event\n *\n */\nexport class SearchEvent {\n\n    private type : Symbol;\n    private options : { [key:string] : any } = {} as { [key:string] : any };\n\n    constructor(type : Symbol,options ?: { [key:string] :any }) {\n        this.type = type;\n        if(options) {\n            Object.assign(this.options, options);\n        }\n    }\n    getType() : Symbol { return this.type; }\n    getOptions() : { [key:string] : any } { return this.options; }\n\n}\n","import {\n    Component, OnInit, OnChanges, TemplateRef,\n    Input, Output, EventEmitter, SimpleChanges\n} from '@angular/core';\nimport { Item } from \"@geoplatform/client\";\n\nimport { SearchEvent, EventTypes } from '../../event';\n\n@Component({\n  selector: 'gp-selected-items',\n  templateUrl: './selected.component.html',\n  styleUrls: ['./selected.component.less']\n})\nexport class SelectedItemsComponent implements OnInit {\n\n    @Input() public selected : Item[];\n    @Input() public itemTemplate: TemplateRef<any>;\n    @Output() onEvent : EventEmitter<any> = new EventEmitter<any>();\n\n    constructor() { }\n\n    ngOnInit() {\n    }\n\n    ngOnChanges( changes : SimpleChanges ) {\n\n    }\n\n    clear() {\n        let event = new SearchEvent(EventTypes.SELECT_NONE);\n        this.onEvent.emit(event);\n    }\n\n    remove( item : Item ) {\n        let event = new SearchEvent(EventTypes.SELECT, {value: item});\n        this.onEvent.emit(event);\n    }\n}\n","import {\n    Component, OnInit, Input, Directive, HostBinding\n} from '@angular/core';\nimport {\n    DomSanitizer, SafeResourceUrl, SafeUrl\n} from '@angular/platform-browser';\n\nimport { Config, ItemTypes, Item } from \"@geoplatform/client\";\n\n\n\n\n\ninterface Thumbnail {\n    url ?: string;\n    contentData ?: string;\n    width ?: number;\n    height ?: number;\n    mediaType ?: string;\n}\n\n\n\n@Directive({\n    selector: 'img[fallback]',\n    host: {\n        '(error)':'onImgError()',\n        '(load)': 'onImgLoad()',\n        '[src]':'src'\n     }\n})\nexport class ImageFallbackDirective {\n    @Input() src : string;\n    @Input() fallback : string = `/assets/img-404.png`;\n    @HostBinding('class') className\n    onImgError() { this.src = this.fallback; }\n    onImgLoad() { this.className = 'is-image-loaded'; }\n}\n\n\n\n@Component({\n  selector: 'gp-item-thumbnail',\n  templateUrl: './thumbnail.component.html',\n  styleUrls: ['./thumbnail.component.less']\n})\nexport class ThumbnailComponent implements OnInit {\n\n    @Input() item : Item;\n\n    constructor(private sanitizer: DomSanitizer) { }\n\n    ngOnInit() {\n    }\n\n    getThumbnailUrl() {\n        if(this.item.thumbnail && this.item.thumbnail.url)\n            return this.item.thumbnail.url;\n        return Config.ualUrl + '/api/items/' + this.item.id + '/thumbnail';\n    }\n\n    getBackgroundImage() {\n        if(!this.item || !this.item.thumbnail) {\n            return this.getFallbackBackgroundImage();\n        }\n\n        let thumbnail = this.item.thumbnail;\n        let type = thumbnail.mediaType || 'image/png';\n\n        if(thumbnail.contentData) {\n            let content = thumbnail.contentData;\n            return this.sanitizer.bypassSecurityTrustStyle(`url(data:${type};base64,${content})`);\n        }\n    }\n\n    getFallbackBackgroundImage() {\n        let url = this.getFallbackUrl();\n        return `url(${url})`;\n    }\n\n    isEmpty() {\n        return !this.item || !this.item.thumbnail ||\n            ( !this.item.thumbnail.url && !this.item.thumbnail.contentData );\n    }\n\n    hasURL() {\n        return this.item.thumbnail && !!this.item.thumbnail.url;\n    }\n\n    hasContentData() {\n        return this.item.thumbnail && !!this.item.thumbnail.contentData && !this.item.thumbnail.url;\n    }\n\n    getFallbackUrl() {\n        return Config.ualUrl + '/api/items/' + this.item.id + '/thumbnail';\n    }\n}\n","\nimport { Item } from \"@geoplatform/client\";\n\n/**\n *\n */\nexport class GeoPlatformError extends Error {\n\n    private _label: string;\n    private _code: number;\n    private _item : Item;\n\n    public get label() { return this._label; }\n    public set label(value: string) { this._label = value; }\n\n    public get code() { return this._code; }\n    public set code(value: number) { this._code = value; }\n\n    public get item() { return this._item; }\n    public set item(value : Item) { this._item = value; }\n\n\n    constructor(\n        message: string,\n        label ?: string,\n        code ?: number,\n        item ?: Item\n    ) {\n        super(message);\n        this.label = label;\n        this.code  = code;\n        this.item  = item;\n    }\n\n    static from(error : Error) : GeoPlatformError {\n        if(error instanceof GeoPlatformError)\n            return error as GeoPlatformError;\n\n        let gpe = new GeoPlatformError(error.message);\n        gpe.label = \"An error occurred\";\n        gpe.code = 500;\n        return gpe;\n    }\n\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, BehaviorSubject } from 'rxjs';\n\nimport { GeoPlatformError } from './error';\n\n@Injectable()\nexport class GeoPlatformErrorService {\n\n    private updateSubject: BehaviorSubject<GeoPlatformError> = new BehaviorSubject<GeoPlatformError>(null);\n\n    error$: Observable<GeoPlatformError> = this.updateSubject.asObservable();\n\n    setError(error: Error) {\n        let gpe = GeoPlatformError.from(error);\n        this.updateSubject.next(gpe);\n    }\n}\n","\n\nimport {\n    Item, Asset,\n    Map, Layer, Service, Dataset, Gallery, Community, Concept,\n    ConceptScheme, Organization, Contact,\n    ItemTypes\n} from '@geoplatform/client';\n\nimport { ItemHelper } from './item-helper';\n\n\nconst Visibilities : any = {\n    PUBLIC : 'public',\n    PRIVATE : 'private'\n};\n\nconst Statuses : any = {\n    SUBMITTED : 'submitted'\n};\n\n\n\nfunction createItem(type, opts ?: {[key:string]:any}) : any {\n    return Object.assign({\n        type:           type,\n        uri:            null,\n        label:          \"New Item\",\n        description:    \"This item needs a description\",\n        resourceTypes:  [],\n        createdBy:      null,\n        lastModifiedBy: null\n    }, opts||{});\n}\n\nfunction createAsset(type, opts ?: {[key:string]:any}) : any {\n    let options : {[key:string]:string} = Object.assign({\n        keywords        : [],\n        alternateTitles : [],\n        purpose         : null,\n        themes          : [],\n        contacts        : [],\n        publishers      : [],\n        contributors    : [],\n        distributions   : [],\n        classifiers     : {},\n        landingPage     : null,\n        status          : Statuses.SUBMITTED,\n        visibility      : Visibilities.PUBLIC,\n        identifiers     : [] as string[],\n        extent          : { minx: -179, miny: -89, maxx: 179, maxy: 89 },\n        temporal        : { startDate: null, endDate: null },\n        statistics      : { numViews: 0, numLikes: 0 },\n        usedBy          : [],\n        related         : [],\n        rights          : []\n    }, opts||{});\n    let item = createItem(type, options);\n    return item as Asset;\n}\n\n\n\nfunction createMap() : Map {\n    let obj = createAsset(ItemTypes.MAP, {\n        layers      : [],\n        baseLayer   : null,\n        annotations : {},\n        thumbnail   : {\n            label       : null,\n            url         : null,\n            contentData : null,\n            width       : 0,\n            height      : 0\n        }\n    });\n    return obj as Map;\n}\n\n\nfunction createLayer( service ?: Service ) : Map {\n    let services = service ? [service] : [];\n    let obj = createAsset(ItemTypes.LAYER, {\n        subLayers   : [],\n        parentLayer : null,\n        services    : services,\n        layerName   : null,\n        layerType   : null,\n        legend      : null\n    });\n    return obj as Map;\n}\n\nfunction createService() : Service {\n    let obj = createAsset(ItemTypes.SERVICE, {\n        datasets    : [],\n        serviceType : null,\n        href        : null\n    });\n    return obj as Service;\n}\n\nfunction createDataset() : Dataset {\n    let obj = createAsset(ItemTypes.DATASET, { services : [] });\n    return obj as Dataset;\n}\n\nfunction createGallery() : Gallery {\n    let obj = createAsset(ItemTypes.GALLERY, { items : [] });\n    return obj as Gallery;\n}\n\nfunction createCommunity() : Community {\n    let obj = createAsset(ItemTypes.COMMUNITY);\n    return obj as Community;\n}\n\nfunction createConcept() : Concept {\n    let obj = createItem(ItemTypes.CONCEPT, { scheme : null });\n    return obj as Concept;\n}\n\nfunction createConceptScheme() : ConceptScheme {\n    let obj = createItem(ItemTypes.CONCEPT_SCHEME);\n    return obj as ConceptScheme;\n}\n\n\nfunction createOrg() : Organization {\n    let obj = createItem(ItemTypes.ORGANIZATION, { subOrgOf : null });\n    return obj as Organization;\n}\n\nfunction createContact() : Contact {\n    let obj = createItem(ItemTypes.CONTACT, {\n        fullName : null,\n        email    : null,\n        tel      : null,\n        fax      : null,\n        address  : {\n            street1: null,\n            street2: null,\n            city:    null,\n            state:   null,\n            zip:     null\n        }\n    });\n    return obj as Contact;\n}\n\n\n\n\n\n\nfunction defaultArrayValue(item, property) {\n    if(!item || !property) return;\n    if( item[property] === null || item[property] === undefined ||\n        typeof(item[property]) === 'undefined' )\n        item[property] = [];\n}\n\nfunction defaultToNullValue(item, property) {\n    if(!item || !property) return;\n    if( typeof(item[property]) === 'undefined' )\n        item[property] = null;\n}\n\n\n\nexport class ItemFactory {\n\n    static create(type) {\n        switch(type) {\n            case ItemTypes.MAP : return createMap();\n            case ItemTypes.LAYER : return createLayer();\n            case ItemTypes.SERVICE : return createService();\n            case ItemTypes.DATASET : return createDataset();\n            case ItemTypes.GALLERY : return createGallery();\n            case ItemTypes.COMMUNITY: return createCommunity();\n            case ItemTypes.CONCEPT : return createConcept();\n            case ItemTypes.CONCEPT_SCHEME: return createConceptScheme();\n            case ItemTypes.ORGANIZATION: return createOrg();\n            case ItemTypes.CONTACT: return createContact();\n            default: return null;\n        }\n    }\n\n    static fix(item) {\n\n        defaultArrayValue(item, 'resourceTypes');\n\n        if(ItemHelper.isAsset(item)) {\n            defaultArrayValue(item, 'keywords');\n            defaultArrayValue(item, 'alternateTitles');\n            defaultArrayValue(item, 'themes');\n            defaultArrayValue(item, 'contacts');\n            defaultArrayValue(item, 'publishers');\n            defaultArrayValue(item, 'contributors');\n            defaultArrayValue(item, 'distributions');\n            defaultArrayValue(item, 'identifiers');\n            defaultArrayValue(item, 'usedBy');\n            defaultArrayValue(item, 'related');\n            defaultArrayValue(item, 'accessRights');\n\n            defaultToNullValue(item, 'purpose');\n            defaultToNullValue(item, 'landingPage');\n            defaultToNullValue(item, 'status');\n            defaultToNullValue(item, 'visibility');\n\n            if(!item.temporal) {\n                item.temporal = {startDate: null, endDate: null};\n            }\n            if(!item.extent) {\n                item.extent = { minx: -179, miny: -89, maxx: 179, maxy: 89 };\n            }\n        }\n    }\n\n}\n","\nimport { TrackingService } from '@geoplatform/client';\nimport { RPMService      } from '@geoplatform/rpm/src/iRPMService'\n\n\nlet trackingServiceInst : TrackingService;\n\nexport function TrackingServiceFactory ( rpm : RPMService ) {\n    if(!trackingServiceInst) {\n        trackingServiceInst = new TrackingService({ provider: rpm });\n    }\n    return trackingServiceInst;\n}\n","\nimport { NgModule, Pipe, PipeTransform } from '@angular/core';\nimport { Item } from \"@geoplatform/client\";\n\n\n\n@Pipe({name: 'arrayedItems'})\nexport class ArrayedItemsPipe implements PipeTransform {\n    transform(value: Item[], property:string, num?: number): string {\n        let max = isNaN(num) || num > value.length ? value.length : num;\n        return value.slice(0, max).map( v => v[property] ).join(' ');\n    }\n}\n\n\n/*\n * Limits an array of entries to a maximum number\n * Usage:\n *   array | limitTo:num\n * Example:\n *   {{ ['one','two','three'] | limitTo:2 }}\n */\n@Pipe({name: 'limitTo'})\nexport class LimitToPipe implements PipeTransform {\n    transform(value: any[], num: number, start ?: number): any[] {\n        if(value && value.length > num) {\n            let st = isNaN(start) ? 0 : start;\n            if(st > 0) num += st;\n            return value.slice( st, num);\n        }\n        return value;\n    }\n}\n\n\n\n/*\n *\n * Usage:\n *   array | sortBy : property\n * Example:\n *   {{ ['one','two','three'] | limitTo:2 }}\n */\n@Pipe({name: 'sortBy'})\nexport class SortByPipe implements PipeTransform {\n    transform(value: any[], property: string): any[] {\n        return value.sort( (a,b) => {\n            return a[property] > b[property] ? -1 : 1;\n        });\n    }\n}\n\n\n\n/*\n * Formats a GeoPlatform Item's type to a friendly label\n * Usage:\n *   type | friendlyType\n * Example:\n *   {{ \"dcat:Dataset\" | friendlyType }}\n *   formats to: \"Dataset\"\n*/\n@Pipe({name: 'friendlyType'})\nexport class FriendlyTypePipe implements PipeTransform {\n    transform(value: string): string {\n        if(!value || typeof(value) !== 'string' || value.length === 0) return value;\n        let name = value;\n        let idx = value.indexOf(\":\");\n        if(~idx) name = value.substring(idx+1);\n        if('VCard' === name) name = 'Contact';\n        return name;\n    }\n}\n\n\n\n\n\n/*\n * Replaces underscores between words with spaces\n * Usage:\n *   type | fixLabel\n * Example:\n *   {{ \"One_Two_Three\" | fixLabel }}\n *   formats to: \"One Two Three\"\n*/\n@Pipe({name: 'fixLabel'})\nexport class FixLabelPipe implements PipeTransform {\n    transform(value: string): string {\n        if(!value || typeof(value) !== 'string' || !value.length) return 'Untitled';\n        let result = value.replace(/([a-z])([A-Z])/g, \"$1 $2\").replace(/_/g, \" \").trim();\n        return result.charAt(0).toUpperCase() + result.slice(1);\n    }\n}\n","import { Injectable, Inject } from '@angular/core';\nimport {\n    Router, ActivatedRouteSnapshot, RouterStateSnapshot, Resolve\n} from '@angular/router';\nimport { Observable, of, empty } from 'rxjs';\nimport {\n    Item, ItemService,\n    TrackingService, TrackingTypes, TrackingEventFactory\n} from '@geoplatform/client';\nimport { ItemFactory }       from './item-factory';\nimport { GeoPlatformError }           from './error';\n\n@Injectable(/*{ providedIn: 'root' }*/)\nexport class ItemResolver implements Resolve<Item> {\n\n    constructor(\n        @Inject(ItemService) private service : ItemService,\n        @Inject(TrackingService) private trackingService : TrackingService\n    ) {\n    }\n\n    resolve(\n        route: ActivatedRouteSnapshot,\n        state: RouterStateSnapshot\n    ): Observable<any>|Promise<any>|any {\n\n        let id = route.paramMap.get('id');\n        let opts : any = {};\n        let version = route.paramMap.get(\"version\");\n        if(version) opts.version = version;\n        return this.service.get(id, opts)\n        .then( item => {\n            if(this.trackingService) {\n                let event = TrackingEventFactory(TrackingTypes.VIEWED, item);\n                this.trackingService.logEvent(event);\n            }\n            return item;\n        })\n        .catch( (e : Error) => of( e ) );\n    }\n}\n\n\n@Injectable(/*{ providedIn: 'root' }*/)\nexport class VersionResolver implements Resolve<string> {\n\n    constructor() { }\n\n    resolve(\n        route: ActivatedRouteSnapshot,\n        state: RouterStateSnapshot\n    ): Observable<any>|Promise<any>|any {\n        let version = route.paramMap.get(\"version\");\n        return Promise.resolve(version||null);\n    }\n}\n\n\n\n@Injectable()\nexport class NewItemResolver implements Resolve<Item> {\n\n    constructor(\n        private router: Router,\n        // private errorService: ErrorService\n    ) {\n\n    }\n\n    resolve( route: ActivatedRouteSnapshot, state: RouterStateSnapshot ): Observable<Item> {\n        let type = route.params.type;\n        let item = ItemFactory.create(type);\n        if(!item) {\n            let gpe = new GeoPlatformError(`Type ${type} is unsupported`, \"Unsupported Type\", 400);\n            // this.errorService.setError(gpe);\n            this.router.navigateByUrl('error', {skipLocationChange:false});\n            return empty();\n        } else {\n            return of(item);\n        }\n    }\n}\n\n\n\n@Injectable()\nexport class ErrorResolver implements Resolve<Error> {\n    constructor(private router: Router) {}\n    resolve( route: ActivatedRouteSnapshot, state: RouterStateSnapshot ): Observable<Error> {\n        let type = route.params.type;\n        let msg = \"An error has occurred\";\n        if(\"unsupported\" === type)\n            msg = `Type ${type} is not supported`;\n        else if(\"404\" === type)\n            msg = \"Item not found\";\n        let error = new Error(msg);\n        // error.error = \"Unsupported Type\";\n        return of(error);\n    }\n}\n","import { Inject, Injectable } from '@angular/core';\nimport { Observable, Observer, Subject, Subscription } from 'rxjs';\nimport { Item, Query, SearchResults, ItemService } from '@geoplatform/client';\nimport { logger } from '../logger';\n\n\n/**\n *\n */\nexport interface SearchServiceEvent<Q,R,I> {\n    query    ?: Q;\n    results  ?: R;\n    selected ?: I[];\n    error    ?: Error;\n}\n\n/**\n *\n */\nexport interface GeoPlatformSearchServiceEvent extends SearchServiceEvent<Query, SearchResults, Item> {\n\n}\n\n\n/**\n * Search Aware Component Interface\n *\n * Components which implement this interface can receive notifications when their\n * subscribed-to SearchService implementation trigger changes to queries,\n * search results, and selections\n */\nexport interface SearchAwareComponent<Q,R,I> {\n    onQueryChange( query : Q ) : void;\n    onResultsChange( results : R, error ?: Error ) : void;\n    onSelectedChange( selected : I[] ) : void;\n}\n\n/**\n * Search Service Interface\n *\n * Services which implement this interface can act as data providers for\n * SearchAwareComponent implementations\n */\nexport interface SearchService<Q,R,I> {\n    setQuery(query : Q);\n    getQuery() : Q;\n    getResults() : R;\n    search(query ?: Q);\n    select( item : I|I[] );\n    isSelected( item : I ) : boolean;\n    hasSelected() : boolean;\n    getSelected() : I[];\n    clearSelected();\n    subscribe( listener : SearchAwareComponent<Q,R,I> ) : Subscription;\n}\n\n\nconst INVALID_SUBJECT_ERROR = \"SearchService implementation must create a valid Subject using SearchService.prototype.createSubject()\";\n\n/**\n * Abstract Search Service\n *\n * Base Search Service implementation which implements most of the interfaces\n * methods. The remaning methods are required to be implemented by specific\n * implementations of this class\n */\nexport abstract class AbstractSearchService<Q,R,I> implements SearchService<Q,R,I> {\n\n    private _query : Q;\n    // protected query    : Q;\n\n    private _results : R;\n    // protected results  : R;\n\n    private _selected: I[] = [];\n    // protected selected : I[] = [];\n\n    private _error : Error;\n    // protected error    : Error;\n\n    protected subject : Subject<SearchServiceEvent<Q,R,I>>;\n    protected subject$ : Observable<SearchServiceEvent<Q,R,I>>;\n\n    constructor() {\n        this.subject = this.createSubject();\n        if(!this.subject) {\n            throw new Error(INVALID_SUBJECT_ERROR);\n        }\n        this.subject$ = this.subject.asObservable();\n    }\n\n    /**\n     * Factory to create the internal subject used to notify subscribers to\n     * changes in the data the search service is managing.\n     */\n    public abstract createSubject() : Subject<SearchServiceEvent<Q,R,I>>;\n\n    /**\n     * Triggers a query of data using either the supplied query instance or\n     * the most recent one managed by this service\n     */\n    public abstract search(query ?: Q);\n\n    /** Method to compare two items for similarity */\n    protected abstract compareItems(a : I, b : I) : boolean;\n\n    /** Method to sort search result items */\n    protected abstract sortItems( items: I[] );\n\n    /**\n     * Notify subscribers of a change to one or more pieces of managed data\n     */\n    public emit( event : SearchServiceEvent<Q,R,I> ) {\n        this.subject.next(event);\n    }\n\n    public getError() : Error { return this._error; }\n    protected setError( err : Error ) { this._error = err; }\n\n    /**\n     * Updates the query managed by this search service instance and optionally\n     * triggers a refresh of search results using that query\n     */\n    public setQuery(query : Q, andSearch ?: boolean) {\n        this._query = query;\n        this.emit({ query : query });\n\n        if( true === andSearch ) {\n            this.search();\n        }\n    }\n    public getQuery() : Q { return this._query; }\n\n    public getResults() : R { return this._results; }\n    protected setResults( results : R ) { this._results = results; }\n\n    /**\n     * Toggle one or more items as selected\n     */\n    public select( item : I|I[] ) {\n        if(Array.isArray(item)) { //multiple selections\n            item.forEach( it => this._toggleItem(it, false) );\n            this.emit({ selected: this._selected });\n            return;\n        }\n        this._toggleItem( item, true );\n    }\n\n    /**\n     * Internal method which toggles an Item as selected (or de-selected if it\n     * was already selected) and optionally triggers a notification of a change\n     * in the selected items managed by this service instance\n     */\n    protected _toggleItem( item : I, fireEvent : boolean ) {\n        if(!item) return;\n        let position = this._selected.findIndex( (s:I) => this.compareItems(s, item) );\n        if(position >= 0) { //already selected, deselect it and return\n            this._selected.splice(position, 1);\n            if(fireEvent) this.emit({selected: this._selected});\n            return;\n        }\n        this._selected.push(item);\n        this.sortItems(this._selected);\n        if(fireEvent) this.emit({selected: this._selected});\n    }\n\n    /**\n     * @param item being checked for selection\n     * @return boolean\n     */\n    public isSelected( item : I ): boolean {\n        return this._selected.length && item &&\n            this._selected.findIndex( (it:I) => this.compareItems(it, item) ) >= 0;\n    }\n\n    /**\n     * @return boolean true if there is one or more selected items\n     */\n    public hasSelected() : boolean {\n        return this._selected && this._selected.length > 0;\n    }\n\n    /**\n     * @return array of selected items\n     */\n    public getSelected() : I[] {\n        return this._selected;\n    }\n    protected setSelected( sel : I[] ) { this._selected = sel; }\n\n    /**\n     * De-selects all currently selected items\n     */\n    public clearSelected() {\n        this._selected = [];\n        this.emit({ selected: this._selected });\n    }\n\n    /**\n     * Registers a listener on this service's subject which will be notified\n     * upon any change in managed data\n     */\n    public subscribe( listener : SearchAwareComponent<Q,R,I> ) : Subscription {\n\n        let obs : Observer<SearchServiceEvent<Q,R,I>> = {\n            next : (value: SearchServiceEvent<Q,R,I>) => {\n                if( typeof(value) === 'undefined' || value === null) return;\n                if(value.query)\n                    listener.onQueryChange( value.query );\n                if(value.results)\n                    listener.onResultsChange( value.results, value.error||null );\n                if(value.selected)\n                    listener.onSelectedChange( value.selected );\n            },\n            error : ( err: Error ) => {\n                console.log(\"[ERROR] \" + err.message);\n            },\n            complete : () => { }\n        };\n\n        let sub = this.subject$.subscribe( obs );\n\n        if(this._query) {\n            this.emit({ query : this._query });\n        }\n        if(this._results || this._error) {\n            this.emit({ results : this._results, error: this._error||null });\n        }\n        if(this._selected) {\n            this.emit({ selected : this._selected });\n        }\n\n        return sub;\n    }\n\n}\n\n\n\n\n\n\n\n/**\n * GeoPlatform Search Service\n *\n * Instance of SearchService which allows searching GeoPlatform Portfolio (RIM)\n * Items (Datasets, Maps, Layers, Services, etc)\n */\n@Injectable()\nexport class GeoPlatformSearchService extends AbstractSearchService<Query, SearchResults, Item>{\n\n    constructor(\n        @Inject(ItemService) private service : ItemService\n    ) {\n        super();\n    }\n\n    protected getService() : ItemService { return this.service; }\n\n    createSubject() : Subject<SearchServiceEvent<Query,SearchResults,Item>> {\n        return new Subject<SearchServiceEvent<Query,SearchResults,Item>>();\n    }\n\n    /**\n     *\n     */\n    getQuery() : Query {\n        return super.getQuery().clone();\n    }\n\n    // /**\n    //  *\n    //  */\n    // setQuery(query : Query) {\n    //     super.setQuery( query ? query.clone() : query );\n    // }\n\n    /**\n     *\n     */\n    search(query ?: Query) {\n        //if a query was provided, store it and use it\n        if(query) this.setQuery(query);\n\n        this.service.search( super.getQuery() )\n        .then( (response : SearchResults) => {\n            logger.debug('SearchService.search() - ' + response.totalResults + \" results found\");\n            this.setResults(response);\n            this.setError(null);\n            this.emit({ results : response, error: null });\n        })\n        .catch( (error : Error) => {\n            logger.error(error.message);\n            this.setError(error);\n            this.emit({ results : null, error: error });\n        });\n    }\n\n\n    /**\n     *\n     */\n    _toggleItem( item : Item, fireEvent : boolean ) {\n        if(!item || !item.id) return;\n        let selected = this.getSelected();\n        let position = selected.findIndex( s => s.id === item.id );\n        if(position >= 0) { //already selected, deselect it and return\n            selected.splice(position, 1);\n            this.setSelected(selected);\n            if(fireEvent) this.emit({selected: selected});\n            return;\n        }\n\n        //new selection\n        // logger.error(`Selecting ${item.label} as ${entry.type.toString()}`);\n\n        //fetch full object and replace placeholder in selected array\n        this.service.get(item.id)\n        .then( fullItem => {\n            let selected = this.getSelected();\n            selected.push(fullItem);\n            this.sortItems(selected);\n            this.setSelected(selected);\n            if(fireEvent) this.emit({selected: selected});\n        })\n        .catch(e => {\n            logger.error(\"SearchService.select() - \" +\n                \"Error encountered fetching selected item's details: \" + e.message);\n        });\n    }\n\n    compareItems(a : Item, b : Item) : boolean {\n        return a.id === b.id;\n    }\n\n    sortItems( items: Item[] ) {\n        items.sort((a,b) => a.label > b.label ? 1 : -1 );\n    }\n\n}\n","\nimport { Item,ItemTypes } from '@geoplatform/client';\n\n\nexport interface SearchResultsItemAdapter<T> {\n    getId( item : T )           : string;\n    getLabel( item : T )        : string;\n    getDescription( item : T )  : string;\n    getAuthorName( item : T )   : string;\n    getEditorName( item : T )   : string;\n    getCreatedDate( item : T )  : string;\n    getModifiedDate( item : T ) : string;\n    getIconClass( item : T )    : string;\n    getTypeLabel( item : T )    : string;\n}\n\n\n\n\nconst GP_MAP_RESOURCE_TYPE = 'http://www.geoplatform.gov/ont/openmap/GeoplatformMap';\nconst AGOL_MAP_RESOURCE_TYPE = 'http://www.geoplatform.gov/ont/openmap/AGOLMap';\n\nexport class GeoPlatformResultsItemAdapter implements SearchResultsItemAdapter<Item> {\n\n    constructor() {}\n\n    getId( item: Item ) : string { return item.id; }\n    getLabel( item: Item ) : string {\n        return item.label || item.title ||\n               item.prefLabel || \"Untitled Item\";\n    };\n    getDescription( item: Item )  : string { return item.description; };\n    getAuthorName( item: Item )   : string { return item.createdBy; };\n    getEditorName( item: Item )   : string { return item.lastModifiedBy; };\n    getCreatedDate( item: Item )  : string { return item.created; };\n    getModifiedDate( item: Item ) : string { return item.modified; };\n\n    getIconClass( item: Item ) {\n        let type = item.type.replace(/^[a-z]+\\:/i, '').toLowerCase();\n        return 'icon-' + type;\n    }\n\n    getTypeLabel( item: Item ) {\n        if( ItemTypes.SERVICE === item.type && !!item.serviceType )\n            return item.serviceType.label || \"Service\";\n        if( ItemTypes.MAP === item.type) {\n            let resTypes = item.resourceTypes || [];\n            if( ~resTypes.indexOf(GP_MAP_RESOURCE_TYPE) ) return 'GeoPlatform Map';\n            if( ~resTypes.indexOf(AGOL_MAP_RESOURCE_TYPE) ) return 'ArcGIS Online Map';\n            return \"Map\";\n        }\n        if( ItemTypes.CONTACT === item.type) return 'Contact';\n        return item.type.replace(/^[a-z]+\\:/i, '');\n    }\n\n}\n","\nimport {\n    Component, OnInit, OnDestroy, OnChanges, SimpleChanges,\n    Input, Output, EventEmitter, TemplateRef\n} from '@angular/core';\nimport { Item, ItemTypes, QueryParameters } from '@geoplatform/client';\n\nimport { SearchEvent, EventTypes } from '../../event';\n\nimport { SearchResultsItemAdapter, GeoPlatformResultsItemAdapter } from './item-adapter';\n\n\n\nconst GP_MAP_RESOURCE_TYPE = 'http://www.geoplatform.gov/ont/openmap/GeoplatformMap';\nconst AGOL_MAP_RESOURCE_TYPE = 'http://www.geoplatform.gov/ont/openmap/AGOLMap';\n\n/**\n * Search Results Item Component\n *\n * This component is used to display search results items.\n *\n * Example:\n *   <div *ngFor=\"let item of results\">\n *     <gp-search-results-item [item]=\"item\"></gp-search-results-item>\n *   </div>\n *\n * Listen for selection or other events by passing an \"onEvent\" callback\n *\n * Example:\n *   <div *ngFor=\"let item of results\">\n *     <gp-search-results-item [item]=\"item\"\n *          (onEvent)=\"handleItemEvent($event)\">\n *     </gp-search-results-item>\n *   </div>\n *\n * Customize how the item is displayed using any of the template bindings\n *\n * Example:\n *   <div *ngFor=\"let item of results\">\n *     <gp-search-results-item [item]=\"item\"\n *          [itemHeadingTemplate]=\"myCustomHeadingTemplate\"\n *          [itemActionsTemplate]=\"myCustomActionsTemplate\">\n *     </gp-search-results-item>\n *   </div>\n *   <ng-template #myCustomHeadingTemplate let-item=\"item\">\n *     <div>My Customized {{item.label}}</div>\n *   </ng-template>\n *   <ng-template #myCustomActionsTemplate let-item=\"item\">\n *     <button type=\"button\" class=\"btn btn-link\" (click)=\"handleClick(item)\">Click Me</button>\n *   </ng-template>\n *\n */\n@Component({\n  selector: 'gp-search-results-item',\n  templateUrl: './item.component.html',\n  styleUrls: ['./item.component.less']\n})\nexport class SearchResultsItemComponent implements OnInit, OnChanges, OnDestroy {\n\n    @Input() public item       : Item;\n    @Input() public adapter : SearchResultsItemAdapter<Item>;\n    @Input() public isSelected : boolean = false;\n    @Input() public canSelect  : boolean = true;\n    @Input() public showDesc   : boolean = false;\n    @Input() public hasPrimaryAction : boolean = true;\n\n    //custom heading template\n    @Input() public headingTemplate   : TemplateRef<any>;\n    //\n    @Input() public subHeadingTemplate : TemplateRef<any>;\n    //custom thumbnail template\n    @Input() public thumbnailTemplate : TemplateRef<any>;\n    //\n    @Input() public contentTemplate : TemplateRef<any>;\n    //custom footer (complete)\n    @Input() public footerTemplate    : TemplateRef<any>;\n    //custom footer stats template\n    @Input() public statsTemplate     : TemplateRef<any>;\n    //custom footer actions template\n    @Input() public actionsTemplate   : TemplateRef<any>;\n    //custom primary action template\n    @Input() public primaryActionTemplate : TemplateRef<any>;\n\n    @Output() onEvent : EventEmitter<SearchEvent> = new EventEmitter<SearchEvent>();\n\n\n    constructor() { }\n\n    ngOnInit() {\n        if(!this.adapter) {\n            this.adapter = new GeoPlatformResultsItemAdapter();\n        }\n    }\n\n    ngOnChanges( changes : SimpleChanges ) {\n        if(changes.item || changes.adapter) {\n            // let item = changes.item ? changes.item.currentValue : null;\n            // let adapter = changes.adapter ? changes.adapter.currentValue : (\n            //     this.adapter\n            //     );\n            //\n            // if(item && !adapter) {\n            //     this.adapter =\n            // }\n        }\n    }\n\n    ngOnDestroy() {\n        this.adapter = null;\n    }\n\n    /**\n     * Triggers a selection event for the item\n     */\n    select() {\n        let event = new SearchEvent(EventTypes.SELECT, { value: this.item });\n        this.onEvent.emit(event);\n    }\n\n    // getIconClass() {\n    //     let type = this.item.type.replace(/^[a-z]+\\:/i, '').toLowerCase();\n    //     return 'icon-' + type;\n    // }\n    //\n    // getTypeLabel() {\n    //     if( ItemTypes.SERVICE === this.item.type && !!this.item.serviceType )\n    //         return this.item.serviceType.label || \"Service\";\n    //     if( ItemTypes.MAP === this.item.type) {\n    //         let resTypes = this.item.resourceTypes || [];\n    //         if( ~resTypes.indexOf(GP_MAP_RESOURCE_TYPE) ) return 'GeoPlatform Map';\n    //         if( ~resTypes.indexOf(AGOL_MAP_RESOURCE_TYPE) ) return 'ArcGIS Online Map';\n    //         return \"Map\";\n    //     }\n    //     if( ItemTypes.CONTACT === this.item.type) return 'Contact';\n    //     return this.item.type.replace(/^[a-z]+\\:/i, '');\n    // }\n\n    /**\n     * Trigger a search event which constrains by creator\n     */\n    constrainToUser(username) {\n        let change = {};\n        change[QueryParameters.CREATED_BY] = username;\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.onEvent.emit(event);\n    }\n\n}\n","import {\n    Inject, Component, OnInit, OnDestroy,\n    Input, Output, EventEmitter, TemplateRef\n} from '@angular/core';\nimport { PageEvent } from '@angular/material/paginator';\nimport { MatDialog, MatSelectChange } from '@angular/material';\nimport { Observer, Subscription } from 'rxjs';\nimport { Config, Query, SearchResults, Item } from \"@geoplatform/client\";\n// import { AppAuthService, AuthenticatedComponent } from \"../../auth\";\nimport { SearchEvent, EventTypes } from \"../../event\";\nimport { GeoPlatformSearchService, SearchServiceEvent, SearchAwareComponent } from \"../search.service\";\nimport { SearchResultsItemAdapter, GeoPlatformResultsItemAdapter } from \"../item/item-adapter\";\nimport { logger } from '../../logger';\n\n\nexport interface SearchSortOption {\n    value: string;\n    label: string;\n};\n\nconst DEFAULT_SORT_OPTIONS : SearchSortOption[] = [\n    { value: \"_score,desc\",     label: \"Relevance\"  },\n    { value: \"modified,desc\",   label: \"Most Recently Modified\"  },\n    { value: \"modified,asc\",    label: \"Least Recently Modified\" },\n    { value: \"label,asc\",       label: \"Title [A-Z]\" },\n    { value: \"label,desc\",      label: \"Title [Z-A]\" },\n    { value: \"reliability,asc\", label: \"Reliability\" }\n];\n\n\n/**\n * Search Results Component\n *\n * This component is used to display search results.\n *\n * Example:\n *   <gp-search-results [service]=\"service\">\n *   </gp-search-results>\n *\n *\n * Listen for selection or other events by passing an \"onEvent\" callback\n *\n * Example:\n *   <gp-search-results  [service]=\"service\"\n *        (onEvent)=\"handleItemEvent($event)\">\n *   </gp-search-results>\n *\n *\n * Support custom items by providing a SearchResultsItemAdapter\n *\n * Example:\n *   class CustomItemAdapter implements SearchResultsItemAdapter<Item> {\n *      constructor() {}\n *      getId( item: Item ) : string { return item.idField; }\n *      getLabel( item: Item ) : string { return item.heading; }\n *      //remaining methods...\n *   }\n *   ...\n *\n *   public myCustomItemAdapter : SearchResultsItemAdapter<Item> = new CustomItemAdapter();\n *\n *   ...\n *\n *   <gp-search-results [service]=\"service\"\n *        [adapter]=\"myCustomItemAdapter\">\n *   </gp-search-results>\n *\n *\n *\n * Customize how items are displayed using any of the template bindings\n *\n * Example:\n *   <gp-search-results [service]=\"service\"\n *        [itemHeadingTemplate]=\"myCustomItemHeadingTemplate\"\n *        [itemActionsTemplate]=\"myCustomItemActionsTemplate\">\n *   </gp-search-results>\n *   <ng-template #myCustomItemHeadingTemplate let-item=\"item\">\n *     <div>My Customized {{item.label}}</div>\n *   </ng-template>\n *   <ng-template #myCustomItemActionsTemplate let-item=\"item\">\n *     <button type=\"button\" class=\"btn btn-link\" (click)=\"handleClick(item)\">Click Me</button>\n *   </ng-template>\n *\n */\n@Component({\n  selector: 'gp-search-results',\n  templateUrl: './results.component.html',\n  styleUrls: ['./results.component.less']\n})\nexport class SearchResultsComponent\nimplements OnInit, OnDestroy, SearchAwareComponent<Query, SearchResults, Item> {\n\n    @Input() public service           : GeoPlatformSearchService;\n    @Input() public sortOptions       : SearchSortOption[] = DEFAULT_SORT_OPTIONS;\n    @Input() public showDesc          : boolean = false;\n    @Input() public hasPrimaryAction  : boolean = true;\n    @Input() public adapter           : SearchResultsItemAdapter<Item>;\n\n    //custom heading template\n    @Input() public itemHeadingTemplate       : TemplateRef<any>;\n    @Input() public itemSubHeadingTemplate    : TemplateRef<any>;\n    //custom thumbnail template\n    @Input() public itemThumbnailTemplate     : TemplateRef<any>;\n    //\n    @Input() public itemContentTemplate       : TemplateRef<any>;\n    //custom footer (complete)\n    @Input() public itemFooterTemplate        : TemplateRef<any>;\n    //custom footer stats template\n    @Input() public itemStatsTemplate         : TemplateRef<any>;\n    //custom footer actions template\n    @Input() public itemActionsTemplate       : TemplateRef<any>;\n    //custom primary action template\n    @Input() public itemPrimaryActionTemplate : TemplateRef<any>;\n\n    @Output() onEvent     : EventEmitter<SearchEvent> = new EventEmitter<SearchEvent>();\n\n    public query     : Query;\n    public results   : SearchResults;\n    public selected  : Item[];\n    public sortValue : string;\n    public isLoading : boolean = false;\n    public error     : Error;\n\n    //listener for when SearchService fires events for change in\n    // query, results, or selected items\n    private subscription : Subscription;\n\n\n    constructor(\n        // @Inject(AppAuthService) authService : AppAuthService,\n        private dialog : MatDialog\n    ) {\n        // super(authService);\n    }\n\n    ngOnInit() {\n        // super.init();\n\n        if(!this.adapter) {\n            this.adapter = new GeoPlatformResultsItemAdapter();\n        }\n\n        this.sortValue = this.sortOptions[0].value;\n        this.subscription = this.service.subscribe(this);\n    }\n\n    ngOnDestroy() {\n        // super.destroy();\n\n        if(this.subscription) {\n            this.subscription.unsubscribe();\n            this.subscription = null;\n        }\n        this.query = null;\n        this.results = null;\n        this.selected = null;\n    }\n\n    onQueryChange( query : Query ) {\n        this.query = query;\n        this.isLoading = true;\n    }\n    onResultsChange( results : SearchResults, error ?: Error ) {\n        this.results = results;\n        this.error = (error) ? error : null;\n        this.isLoading = false;\n    }\n    onSelectedChange( selected : Item[] ) {\n        this.selected = selected;\n    }\n\n    /**\n     *\n     */\n    isSelected (item : Item) : boolean {\n        return this.service.isSelected(item);\n    }\n\n    selectAllInPage() {\n        if(this.onEvent) {\n            let event = new SearchEvent(EventTypes.SELECT, {\n                value: this.results.results\n            });\n            this.onEvent.emit(event);\n        }\n    }\n\n    deselectAll() {\n        this.service.clearSelected();\n    }\n\n\n    /**\n     *\n     */\n    onItemEvent( $event : SearchEvent ) {\n        let name = $event.getType(); //$event.name;\n        if( !name ) return;\n        switch( name ) {\n\n            case EventTypes.SELECT :\n            if(this.onEvent) this.onEvent.emit($event);\n            break;\n\n            case EventTypes.QUERY :\n            let query = this.service.getQuery();\n            query.applyParameters($event.getOptions());\n            this.service.search(query);\n            break;\n\n        }\n    }\n\n    /**\n     * @param pageNo - new page number being requested\n     */\n    onPagingEvent( event : PageEvent ) {\n        let query = this.service.getQuery();\n        let previous = query.getPage();\n        let current = event.pageIndex;\n        if(previous !== current) {\n            query.page(current);\n        }\n        query.setPageSize( event.pageSize );\n\n        if(this.onEvent) {\n            let event = new SearchEvent(EventTypes.QUERY, { value : query });\n            this.onEvent.emit(event);\n        }\n    }\n\n    onSortChange($event : MatSelectChange) {\n        let query = this.service.getQuery();\n        query.sort(this.sortValue);\n\n        if(this.onEvent) {\n            let event = new SearchEvent(EventTypes.QUERY, { value : query });\n            this.onEvent.emit(event);\n        }\n    }\n\n}\n","import { Component, OnInit, OnDestroy, Inject } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { HttpClient } from '@angular/common/http';\nimport {\n    Config, Item, ItemService, Query, QueryParameters, ItemTypes\n} from '@geoplatform/client';\n\nimport { SearchEvent, EventTypes } from '../../event';\nimport { ListSelectDialogData, ListSelectDialog } from '../../dialogs';\n\n\nexport abstract class ItemFilterComponent implements OnInit, OnDestroy {\n\n    public  filterLabel : string = \"Item\";\n    public  isCollapsed : boolean = true;\n    public  choices     : any[];\n    public  selected    : Item[];\n    public  dialog      : MatDialog;\n    protected query     : Query\n\n\n    constructor(\n        @Inject(ItemService) private service : ItemService,\n        private types              : string|string[],\n        label                     ?: string,\n        @Inject(MatDialog) dialog ?: MatDialog\n    ) {\n        this.filterLabel = label;\n        if(dialog) this.dialog = dialog;\n    }\n\n    ngOnInit() {\n        this.selected = [] as Item[];\n        this.initQuery();\n        // this.fetchResults();\n    }\n\n    ngOnDestroy() {\n        this.selected = null;\n        this.choices = null;\n        this.service = null;\n        this.query = null;\n        this.types = null;\n    }\n\n    openDialog(): void {\n        let opts = this.getDialogOptions();\n        const dialogRef = this.dialog.open(ListSelectDialog, opts);\n        dialogRef.afterClosed().subscribe( ( results : Item[] ) => {\n            if(results && results.length) {\n                this.selected = this.selected.concat(results);\n\n                let key = this.getKey();\n                let change = {};\n                change[key] = this.selected.map( s => s.id );\n                change[QueryParameters.PAGE] = 0;\n                let event = new SearchEvent(EventTypes.QUERY, change);\n                this.notify(event);\n            }\n        });\n    }\n\n    /**\n     * @return configuration options for the material dialog used to select new values\n     */\n    getDialogOptions() : any {\n        return {\n            width: '50%',\n            data: {\n                service : this.service,\n                query   : this.query,\n                selected: []\n            }\n        };\n    }\n\n    isSupported() {\n        return true;\n    }\n\n    /**\n     *\n     */\n    initQuery() {\n        this.query = new Query().fields([]).facets([]).types(this.types);\n    }\n\n\n    hasSelections() : boolean {\n        return this.selected && this.selected.length > 0;\n    }\n\n    isSelected( arg : Item ) : boolean {\n        // let id = this.getChoiceId(arg);\n        return arg && this.selected.findIndex( s => s.id === arg.id ) > -1;\n    }\n\n\n    /**\n     * @param arg - item or identifier\n     */\n    toggle( arg : Item ) {\n        if(!arg) return;\n        // let id = this.getChoiceId(arg);\n        // if(id === null) return;\n\n        let idx = this.selected.findIndex( s => s.id === arg.id );\n        if(idx < 0) this.selected.push( arg );\n        else        this.selected.splice( idx, 1 );\n\n        let key = this.getKey();\n        let change = {};\n        change[key] = this.selected.map( s => s.id );\n        change[QueryParameters.PAGE] = 0;\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.notify(event);\n    }\n\n\n    // /**\n    //  * Update search results using current query\n    //  */\n    // fetchResults() {\n    //     this.service.search(this.query).then( (response:any) => {\n    //         this.choices = response.results as any[];\n    //     })\n    //     .catch( (e:Error) => {\n    //         this.choices = [] as any[];\n    //         //TODO display error to user\n    //     });\n    // }\n    //\n    // /**\n    //  * @param arg - item or identifier\n    //  * @return string identifier\n    //  */\n    // getChoiceId(arg : any) : string {\n    //     let id : string = null;\n    //     if('string' === typeof(arg)) {\n    //         id = arg as string;\n    //     } else if(arg && typeof(arg.id) !== 'undefined') {\n    //         id = arg.id as string;\n    //     }\n    //     if(id === null || id === 'undefined') {\n    //         let key = this.getKey();\n    //         console.log(`[WARN] Can't determine value for filter '${key}'`);\n    //         return null;\n    //     }\n    //     return id;\n    // }\n\n    clear() {\n        if(this.hasSelections()) {\n            this.selected = [];\n            let key = this.getKey();\n            let change = {};\n            change[key] = [];\n            change[QueryParameters.PAGE] = 0;\n            let event = new SearchEvent(EventTypes.QUERY, change);\n            this.notify(event);\n        } else {\n            this.isCollapsed = !this.isCollapsed;\n        }\n    }\n\n\n    protected abstract getKey() : string;\n    protected abstract notify( event : SearchEvent );\n\n}\n","import { Component, Input, Output, EventEmitter, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ItemTypes, QueryParameters, ItemService } from '@geoplatform/client';\nimport { ItemFilterComponent } from '../item-filter.component';\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\n@Component({\n  selector: 'gp-community-filter',\n  templateUrl: '../item-filter.component.html',\n  styleUrls: ['./community.component.less']\n})\nexport class CommunityFilterComponent extends ItemFilterComponent {\n\n    @Input()  key       : string = QueryParameters.USED_BY_ID;\n    @Output() onEvent   : EventEmitter<any> = new EventEmitter<any>();\n\n    constructor(\n        @Inject(ItemService) service : ItemService,\n        dialog : MatDialog\n    ) {\n        super(service, ItemTypes.COMMUNITY, \"Communities\", dialog);\n    }\n\n    getKey() : string {\n        return this.key;\n    }\n\n    notify( event : SearchEvent ) {\n        this.onEvent.emit(event);\n    }\n\n    initQuery() {\n        super.initQuery();\n        // this.query.fields(['subOrganizationOf']);\n    }\n\n    // getDialogOptions() : any {\n    //     let opts = super.getDialogOptions();\n    //     opts.data.subHeading = \"subOrganizationOf\";\n    //     return opts;\n    // }\n}\n","import {\n    Component, OnInit, OnDestroy, Input, Output, EventEmitter, Inject\n} from '@angular/core';\nimport {\n    Query, QueryParameters, QueryFacets, ItemService, SearchResults\n} from \"@geoplatform/client\";\n\nimport { SearchEvent, EventTypes } from '../../../event';\nimport { AuthenticatedComponent, AppAuthService } from '../../../auth';\n\n\ninterface Creator {\n    id   : string;\n    label: string;\n    count: number;\n};\n\n\n@Component({\n  selector: 'gp-createdby-filter',\n  templateUrl: './creator.component.html',\n  styleUrls: ['./creator.component.less']\n})\nexport class CreatedByFilterComponent extends AuthenticatedComponent implements OnInit, OnDestroy {\n\n    @Input() key            : string = QueryParameters.QUERY;\n    @Input() selected       : string;\n    @Output() onEvent       : EventEmitter<any> = new EventEmitter<any>();\n\n    public typeaheadValue   : string = null;\n    public isCollapsed      : boolean = true;\n    public pagination       : { page: number; size: number; } = { page: 0, size: 10 };\n    public values           : Creator[] = [];\n    public pagedValues      : Creator[] = [];\n    public outsideSelection : Creator;\n    public visibleAmount : number = 10;\n\n    constructor(\n        authService : AppAuthService,\n        @Inject(ItemService) private service : ItemService\n    ) {\n        super(authService);\n    }\n\n    ngOnInit() {\n        super.ngOnInit();\n        this.selected = null;\n        this.fetchValues();\n    }\n\n    ngOnDestroy() {\n        super.ngOnDestroy();\n        this.values = null;\n        this.pagedValues = null;\n        this.pagination = null;\n        this.selected = null;\n        this.outsideSelection = null;\n    }\n\n    notify( ) {\n        let key = this.key;\n        let change = {};\n        change[key] = this.selected;\n        change[QueryParameters.PAGE] = 0;\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.onEvent.emit(event);\n    }\n\n    hasSelections() : boolean {\n        return this.selected && this.selected.length > 0;\n    }\n\n    isSelected( arg : string ) : boolean {\n        return this.hasSelections() && this.getIndexOf(arg) >= 0;\n    }\n\n    getIndexOf( arg : string ) : number {\n        if(!this.selected || !this.selected.length) return -1;\n        return this.selected.indexOf(arg);\n    }\n\n\n    /**\n     * @param arg - item or identifier\n     */\n    toggle( arg : string ) {\n        if(this.selected && this.selected === arg) this.selected = null;\n        else this.selected = arg;\n        this.notify();\n    }\n\n    clear () {\n        if(this.hasSelections()) {\n            this.selected = null;\n            this.notify();\n\n        } else if( this.isCollapsed ){\n            this.isCollapsed = false;\n        }\n    }\n\n\n    fetchValues() {\n       let query = new Query().pageSize(1)\n           .facets(QueryFacets.CREATED_BY)\n           .parameter('includeFacet._createdBy.size', 1000);   //TODO not use Registry name\n\n       this.service.search(query)\n       .then( (response : SearchResults) => {\n           let facet = response.facets.find( facet => facet.name==='createdBy');\n           if(!facet) this.values = [];\n           else {\n               this.values = (facet.buckets||[]).map( (bucket:any) => {\n                   // Awaiting DT-1092 resolution\n                   return {\n                       id   : bucket.label,\n                       label: bucket.label,\n                       count: bucket.count\n                   };\n               });\n           }\n       })\n       .catch(e => { this.values = []; })\n       .finally ( () => {\n           this.updatePagedValues();\n       });\n    }\n\n    /**\n     *\n     */\n    nextPage() {\n        let numPages = Math.ceil(this.values.length / this.pagination.size);\n        this.pagination.page = Math.min( numPages-1, this.pagination.page+1);\n        this.updatePagedValues();\n    }\n\n    /**\n     *\n     */\n    prevPage() {\n        this.pagination.page = Math.max(0, this.pagination.page-1);\n        this.updatePagedValues();\n    }\n\n    /**\n     * @param resetStart boolean indicating to reset pagination start\n     */\n    updatePagedValues( resetStart ?: boolean ) {\n\n        if(resetStart) this.pagination.page = 0;\n\n        let values = this.values;\n        if(this.typeaheadValue && this.typeaheadValue.length) {\n            values = values.filter( v => v.label.indexOf(this.typeaheadValue) >=0 );\n        }\n\n        if(values.length < this.pagination.size) {\n            this.pagination.page = 0;   //reset current page\n            this.pagedValues = values;\n            console.log(\"Paged Values: \" + JSON.stringify(this.pagedValues));\n        }\n        let start = this.pagination.page*this.pagination.size;\n        let end = Math.min(start + this.pagination.size, values.length);\n        this.pagedValues = values.slice(start, end);\n\n        this.checkForOutsideSelections();\n    }\n\n    /**\n     *\n     */\n    checkForOutsideSelections() {\n        let selected = this.getSelection();\n        if( selected && !this.pagedValues.find(v => v.id === selected) ) {\n            this.outsideSelection = selected;\n        } else {\n            this.outsideSelection = null;\n        }\n    }\n\n    /**\n     *\n     */\n    clearTypeAhead() {\n        this.typeaheadValue = null;\n        this.updatePagedValues();\n    }\n\n    /**\n     *\n     */\n    toggleCurrentUser() {\n        let username = this.getCurrentUserName();\n        if(username) this.toggle( username );\n        else { console.log(\"No user to use to filter\"); }\n    }\n\n    getCurrentUserName() {\n        if(!this.isAuthenticated()) return null;\n        let user = this.getUser();\n        return user ? user.username : null;\n    }\n\n    getSelection() {\n       // let value = this.service.getCreatedBy();\n       // if(Array.isArray(value)) return value.length ? value[0] : null;\n       // return value;\n       return null;\n   }\n}\n","import {\n    Component, OnInit, Input, Output, EventEmitter\n} from '@angular/core';\nimport { QueryParameters } from \"@geoplatform/client\";\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\n@Component({\n  selector: 'gp-keywords-filter',\n  templateUrl: './keyword.component.html',\n  styleUrls: ['./keyword.component.less']\n})\nexport class KeywordFilterComponent implements OnInit {\n\n    @Input() key            : string = QueryParameters.QUERY;\n    @Input() searchString   : string;\n    @Input() placeholder    : string = \"Search GeoPlatform\";\n    @Output() onEvent       : EventEmitter<any> = new EventEmitter<any>();\n\n    constructor() { }\n\n    ngOnInit() { }\n\n    onKeyUp($event) {\n        let text = $event.target.value;\n        this.onValueChange(text);\n    }\n\n    onValueChange( value ) {\n        let change = {};\n        change[this.key] = value && value.length ? value : null;\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.onEvent.emit(event);\n    }\n\n    clear() {\n        this.searchString=null;\n        this.onValueChange(null);\n    }\n}\n","import { Component, Input, Output, EventEmitter, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ItemTypes, QueryParameters, ItemService } from '@geoplatform/client';\nimport { ItemFilterComponent } from '../item-filter.component';\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\n@Component({\n  selector: 'gp-publisher-filter',\n  templateUrl: '../item-filter.component.html',\n  styleUrls: ['./publisher.component.less']\n})\nexport class PublisherFilterComponent extends ItemFilterComponent {\n\n    @Input()  key       : string = QueryParameters.PUBLISHERS_ID;\n    @Output() onEvent   : EventEmitter<any> = new EventEmitter<any>();\n\n    constructor(\n        @Inject(ItemService) service : ItemService,\n        dialog : MatDialog\n    ) {\n        super(service, ItemTypes.ORGANIZATION, \"Publishers\", dialog);\n    }\n\n    getKey() : string {\n        return this.key;\n    }\n\n    notify( event : SearchEvent ) {\n        this.onEvent.emit(event);\n    }\n\n    initQuery() {\n        super.initQuery();\n        this.query.fields(['subOrganizationOf']);\n    }\n\n    getDialogOptions() : any {\n        let opts = super.getDialogOptions();\n        opts.data.subHeading = \"subOrganizationOf\";\n        return opts;\n    }\n}\n","import { Component, Input, Output, EventEmitter, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Query, ItemTypes, QueryParameters, ItemService } from '@geoplatform/client';\nimport { ItemFilterComponent } from '../item-filter.component';\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\n@Component({\n  selector: 'gp-scheme-filter',\n  templateUrl: '../item-filter.component.html',\n  styleUrls: ['./scheme.component.less']\n})\nexport class SchemeFilterComponent extends ItemFilterComponent {\n\n    //the key associated with this filter's selections\n    @Input()  key       : string = QueryParameters.SCHEMES_ID;\n    //the current set of values\n    @Input()  selected  : string[] = [];\n    //the query being affected by this filter's selections\n    // used to determine if this filter should be shown or not\n    @Input()  query     : Query;\n    @Output() onEvent   : EventEmitter<any> = new EventEmitter<any>();\n\n    constructor(\n        @Inject(ItemService) service : ItemService,\n        dialog : MatDialog\n    ) {\n        super(service, ItemTypes.CONCEPT_SCHEME, \"Scheme\", dialog);\n    }\n\n    getKey() : string {\n        return this.key;\n    }\n\n    notify( event : SearchEvent ) {\n        this.onEvent.emit(event);\n    }\n\n    isSupported() : boolean {\n        if(this.query) {\n            let types = this.query.getTypes();\n            return types && types.length && types.indexOf(ItemTypes.CONCEPT)>=0;\n        }\n        return false;\n    }\n\n}\n","import {\n    Inject, Component, OnInit, OnChanges, OnDestroy\n} from '@angular/core';\nimport {\n    MatDialog, MatDialogRef, MAT_DIALOG_DATA\n} from '@angular/material/dialog';\nimport {\n    Item, KGService, KGQuery, SearchResults\n} from \"@geoplatform/client\";\n\n\n\n\nexport interface SemanticDialogData {\n    selected : Item[];\n    service  : KGService;\n}\n\n\n@Component({\n  selector: 'gp-semantic-filter-dialog',\n  templateUrl: 'semantic.dialog.html',\n  styleUrls: ['./semantic.dialog.less']\n})\nexport class SemanticFilterDialog {\n\n    public  suggested : any[];\n    public  termQuery : string;\n    private kgQuery   : KGQuery;\n\n    //pagination\n    public  currentPage    : number = 0;\n    public  totalSuggested : number = 0;\n\n    constructor (\n        public dialogRef: MatDialogRef<SemanticFilterDialog>,\n        @Inject(MAT_DIALOG_DATA) public data: SemanticDialogData\n    ) {\n        this.kgQuery = new KGQuery().page(this.currentPage).pageSize(12);\n    }\n\n    onNoClick () : void {\n        this.dialogRef.close();\n    }\n\n\n    /**\n     * @param {string} value - user input to filter options with\n     * @return {Promise} resolving array of string options\n     */\n    filterValues ( value: string ) : void {\n\n        if(!value) {    //require user to provide input before searching\n            this.suggested = [];\n            this.totalSuggested = 0;\n            return;\n        }\n\n        this.kgQuery.q(value);\n\n        this.data.service.suggest(this.kgQuery)\n        .then( ( response : SearchResults ) => {\n            let hits = response.results;\n            // if(current && current.length) {\n            //     hits = hits.filter(o => { return current.indexOf(o.uri)<0; });\n            // }\n            this.suggested = hits;\n            this.totalSuggested = response.totalResults;\n        })\n        .catch(e => {\n            //display error message indicating an issue searching...\n        });\n    }\n\n    addValue ( arg : Item) : void {\n        this.data.selected.push( arg );\n    }\n\n    removeValue ( value: Item ) : void {\n        let index = -1;\n        this.data.selected.forEach( (p,i) => { if(p.uri === value.uri) { index = i; } });\n        if (index >= 0) {\n            this.data.selected.splice(index, 1);\n        }\n    }\n\n    isSelected ( arg : Item ) : boolean {\n        return this.data.selected.length > 0 &&\n            !!this.data.selected.find( (s) => s.uri === arg.uri);\n    }\n\n\n    /**\n     * @param pageNo - new page number being requested\n     */\n    onPageChange( pageNo : number ) {\n        if(this.currentPage !== pageNo-1 ) {\n            this.kgQuery.page( pageNo-1 );\n            this.filterValues( this.termQuery );\n        }\n    }\n}\n","\nimport {\n    Component, OnInit, OnDestroy, Input, Output, EventEmitter, Inject\n} from '@angular/core';\nimport { HttpClient } from \"@angular/common/http\";\nimport { MatDialog } from '@angular/material/dialog';\nimport { Observable, Subject, of, from } from 'rxjs';\nimport { map, flatMap, startWith } from 'rxjs/operators';\nimport { Item, Config, QueryParameters, KGService } from \"@geoplatform/client\";\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\nimport { SemanticDialogData, SemanticFilterDialog } from \"./semantic.dialog\";\n\n\n\n@Component({\n  selector: 'gp-semantic-filter',\n  templateUrl: './semantic.component.html',\n  styleUrls: ['./semantic.component.less']\n})\nexport class SemanticFilterComponent implements OnInit {\n\n    @Input()  key       : string;\n    @Output() onEvent   : EventEmitter<any> = new EventEmitter<any>();\n\n    public isCollapsed : boolean = true;\n    public selected  : Item[];\n    public visibleAmount : number = 10;\n\n    constructor(\n        @Inject(KGService) private service : KGService,\n        @Inject(MatDialog) public dialog: MatDialog\n    ) {\n\n    }\n\n    ngOnInit() {\n        this.selected = [];\n    }\n\n    openDialog(): void {\n\n        const dialogRef = this.dialog.open(SemanticFilterDialog, {\n            width: '50%',\n            data: { service : this.service, selected: [] }\n        });\n\n        dialogRef.afterClosed().subscribe( ( result : Item[] ) => {\n            if(result && result.length) {\n                this.selected = this.selected.concat(result);\n                this.notify();\n            }\n        });\n    }\n\n    getKey() : string {\n        return this.key;\n    }\n\n    notify( ) {\n        let key = this.key;\n        let change = {};\n        change[key] = this.selected.map(s=>s.uri);\n        change[QueryParameters.PAGE] = 0;\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.onEvent.emit(event);\n    }\n\n    hasSelections() : boolean {\n        return this.selected && this.selected.length > 0;\n    }\n\n    isSelected( arg : Item ) : boolean {\n        return this.hasSelections() && this.getIndexOf(arg) >= 0;\n    }\n\n    getIndexOf( arg : Item ) : number {\n        if(!this.selected || !this.selected.length) return -1;\n        return this.selected.findIndex( s=> s.uri === arg.uri );\n    }\n\n\n    /**\n     * @param arg - item or identifier\n     */\n    toggle( arg : Item ) {\n        let idx = this.getIndexOf(arg);\n        if( idx >= 0 ) this.selected.splice(idx, 1);    //found, remove it\n        else this.selected.push(arg);                   //not found, add it\n        this.notify();\n    }\n\n    clear () {\n        if(this.hasSelections()) {\n            this.selected = [];\n            this.notify();\n\n        } else if( this.isCollapsed ){\n            this.isCollapsed = false;\n        }\n    }\n\n}\n","import { Component, Input, Output, EventEmitter, OnInit, OnDestroy, Inject } from '@angular/core';\nimport {\n    Query, QueryParameters, ItemTypes, Item, ItemService, SearchResults\n} from '@geoplatform/client';\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\n@Component({\n    selector: 'gp-service-type-filter',\n    templateUrl: './service-types.component.html',\n    styleUrls: ['./service-types.component.scss']\n})\nexport class ServiceTypeFilterComponent implements OnInit, OnDestroy {\n\n    //the key associated with this filter's selections\n    @Input()  key       : string = QueryParameters.SERVICE_TYPES;\n    //the current set of values\n    @Input()  selected  : string[] = [];\n    //the query being affected by this filter's selections\n    // used to determine if this filter should be shown or not\n    @Input()  query     : Query;\n    @Output() onEvent   : EventEmitter<SearchEvent> = new EventEmitter<SearchEvent>();\n\n    public  isCollapsed : boolean = true;\n    public  types       : Item[] = [];\n\n    constructor(\n        @Inject(ItemService) private service : ItemService\n    ) { }\n\n    ngOnInit() {\n        let query = new Query({\n            type:           'dct:Standard',\n            resourceType:   'ServiceType',\n            fields:         \"availableVersions\",\n            size:           50,\n            sort:           'label,asc'\n        });\n        this.service.search(query)\n        .then( (response : SearchResults) => {\n            this.types = response.results;\n        })\n        .catch( (error : Error) => {\n            console.log(\"Error loading supported service types\");\n        });\n    }\n\n    ngOnDestroy () {\n        this.types = null;\n        // this.svcQuery = null;\n        // this.serviceSvc = null;\n        // this.serviceTypes = null;\n        // this.serviceTypesError = null;\n        // this.byType = null;\n    }\n\n    hasSelections () : boolean {\n        return this.selected && this.selected.length > 0;\n    }\n\n    isSelected (value : any) : boolean {\n        return this.hasSelections() && this.selected.indexOf(value) >= 0;\n    }\n\n    getIndexOf(value : any) : number {\n        return this.hasSelections() ? this.selected.indexOf(value) : -1;\n    }\n\n    isSupported() : boolean {\n        if(this.query) {\n            let types = this.query.getTypes();\n            return types && types.length && types.indexOf(ItemTypes.SERVICE)>=0;\n        }\n        return false;\n    }\n\n    toggle (value : any) {\n        let result = this.selected.slice(0);\n        let idx = this.getIndexOf(value);\n        if(idx >= 0) {\n            result = result.splice(idx, 1);\n        } else {\n            result.push(value);\n        }\n\n        let change = {};\n        change[this.key] = result;\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.onEvent.emit(event);\n    }\n\n    clear () {\n        if(!this.hasSelections())\n            this.isCollapsed = !this.isCollapsed; //toggle collapsed state\n        else {\n            let change = {};\n            change[this.key] = null;\n            let event = new SearchEvent(EventTypes.QUERY, change);\n            this.onEvent.emit(event);\n        }\n    }\n\n    getCount (value : any) : number {\n        // var facet = this.service.getFacet(\"serviceTypes\");\n        // if(!facet) return '';\n        // var valObj = facet.buckets.find(function(v) { return v.label===value; });\n        // if(!valObj) return '';\n        // return valObj.count;\n        return 0;\n    }\n\n\n\n\n/*\n    // isSupported () {\n    //     let objTypes = this.service.getTypes();\n    //     return objTypes && (\n    //         ~objTypes.indexOf( APIClient.ItemTypes.DATASET ) ||\n    //         ~objTypes.indexOf( APIClient.ItemTypes.LAYER )\n    //     );\n    // }\n\n    getValue() : any {\n        // return this.service.getService();\n        return null;\n    }\n\n    setValue( value : any ) {\n        // this.service.setService(value);\n        // this.svcInstValue = value;\n        //\n        // if(!this.hasSelections())\n        // this.values = [];\n    }\n\n    hasSelections () : boolean {\n        // return !!this.getValue();\n        return false;\n    }\n\n    isSelected ( value : any ) {\n        // let current = this.getValue();\n        // if(!current) return false;\n        // return current === value.id;\n        return false;\n    }\n\n    toggle ( value : any ) {\n        // let val = value;\n        // if(this.isSelected(value)) {\n        //     val = null;\n        // }\n        // this.setValue(val);\n    }\n\n    clear () {\n        if(!this.hasSelections()) {\n            this.isCollapsed = !this.isCollapsed;\n        } else {\n            this.setValue(null);\n        }\n    }\n\n    getCount ( value : any ) : number {\n        return 0;\n    }\n\n\n    updateValues (query : Query) {\n\n        // if(!query || !query.length) {\n        //     this.values = this.values.filter( v => this.isSelected(v) );\n        //     return;\n        // }\n        //\n        // this.svcQuery.q(query);\n        //\n        // return this.serviceSvc.search(this.svcQuery)\n        // .then( (response) => {\n        //     this.$timeout( () => {\n        //         let newValues = response.results;\n        //         if(this.hasSelections() && this.values && this.values.length) {\n        //             let existing = this.values.filter( v => {\n        //                 //find existing values that are selected\n        //                 return this.isSelected(v) &&\n        //                 // but not in new set of values\n        //                 !newValues.filter( nv => nv.id === v.id).length;\n        //             });\n        //             newValues = existing.concat(newValues);\n        //         }\n        //         this.values = newValues;\n        //     });\n        // })\n        // .catch( (error) => {\n        //     let err = (error && error.message) ? error :\n        //     (error && error.data) ? error.data : {\n        //         message: \"something unexpected came back from GeoPlatform API\"\n        //     };\n        //     console.log(\"An error occurred searching Services...\");\n        //     console.log(err.message);\n        // });\n    }\n*/\n}\n","import {\n    Component, OnInit, OnChanges, SimpleChanges,\n    Input, Output, EventEmitter, Inject\n} from '@angular/core';\nimport { Item, QueryParameters, ItemService } from \"@geoplatform/client\";\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\n\n@Component({\n  selector: 'gp-similarity-filter',\n  templateUrl: './similarity.component.html',\n  styleUrls: ['./similarity.component.less']\n})\nexport class SimilarityFilterComponent implements OnInit, OnChanges {\n\n    @Input()  key     : string = QueryParameters.SIMILAR_TO;\n    @Input()  selected: string;\n    @Output() onEvent : EventEmitter<SearchEvent> = new EventEmitter<SearchEvent>();\n\n    public  isCollapsed : boolean = true;\n    public    item : Item;\n\n    constructor( @Inject(ItemService) private service : ItemService ) { }\n\n    ngOnInit() { }\n\n    ngOnChanges( changes : SimpleChanges ) {\n        if(changes.selected) {\n            let id = changes.selected.currentValue;\n            if(!id) this.item = null;\n            else {\n                this.service.get(id)\n                .then( (result : Item) => { this.item = result; })\n                .catch( (err : Error) => {\n                    console.log(\"SimilarityFilter.OnChange('selected') : \", err);\n                });\n            }\n        }\n    }\n\n\n    clear() {\n        let change = {};\n        change[this.key] = null;\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.onEvent.emit(event);\n    }\n}\n","import { Component, Input, Output, EventEmitter, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ItemTypes, QueryParameters, ItemService } from '@geoplatform/client';\nimport { ItemFilterComponent } from '../item-filter.component';\nimport { SearchEvent, EventTypes } from '../../../event';\n\n@Component({\n  selector: 'gp-theme-filter',\n  templateUrl: '../item-filter.component.html',\n  styleUrls: ['./theme.component.less']\n})\nexport class ThemeFilterComponent extends ItemFilterComponent {\n\n    @Input()  key       : string = QueryParameters.THEMES_ID;\n    @Output() onEvent   : EventEmitter<any> = new EventEmitter<any>();\n\n    constructor(\n        @Inject(ItemService) service : ItemService,\n        dialog : MatDialog\n    ) {\n        super(service, ItemTypes.CONCEPT, \"Themes\", dialog);\n    }\n\n    getKey() : string {\n        return this.key;\n    }\n\n    notify( event : SearchEvent ) {\n        this.onEvent.emit(event);\n    }\n\n    initQuery() {\n        super.initQuery();\n        this.query.fields(['scheme']);\n    }\n\n    getDialogOptions() : any {\n        let opts = super.getDialogOptions();\n        opts.data.subHeading = \"scheme\";\n        return opts;\n    }\n\n}\n","import { Component, Input, Output, EventEmitter, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ItemTypes, QueryParameters, ItemService } from '@geoplatform/client';\nimport { ItemFilterComponent } from '../item-filter.component';\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\n@Component({\n  selector: 'gp-topic-filter',\n  templateUrl: '../item-filter.component.html',\n  styleUrls: ['./topic.component.less']\n})\nexport class TopicFilterComponent extends ItemFilterComponent {\n\n    @Input()  key       : string = QueryParameters.TOPIC_ID;\n    @Output() onEvent   : EventEmitter<any> = new EventEmitter<any>();\n\n    constructor(\n        @Inject(ItemService) service : ItemService,\n        dialog : MatDialog\n    ) {\n        super(service, ItemTypes.TOPIC, \"Topics\", dialog);\n    }\n\n    getKey() : string {\n        return this.key;\n    }\n\n    notify( event : SearchEvent ) {\n        this.onEvent.emit(event);\n    }\n\n}\n","import {\n    Component, OnInit, OnChanges,\n    Input, Output, EventEmitter, SimpleChanges\n} from '@angular/core';\nimport { ItemTypes, ItemTypeLabels, QueryParameters } from '@geoplatform/client';\nimport { SearchEvent, EventTypes } from '../../../event';\n\n\n\n@Component({\n  selector: 'gp-type-filter',\n  templateUrl: './type.component.html',\n  styleUrls: ['./type.component.less']\n})\nexport class TypeFilterComponent implements OnInit {\n\n    @Input()  key       : string = QueryParameters.TYPES;\n    @Input()  facets    : any[];\n    @Input()  selected  : string[] = [];\n    @Output() onEvent   : EventEmitter<any> = new EventEmitter<any>();\n\n    public isCollapsed : boolean = true;\n    public choices : any[];\n    public visibleAmount : number = 10;\n\n    constructor() {\n\n    }\n\n    ngOnInit() {\n        this.choices = Object.keys(ItemTypes).map(key=>{\n            let type = ItemTypes[key];\n            if( ItemTypes.STANDARD === type || ItemTypes.RIGHTS_STATEMENT === type) return null;\n            return { label: ItemTypeLabels[type], value: type };\n        }).filter(v=>!!v);\n        // console.log(\"TypeFilter.onInit() \" + JSON.stringify(this.selected));\n    }\n\n    ngOnChanges( changes : SimpleChanges ) {\n        if(changes.selected) {\n            let value = changes.selected.currentValue;\n\n            console.log(\"TypeFilter.onChanges() \" + JSON.stringify(value));\n\n            //if a selected value wasn't provided, ensure it's 'null' and not undefined\n            if(value === undefined) {\n                this.selected = [];\n            } else if(typeof(value) === 'string') {\n                this.selected = [value];\n            }\n        }\n    }\n\n    getKey() : string {\n        return this.key;\n    }\n\n    notify( event : SearchEvent ) {\n        this.onEvent.emit(event);\n    }\n\n\n    hasSelections() : boolean {\n        return this.selected && this.selected.length > 0;\n    }\n\n    isSelected( arg : any ) : boolean {\n        return this.getIndexOf(arg) >= 0;\n    }\n\n    getIndexOf( arg: any ) : number {\n        return this.selected ? this.selected.indexOf(arg) : -1;\n    }\n\n\n    /**\n     * @param arg - item or identifier\n     */\n    toggle( arg : any ) {\n\n        let idx = this.getIndexOf(arg);\n        if(idx >= 0) {\n            this.selected.splice(idx, 1);\n        } else {\n            this.selected.push(arg);\n        }\n\n\n        let key = this.getKey();\n        let value = this.selected.length ? this.selected : null;\n        let change = {};\n        change[key] = value;\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.notify(event);\n    }\n\n    clear () {\n        if(this.hasSelections()) {\n            this.selected = [];\n            let key = this.getKey();\n            let change = {};\n            change[key] = null;\n            let event = new SearchEvent(EventTypes.QUERY, change);\n            this.notify(event);\n\n        } else if( this.isCollapsed ){\n            this.isCollapsed = false;\n        }\n    }\n\n\n    getCount( value : any ) : string|number {\n        let facet = (this.facets||[]).find( (facet) => facet.name === this.key );\n        if(!facet || !facet.buckets || !facet.buckets.length) {\n            // console.log(\"No facet for \" + this.key);\n            return '';\n        }\n        let valObj = facet.buckets.find( (v) => v.label === value );\n        if(!valObj) {\n            // console.log(\"No bucket for \" + value);\n            return '';\n        }\n        return valObj.count;\n    }\n\n}\n","import {\n    Component, OnInit, Input, Output, EventEmitter, ViewChild\n} from '@angular/core';\nimport {\n    MatDatepicker, MatDatepickerInputEvent,\n    DateAdapter, NativeDateAdapter, MAT_DATE_FORMATS\n} from '@angular/material';\nimport { QueryParameters } from \"@geoplatform/client\";\n\nimport { SearchEvent, EventTypes } from '../../../event';\n\n\nconst BEFORE = \"Before\";\nconst AFTER  = \"After\";\n\n\n@Component({\n  selector: 'gp-modified-filter',\n  templateUrl: './modified.component.html',\n  styleUrls: ['./modified.component.less']\n})\nexport class ModifiedFilterComponent implements OnInit {\n\n    @Input() key            : string = QueryParameters.MODIFIED;\n    @Input() value          : number;\n    @Output() onEvent       : EventEmitter<any> = new EventEmitter<any>();\n    @ViewChild(MatDatepicker, {static:false}) datepicker: MatDatepicker<Date>;\n\n    public isCollapsed         : boolean = true;\n    public format              : string = 'MM/DD/YYYY' //'MMM dd yyyy';\n    public debouncePromise     : any = null;\n    public lastModifiedOptions : string[] = [BEFORE, AFTER];\n    public lastModifiedDir     : string = BEFORE;\n\n    constructor() { }\n\n    ngOnInit() {\n        // console.log(\"Modified.init() : \" + this.lastModifiedDir);\n    }\n\n    // onKeyUp($event) {\n    //     let text = $event.target.value;\n    //     this.onValueChange(text);\n    // }\n\n    onDateChanged( event: MatDatepickerInputEvent<Date> ) {\n        this.value = event && event.value ? event.value.getTime() : null;\n        this.onValueChange( this.value );\n    }\n\n    onValueChange( value ) {\n        let change = {};\n\n        if(BEFORE === this.lastModifiedDir) {\n            change[QueryParameters.MODIFIED_BEFORE] = value;\n            change[QueryParameters.MODIFIED_AFTER] = null;\n        } else {\n            change[QueryParameters.MODIFIED_AFTER] = value;\n            change[QueryParameters.MODIFIED_BEFORE] = null;\n        }\n\n        let event = new SearchEvent(EventTypes.QUERY, change);\n        this.onEvent.emit(event);\n    }\n\n    onDirChange() {\n        // console.log(\"Modified.onDirChange() : \" + this.lastModifiedDir);\n        if(this.value) {\n            this.onValueChange(this.value);\n        }\n    }\n\n    clear() {\n        if(this.value) {\n            this.value = null;\n            this.onValueChange(this.value);\n        } else {\n            this.isCollapsed = true;\n        }\n    }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport {\n    MatButtonModule, MatIconModule, MatInputModule, MatSelectModule,\n    MatDialogModule, MatProgressBarModule, MatTabsModule, MatPaginatorModule,\n    MatDatepickerModule, MatNativeDateModule, NativeDateModule\n} from '@angular/material';\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\n\n\n// Adds window.RPMService to global namespace\nimport { RPMServiceFactory } from '@geoplatform/rpm/dist/js/geoplatform.rpm.browser.js';\nimport { RPMService }        from '@geoplatform/rpm/src/iRPMService'\n// import { RPMStatsService }   from './rpm/rpmstats.service';\n// let RPMStatsServiceFactory = (http: HttpClient) => {\n//     return new RPMStatsService(environment.rpmUrl, environment.rpmToken, http)\n// }\n\n\n// import { GeoPlatformClientModule } from '@geoplatform/client/angular';\n\nimport { TrackingService } from '@geoplatform/client';\nimport { TrackingServiceFactory } from './tracking.factory';\n\n\nimport { AppAuthService, LoginButtonComponent, LoginModalComponent } from './auth';\nimport { ListSelectDialog, MessageDialog } from './dialogs/';\n\n\nimport {\n    GeoPlatformSearchService,\n    SearchResultsComponent,\n    SearchResultsItemComponent,\n\n    CommunityFilterComponent,\n    CreatedByFilterComponent,\n    KeywordFilterComponent,\n    PublisherFilterComponent,\n    SchemeFilterComponent,\n    SemanticFilterComponent, SemanticFilterDialog,\n    ServiceTypeFilterComponent,\n    SimilarityFilterComponent,\n    ThemeFilterComponent,\n    TopicFilterComponent,\n    TypeFilterComponent,\n    ModifiedFilterComponent\n} from './search';\n\n\nimport {\n    ImageFallbackDirective,\n    ThumbnailComponent,\n    ResourceLinkComponent,\n    SelectedItemsComponent,\n    HeaderComponent\n} from './components';\n\nimport {\n    ArrayedItemsPipe,\n    LimitToPipe,\n    SortByPipe,\n    FriendlyTypePipe,\n    FixLabelPipe\n} from './pipes';\nimport { GeoPlatformIconDirective } from './directives/icon';\nimport {\n    ItemResolver, NewItemResolver, ErrorResolver, VersionResolver\n} from './resolvers';\nimport { GeoPlatformErrorService  } from './error.service';\nimport { ItemHelper               } from './item-helper';\n\n\n\n\n@NgModule({\n    imports: [\n        RouterModule,\n        CommonModule,\n        FormsModule,\n        MatButtonModule, MatIconModule, MatInputModule, MatSelectModule,\n        MatDialogModule, MatProgressBarModule, MatTabsModule, MatPaginatorModule,\n        MatDatepickerModule, MatNativeDateModule, NativeDateModule,\n        NgbModule,\n        // GeoPlatformClientModule\n    ],\n    exports: [\n        ListSelectDialog,\n        MessageDialog,\n        ImageFallbackDirective, ThumbnailComponent,\n        SelectedItemsComponent,\n        ResourceLinkComponent,\n        LoginButtonComponent, LoginModalComponent,\n        HeaderComponent,\n\n        ArrayedItemsPipe,\n        LimitToPipe,\n        SortByPipe,\n        FriendlyTypePipe,\n        FixLabelPipe,\n\n        GeoPlatformIconDirective,\n\n        SearchResultsComponent,\n        SearchResultsItemComponent,\n\n        CommunityFilterComponent,\n        CreatedByFilterComponent,\n        KeywordFilterComponent,\n        PublisherFilterComponent,\n        SchemeFilterComponent,\n        SemanticFilterComponent, SemanticFilterDialog,\n        ServiceTypeFilterComponent,\n        SimilarityFilterComponent,\n        ThemeFilterComponent,\n        TopicFilterComponent,\n        TypeFilterComponent,\n        ModifiedFilterComponent\n    ],\n    declarations: [\n        ListSelectDialog,\n        MessageDialog,\n        ImageFallbackDirective, ThumbnailComponent,\n        SelectedItemsComponent,\n        ResourceLinkComponent,\n        LoginButtonComponent, LoginModalComponent,\n        HeaderComponent,\n\n        ArrayedItemsPipe,\n        LimitToPipe,\n        SortByPipe,\n        FriendlyTypePipe,\n        FixLabelPipe,\n\n        GeoPlatformIconDirective,\n\n        SearchResultsComponent,\n        SearchResultsItemComponent,\n\n        CommunityFilterComponent,\n        CreatedByFilterComponent,\n        KeywordFilterComponent,\n        PublisherFilterComponent,\n        SchemeFilterComponent,\n        SemanticFilterComponent, SemanticFilterDialog,\n        ServiceTypeFilterComponent,\n        SimilarityFilterComponent,\n        ThemeFilterComponent,\n        TopicFilterComponent,\n        TypeFilterComponent,\n        ModifiedFilterComponent\n    ],\n    providers: [\n        AppAuthService,\n        ErrorResolver,\n        ItemResolver,\n        NewItemResolver,\n        VersionResolver,\n        GeoPlatformErrorService,\n        ItemHelper,\n        GeoPlatformSearchService,\n        // {\n        //     provide: RPMStatsService,\n        //     useFactory: RPMStatsServiceFactory,\n        //     deps: [ HttpClient ]\n        // },\n        {\n            provide: RPMService,\n            useValue: RPMServiceFactory()\n        },\n        {\n            provide: TrackingService,\n            useFactory: TrackingServiceFactory,\n            deps: [ RPMService]\n        }\n    ],\n    entryComponents: [\n        ListSelectDialog,\n        MessageDialog\n    ]\n})\nexport class GeoPlatformCommonModule {}\n","\n/*\n    Version of the library exposed to consumers.\n    Long-term this value should be auto-set to be whatever is set in package.json\n */\nexport const GeoPlatformCommonVersion = \"1.0.0\";\n\n// import Polyfills from \"./shared/polyfills\";\n// Polyfills();\n\nexport const DefaultSortOptions = [\n    { value: \"_score,desc\",     label: \"Relevance\"  },\n    { value: \"modified,desc\",   label: \"Most Recently Modified\"  },\n    { value: \"modified,asc\",    label: \"Least Recently Modified\" },\n    { value: \"label,asc\",       label: \"Title [A-Z]\" },\n    { value: \"label,desc\",      label: \"Title [Z-A]\" },\n    { value: \"reliability,asc\", label: \"Reliability\" }\n];\n\nexport * from './auth';\nexport * from './dialogs';\nexport * from './directives';\nexport * from './components';\nexport * from './logger';\nexport * from './error.service';\nexport * from './error';\nexport * from './event';\nexport * from './item-factory';\nexport * from './item-helper';\nexport * from './map-types';\nexport * from './pipes';\nexport * from './resolvers';\nexport * from './search';\nexport * from './module';\nexport * from './tracking.factory';\n","export const MapTypes = {\n    GeoPlatform : { label: \"GeoPlatform Map\", uri: 'http://www.geoplatform.gov/ont/openmap/GeoplatformMap' },\n    AGOL        : { label: \"AGOL Web Map\",    uri: 'http://www.geoplatform.gov/ont/openmap/AGOLMap'        },\n    WMS         : { label: \"WMS Map\",         uri: \"http://www.geoplatform.gov/ont/openmap/WMSMap\"         },\n    MapBox      : { label: \"Map Box Map\",     uri: 'http://www.geoplatform.gov/ont/openmap/MapBoxMap'      }\n};\n"]}