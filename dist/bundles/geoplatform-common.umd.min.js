!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("@geoplatform/client"),require("@geoplatform/rpm/src/iRPMService"),require("@geoplatform/oauth-ng/angular"),require("@angular/material/dialog"),require("rxjs/operators"),require("@angular/platform-browser"),require("@angular/router"),require("@angular/common"),require("@angular/forms"),require("@angular/material"),require("@ng-bootstrap/ng-bootstrap"),require("@geoplatform/rpm/dist/js/geoplatform.rpm.browser.js")):"function"==typeof define&&define.amd?define("@geoplatform/common",["exports","@angular/core","rxjs","@geoplatform/client","@geoplatform/rpm/src/iRPMService","@geoplatform/oauth-ng/angular","@angular/material/dialog","rxjs/operators","@angular/platform-browser","@angular/router","@angular/common","@angular/forms","@angular/material","@ng-bootstrap/ng-bootstrap","@geoplatform/rpm/dist/js/geoplatform.rpm.browser.js"],t):t(((e=e||self).geoplatform=e.geoplatform||{},e.geoplatform.common={}),e.ng.core,e.rxjs,e.geoplatform.client,e.RPMService,e.geoplatform["oauth-ng"],e.ng.material.dialog,e.rxjs.operators,e.ng.platformBrowser,e.ng.router,e.ng.common,e.ng.forms,e.ng.material,e.ngBootstrap,e.geoplatform.rpm)}(this,(function(e,t,n,i,r,o,a,s,l,u,c,p,g,d,m){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function h(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function y(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function b(e,t){return function(n,i){t(n,i,e)}}var v=function(){function e(e){this.authService=e}return e.prototype.ngOnInit=function(){this.init()},e.prototype.ngOnDestroy=function(){this.destroy()},e.prototype.init=function(){var e=this,t={next:function(t){console.log("AuthenticatedComponent : User changed to "+(t?t.username:"null")),e.user=t,e.onUserChange(e.user)},error:function(e){console.log("Unable to get authenticated user info: "+e.message)},complete:function(){}};this.gpAuthSubscription=this.authService.subscribe(t)},e.prototype.destroy=function(){this.gpAuthSubscription&&(this.gpAuthSubscription.unsubscribe(),this.gpAuthSubscription=null),this.user=null,this.authService=null},e.prototype.isAuthenticated=function(){return!!this.user},e.prototype.getUser=function(){return this.user},e.prototype.getAuthToken=function(){return this.authService.getToken()},e.prototype.checkAuth=function(){return this.authService.check()},e.prototype.canUserEdit=function(e){return!!this.user&&(!!this.user.isAuthorized("gp_editor")||this.isAuthorOf(e))},e.prototype.isAuthorOf=function(e){return!(!this.user||!e)&&(e.createdBy&&e.createdBy===this.user.username)},e.prototype.onUserChange=function(e){},e}(),I=["AUTH_TYPE","IDP_BASE_URL","APP_BASE_URL","ALLOW_SSO_LOGIN","APP_ID","ALLOW_IFRAME_LOGIN","FORCE_LOGIN","CALLBACK","LOGIN_URL","LOGOUT_URL","ALLOW_DEV_EDITS"],T=null;function C(e){if(T)return T;var t={},n=window.GeoPlatform;return n&&n.config&&n.config.auth?t=n.config.auth:(t.APP_BASE_URL=e.wpUrl||"",I.forEach((function(n){var i=e[n];void 0!==i&&((~n.indexOf("ALLOW")||~n.indexOf("FORCE"))&&(i=!0===i||"true"===i),t[n]=i)}))),T=o.ngGpoauthFactory(t)}var S=function(){function e(e){this.observers={},this.authService=C(i.Config),this.rpm=e,this.init()}return e.prototype.init=function(){var e=this;if(this.user$=new n.Subject,this.authService){var t=this.authService.getMessenger().raw();this.gpAuthSubscription=t.subscribe((function(t){switch(t.name){case"userAuthenticated":e.onUserChange(t.user);break;case"userSignOut":e.onUserChange(null)}})),this.authService.getUser().then((function(t){e.onUserChange(t)}))}},e.prototype.onUserChange=function(e){console.log("AuthService.onUserChange() : User is "+(e?e.username:"N/A")),this.user=e,this.user$.next(e)},e.prototype.getMessenger=function(){return this.authService?this.authService.getMessenger().raw():null},e.prototype.isAuthenticated=function(){return!!this.user},e.prototype.getUser=function(){return this.user},e.prototype.getToken=function(){return this.authService?this.authService.getJWT():null},e.prototype.check=function(){var e=this;return this.authService?this.authService.checkWithClient().then((function(t){return e.authService.getUser()})).then((function(t){return setTimeout((function(){e.onUserChange(t)}),100),t})):Promise.resolve(null)},e.prototype.login=function(){this.authService.login()},e.prototype.logout=function(){this.authService.logout()},e.prototype.subscribe=function(e){return this.user$.subscribe(e)},e.prototype.dispose=function(){this.gpAuthSubscription&&(this.gpAuthSubscription.unsubscribe(),this.gpAuthSubscription=null),this.user=null,this.user$=null,this.observers=null,this.authService=null},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:[r.RPMService]}]}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r.RPMService))},token:e,providedIn:"root"}),e=y([t.Injectable({providedIn:"root"}),b(0,t.Inject(r.RPMService))],e)}(),x=function(e){function n(t){var n=e.call(this,t)||this;return n.idpBaseUrl=i.Config.IDP_BASE_URL||"https://accounts.geoplatform.gov",n.user=null,n}return h(n,e),n.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this)},n.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},n.prototype.onUserChange=function(t){e.prototype.onUserChange.call(this,t),console.log("LoginButton.onUserChange() : User is "+(t?t.username:"null")),this.user=t},n.prototype.login=function(){this.authService.login()},n.prototype.logout=function(){this.authService.logout()},n.ctorParameters=function(){return[{type:S}]},n=y([t.Component({selector:"gp-login-button",template:'\n    <div class="btn-account btn-group">\n        \x3c!-- not logged in yet --\x3e\n        <a class="btn-login btn btn-link" (click)="login()" *ngIf="!user">Sign In</a>\n\n        \x3c!-- logged in --\x3e\n        <button type="button" class="btn-login btn btn-link dropdown-toggle" data-toggle="dropdown"\n            aria-expanded="false" *ngIf="user">\n            <span class="fas fa-user"></span>\n            <span class="d-xs-none">{{user?.name}}</span>\n            <span class="caret"></span>\n        </button>\n        <div class="dropdown-menu dropdown-menu-right" role="menu" *ngIf="user">\n            <div class="o-account-details">\n                <div class="o-account-details__avatar">\n                    <span class="fas fa-user"></span>\n                </div>\n                <div class="flex-1">\n                    <div class="a-heading">\n                        {{user?.name}}\n                        <small><em>({{user?.username}})</em></small>\n                    </div>\n                    <div class="u-text--sm">{{user?.email}}</div>\n                    <div class="u-text--sm">{{user?.org}}</div>\n                </div>\n            </div>\n            <div class="d-flex flex-justify-around u-mg-top--sm">\n                <a class="btn btn-sm btn-link" target="_blank" href="{{idpBaseUrl}}/profile">\n                    <span class="fas fa-pencil-alt"></span> Edit Profile\n                </a>\n                <a class="btn btn-sm btn-link" target="_blank" href="{{idpBaseUrl}}/updatepw">\n                    <span class="fas fa-key"></span> Change Password\n                </a>\n            </div>\n            <div class="u-mg-top--sm">\n                <a class="btn-logout btn btn-light btn-block" (click)="logout()">\n                    <span class="fas fa-power-off"></span> Sign Out\n                </a>\n            </div>\n        </div>\n    </div>\n    ',styles:["\n        .btn-login.btn-link {\n            padding: .375em .75em;\n            border-right: none;\n            margin: 0 0.5em;\n            font-weight: 700;\n        }\n        .btn-login.btn-link:hover {\n            background-color: #fff;\n            text-decoration: none;\n            color: #333;\n        }\n        .o-account-details {\n            display: flex;\n            justify-content: space-between;\n            align-items: stretch;\n            margin-top: -0.5em;\n            padding: 1em;\n            background: #185b8a;\n            color: #fff;\n        }\n        .o-account-details__avatar {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            font-size: 6em;\n            margin-right: 0.25em;\n            padding-top: 10px;\n            width: 100px;\n            height: 100px;\n            overflow: hidden;\n            background: #fff;\n            color: #777;\n            border-radius: 100%;\n        }\n        .dropdown-menu .btn.btn-link {\n            display: inline-block;\n            padding: 0.375rem 0.75rem;\n            border-right: none;\n        }\n        .dropdown-menu .btn.btn-link:after {\n            content: '';\n        }\n        .btn.btn-logout {\n            padding: 0.375rem 0.75rem;\n            margin-bottom: -0.5em;\n        }\n        "]})],n)}(v),w=function(){function e(e){this.authService=e,this.showLoginModal=!1,this.forceLogin=i.Config.FORCE_LOGIN}return e.prototype.ngOnInit=function(){var e=this;this.authService&&this.authService.getMessenger().subscribe((function(t){switch(t.name){case"auth:requireLogin":e.showLoginModal=!0;break;case"userAuthenticated":case"iframe:userAuthenticated":e.showLoginModal=!1,e.authService.onUserChange(t.user)}}))},e.prototype.ngOnDestroy=function(){this.showLoginModal=!1},e.prototype.cancel=function(){this.showLoginModal=!1},e.ctorParameters=function(){return[{type:S}]},e=y([t.Component({selector:"gp-login-modal",template:'<div class="gpLoginCover" *ngIf="showLoginModal">\n    <button class="btn btn-danger gpLoginCancelIframe pull-right" *ngIf="!forceLogin" (click)="cancel()">\n        <span class="fas fa-times-circle"></span> Cancel\n    </button>\n    <div class="gpLoginWindow" *ngIf="showLoginModal">\n        <iframe id="gpLoginIFrame" src="/login?redirect_url=${encodeURIComponent(`${window.location.origin}/auth/loading?cachebuster=${(new Date()).getTime()}`)}&cachebuster=${(new Date()).getTime()}"></iframe>\n    </div>\n</div>\n',styles:["\n        .gpLoginCover {\n            position: absolute;\n            top: 0;\n            left: 0;\n            bottom: 0;\n            right: 0;\n            background: rgba(0,0,0,0.6);\n            z-index: 5000;\n            width: 100vw;\n            height: 100vh;\n        }\n\n        .gpLoginCancelIframe {\n          z-index: 5001;\n          position: absolute;\n          right: 0px;\n        }\n\n        .gpLoginWindow {\n          top: 100px;\n          height: 60%;\n          width: 75%;\n          margin: 0 auto;\n          position: relative;\n          z-index: 5001;\n        \tborder: 5px solid #cccccc;\n          border-radius: 10px;\n        }\n\n        .gpLoginWindow iframe {\n          width: 100%;\n          height: 100%\n        }\n\n        .gpLoginWindow .btn-cancel {\n          color: white;\n          background-color: red;\n        }\n\n        .gpLoginWindow .btn {\n          display: inline-block;\n          padding: 6px 12px;\n          margin-bottom: 0;\n          font-size: 14px;\n          font-weight: 400;\n          line-height: 1.42857143;\n          text-align: center;\n          white-space: nowrap;\n          vertical-align: middle;\n          -ms-touch-action: manipulation;\n          touch-action: manipulation;\n          cursor: pointer;\n          -webkit-user-select: none;\n          -moz-user-select: none;\n          -ms-user-select: none;\n          user-select: none;\n          background-image: none;\n          border: 1px solid transparent;\n          border-radius: 4px;\n        }\n    "]})],e)}(),A=function(){function e(e,t){var i=this;this.dialogRef=e,this.data=t,this.currentPage=0,this.totalSuggested=0,this.subject=new n.Subject,this.query=t.query.clone().page(this.currentPage).pageSize(12),this.subject.pipe(s.debounceTime(300),s.distinctUntilChanged()).subscribe((function(e){i.filterValues(e)}))}return e.prototype.onNoClick=function(){this.dialogRef.close()},e.prototype.onTermChange=function(e,t){!0===t?this.filterValues(e):this.subject.next(e)},e.prototype.filterValues=function(e){var t=this;if(this.termQuery=e,!e)return this.suggested=[],void(this.totalSuggested=0);this.query.q(e),this.isLoading=!0,this.data.service.search(this.query).then((function(e){var n=e.results;t.suggested=n,t.totalSuggested=e.totalResults})).catch((function(e){})).finally((function(){t.isLoading=!1}))},e.prototype.addValue=function(e){this.isSelected(e)?this.removeValue(e):this.data.selected.push(e)},e.prototype.removeValue=function(e){var t=-1;this.data.selected.forEach((function(n,i){n.id===e.id&&(t=i)})),t>=0&&this.data.selected.splice(t,1)},e.prototype.isSelected=function(e){return this.data.selected.length>0&&!!this.data.selected.find((function(t){return t.id===e.id}))},e.prototype.onPageChange=function(e){this.currentPage!==e-1&&(this.query.page(e-1),this.filterValues(this.termQuery))},e.prototype.getSubHeading=function(e){var t=e[this.data.subHeading];return this.getLabelFrom(t)},e.prototype.getLabelFrom=function(e){var t=this;return null==e?"":Array.isArray(e)?e.map((function(e){return t.getLabelFrom(e)})).join(", "):"object"==typeof e&&(e.label||e.title||e.prefLabel)?e.label||e.title||e.prefLabel:""},e.ctorParameters=function(){return[{type:a.MatDialogRef},{type:void 0,decorators:[{type:t.Inject,args:[a.MAT_DIALOG_DATA]}]}]},e=y([t.Component({selector:"gp-list-select-dialog",template:'<h5 mat-dialog-title>Find Items to Select</h5>\n<div mat-dialog-content>\n    <mat-form-field appearance="outline">\n        <mat-label>\n            <mat-icon><span class="fas fa-search"></span></mat-icon>\n            Search\n        </mat-label>\n        <input matInput\n            [(ngModel)]="termQuery" (ngModelChange)="onTermChange($event)"\n            placeholder="Enter keywords to find recommended values">\n        <span matSuffix *ngIf="termQuery?.length" (click)="onTermChange(null, true)"\n            class="fas fa-times t-fg--gray-md">\n        </span>\n    </mat-form-field>\n\n    <div class="d-flex flex-justify-between flex-align-stretch">\n\n        <div style="flex: 1 0 49%; margin-right: 1%;">\n            <div class="a-heading">\n                Recommendations ({{totalSuggested||0}})\n                <span *ngIf="isLoading" class="fas fa-spinner fa-spin"></span>\n            </div>\n            <div class="m-list-section">\n                <div class="list-group">\n                    <em *ngIf="!suggested?.length">Enter keywords above to receive suggested values to use.</em>\n                    <div *ngFor="let item of suggested" class="list-group-item"\n                        (click)="addValue(item)" [ngClass]="{\'active\':isSelected(item)}">\n                        <a>\n                            <span gpIcon [item]="item"></span>\n                            {{item.label||item.title||item.prefLabel}}\n                        </a>\n                        <div *ngIf="data.subHeading" class="u-text--sm t-fg--gray-md">\n                            {{getSubHeading(item)}}\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="u-text--sm  u-mg-top--md" *ngIf="totalSuggested>0">\n                <ngb-pagination [collectionSize]="totalSuggested"\n                    [pageSize]="12" [maxSize]="2" [size]="\'sm\'"\n                    [rotate]="true" [(page)]="currentPage"\n                    (pageChange)="onPageChange($event)">\n                </ngb-pagination>\n            </div>\n        </div>\n        <div style="flex: 1 0 50%">\n            <div class="a-heading">Selected ({{data?.selected?.length||0}})</div>\n            <div class="m-list-section">\n                <div class="list-group">\n                    <em *ngIf="!data.selected?.length">No values selected.</em>\n                    <div *ngFor="let item of data?.selected" class="list-group-item">\n                        <span class="fas fa-times t-fg--danger" (click)="removeValue(item)"></span>&nbsp;\n                        <a>\n                            <span gpIcon [item]="item"></span>\n                            {{item.label||item.title||item.prefLabel||"Untitled Item"}}\n                        </a>\n                        <div *ngIf="data.subHeading" class="u-text--sm t-fg--gray-md">\n                            {{getSubHeading(item)}}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n</div>\n<div mat-dialog-actions class="d-flex flex-justify-end flex-align-center">\n    <button type="button" mat-flat-button (click)="onNoClick()">Cancel</button>\n    <button type="button" mat-flat-button color="primary" [mat-dialog-close]="data.selected">Ok</button>\n</div>\n',styles:[":host .mat-form-field{width:100%}"]}),b(1,t.Inject(a.MAT_DIALOG_DATA))],e)}(),L=function(){function e(e,t){switch(this.dialogRef=e,this.data=t,t.type){case"error":this.className="danger";break;case"warn":this.className="warning";break;case"info":this.className="info"}}return e.prototype.close=function(){this.dialogRef.close()},e.prototype.getIconClass=function(){switch(this.data.type){case"error":return"fas fa-exclamation-circle";case"warn":return"fas fa-exclamation-triangle";case"info":return"fas fa-info-circle"}return""},e.ctorParameters=function(){return[{type:a.MatDialogRef},{type:void 0,decorators:[{type:t.Inject,args:[a.MAT_DIALOG_DATA]}]}]},y([t.HostBinding("class")],e.prototype,"className",void 0),e=y([t.Component({selector:"gp-message-dialog",template:'<div class="a-heading" mat-dialog-title>\n    <span [attr.class]="getIconClass()"></span>\n    {{data.label || "Message"}}\n</div>\n<div mat-dialog-content>\n    {{data.message}}\n</div>\n<div mat-dialog-actions class="d-flex flex-justify-end flex-align-center">\n    <button type="button" mat-flat-button (click)="close()">Dismiss</button>\n</div>\n',styles:[":host.danger .mat-dialog-title{color:#d53c37}:host.warning .mat-dialog-title{color:#b35d29}:host.info .mat-dialog-title{color:#007fa4}"]}),b(1,t.Inject(a.MAT_DIALOG_DATA))],e)}(),k=function(){function e(e){this.el=e,this.themed=!0}return e.prototype.ngOnInit=function(){if(this.item){var e=this.item.type.toLowerCase().replace(/^[a-z]+\:/,"");e="icon-"+e,this.themed&&(e+=" is-themed"),this.el.nativeElement.className=e}},e.ctorParameters=function(){return[{type:t.ElementRef}]},y([t.Input()],e.prototype,"item",void 0),y([t.Input()],e.prototype,"themed",void 0),e=y([t.Directive({selector:"[gpIcon]"})],e)}(),O=[i.ItemTypes.DATASET,i.ItemTypes.SERVICE,i.ItemTypes.LAYER,i.ItemTypes.MAP,i.ItemTypes.GALLERY,i.ItemTypes.COMMUNITY,i.ItemTypes.APPLICATION,i.ItemTypes.TOPIC,i.ItemTypes.WEBSITE],P=function(){function e(){}return e.isAsset=function(e){if(!e)return!1;var t=null;return"string"==typeof e?t=e:e.type&&(t=e.type),t&&O.indexOf(t)>=0},e.getIcon=function(e){var t="dataset";switch(e.type){case i.ItemTypes.CONTACT:t="vcard";break;default:t=e.type.replace(/^[a-z]+\:/i,"").toLowerCase()}return"icon-"+t},e.getLabel=function(e){if(!e||!e.type)return"Unknown type";switch(e.type){case i.ItemTypes.ORGANIZATION:return e.label||e.name||"Un-titled resource";case i.ItemTypes.CONCEPT:case i.ItemTypes.CONCEPT_SCHEME:return e.label||e.prefLabel||"Un-titled resource";case i.ItemTypes.CONTACT:var t=e.fullName||"",n=e.positionTitle||"",r=e.orgName||"",o=t+(t.length?" - ":"")+n+(n.length?" - ":"")+r;return o.length||(o=e.email||"Untitled Contact"),o;default:return e.label||e.title||"Un-titled resource"}},e.getTypeLabel=function(e){if(!e)return"Unknown Resource Type";var t=null;if("string"==typeof e)t=e;else{if(!e.type)return null;t=e.type}switch(t){case i.ItemTypes.DATASET:case i.ItemTypes.SERVICE:case i.ItemTypes.ORGANIZATION:case i.ItemTypes.CONCEPT:return t.replace(/^[a-z]+\:/i,"");case i.ItemTypes.CONCEPT_SCHEME:return"Concept Scheme";case i.ItemTypes.WEBSITE:return"Website";case i.ItemTypes.CONTACT:return"Contact";default:return t}},e.getTypeKey=function(e){if(!e)return null;var t=null;if("string"==typeof e)t=e;else{if(!e.type)return null;t=e.type}switch(t){case i.ItemTypes.GALLERY:return"galleries";case i.ItemTypes.COMMUNITY:return"communities";case i.ItemTypes.CONTACT:return"contacts";default:return t.replace(/^[a-z]+\:/i,"").toLowerCase()+"s"}},e.determineIconType=function(e){return"/assets/icons/"+e.replace(/^[a-z]+\:/i,"").toLowerCase()+".svg"},e.getItemDetailsUrl=function(e){return e&&e.type&&e.id?i.Config.portalUrl+"/resources/"+this.getTypeKey(e)+"/"+e.id:null},e=y([t.Injectable()],e)}(),M=function(){function e(){this.external=!1}return e.prototype.ngOnInit=function(){},e.prototype.hasIcon=function(){return!0},e.prototype.getIcon=function(){return P.getIcon(this.item)},e.prototype.getLabel=function(){return P.getLabel(this.item)},e.prototype.getType=function(){return P.getTypeKey(this.item)},e.prototype.getIconClass=function(){var e=P.getTypeLabel(this.item);return"Contact"===e&&(e="vcard"),"Product"===e&&(e="imageproduct"),"icon-"+e.toLowerCase()},y([t.Input()],e.prototype,"item",void 0),y([t.Input()],e.prototype,"icon",void 0),y([t.Input()],e.prototype,"external",void 0),e=y([t.Component({selector:"gp-resource-link",template:'<a routerLink="/view/{{item?.id}}">\n    <span *ngIf="hasIcon()" class="a-icon {{getIconClass()}}"></span>\n    {{getLabel()}}\n</a>\n',styles:[""]})],e)}(),E=function(){function e(){this.onEvent=new t.EventEmitter}return e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(e){},e.prototype.clear=function(){this.onEvent.emit({name:"selected:clear"})},e.prototype.remove=function(e){},y([t.Input()],e.prototype,"selected",void 0),y([t.Output()],e.prototype,"onEvent",void 0),e=y([t.Component({selector:"gp-selected-items",template:'<div class="o-selected-items">\n\n    <div class="list-group list-group-sm u-text--sm">\n\n        <div *ngIf="!selected || !selected.length" class="list-group-item">\n            <div class="t-fg--gray-md t-text--italic">Nothing selected</div>\n        </div>\n\n        <div *ngFor="let item of selected"\n            class="list-group-item d-flex flex-justify-between flex-align-center">\n            <div class="flex-1">\n                <span class="icon-{{item.type.toLowerCase()}} is-themed"></span>\n                {{item.label}}\n            </div>\n            <button type="button" class="btn btn-link u-mg-left--sm" (click)="remove(item)">\n                <span class="fas fa-times-circle t-fg--danger"></span>\n            </button>\n        </div>\n\n    </div>\n\n    <div class="list-group list-group-sm u-text--sm u-mg-top--md">\n\n        \x3c!-- <div class="list-group-item d-flex flex-justify-between flex-align-center"\n            [ngClass]="{\'is-faded\':!isAuthenticated()||!selected?.length}">\n\n            <div class="flex-1">\n                <span class="icon-gallery"></span>\n                Add Selected to a Gallery\n            </div>\n            <button type="button" class="btn btn-link"\n                (click))="openDialog()"\n                [disabled]="!isAuthenticated()">\n                <span class="gpicons plus-circle t-fg--success"></span>\n            </button>\n        </div> --\x3e\n\n        <div class="list-group-item d-flex flex-justify-between flex-align-center"\n            [ngClass]="{\'is-faded\':!selected?.length}"\n            (click)="clear()">\n            <div class="flex-1">Clear Selections</div>\n            <button type="button" class="btn btn-link">\n                <span class="fas fa-times-circle t-fg--danger"></span>\n            </button>\n        </div>\n    </div>\n\n</div>\n',styles:[""]})],e)}(),U=function(){function e(){this.fallback="/assets/img-404.png"}return e.prototype.onImgError=function(){this.src=this.fallback},e.prototype.onImgLoad=function(){this.className="is-image-loaded"},y([t.Input()],e.prototype,"src",void 0),y([t.Input()],e.prototype,"fallback",void 0),y([t.HostBinding("class")],e.prototype,"className",void 0),e=y([t.Directive({selector:"img[fallback]",host:{"(error)":"onImgError()","(load)":"onImgLoad()","[src]":"src"}})],e)}(),j=function(){function e(e){this.sanitizer=e}return e.prototype.ngOnInit=function(){},e.prototype.getThumbnailUrl=function(){return this.item.thumbnail&&this.item.thumbnail.url?this.item.thumbnail.url:i.Config.ualUrl+"/api/items/"+this.item.id+"/thumbnail"},e.prototype.getBackgroundImage=function(){if(!this.item||!this.item.thumbnail)return this.getFallbackBackgroundImage();var e=this.item.thumbnail,t=e.mediaType||"image/png";if(e.contentData){var n=e.contentData;return this.sanitizer.bypassSecurityTrustStyle("url(data:"+t+";base64,"+n+")")}},e.prototype.getFallbackBackgroundImage=function(){return"url("+this.getFallbackUrl()+")"},e.prototype.isEmpty=function(){return!this.item||!this.item.thumbnail||!this.item.thumbnail.url&&!this.item.thumbnail.contentData},e.prototype.hasURL=function(){return this.item.thumbnail&&!!this.item.thumbnail.url},e.prototype.hasContentData=function(){return this.item.thumbnail&&!!this.item.thumbnail.contentData&&!this.item.thumbnail.url},e.prototype.getFallbackUrl=function(){return i.Config.ualUrl+"/api/items/"+this.item.id+"/thumbnail"},e.ctorParameters=function(){return[{type:l.DomSanitizer}]},y([t.Input()],e.prototype,"item",void 0),e=y([t.Component({selector:"gp-item-thumbnail",template:'<div class="m-thumbnail" style="position:relative">\n\n    \x3c!-- fallback is to use SVG for item type as its thumbnail --\x3e\n    <div *ngIf="isEmpty()" class="is-16x9 is-fallback">\n        <div\n            [style.background-size]="\'contain\'"\n            [style.background-repeat]="\'no-repeat\'"\n            [style.background-position]="\'50% 0\'"\n            [style.background-image]="getFallbackBackgroundImage()">\n        </div>\n    </div>\n\n    \x3c!-- if there is a thumbnail with URL --\x3e\n    <img *ngIf="hasURL()" src="{{item.thumbnail.url}}" fallback="{{getFallbackUrl()}}">\n\n    \x3c!-- if there is a thumbnail with base64 data --\x3e\n    <div *ngIf="hasContentData()" class="is-16x9">\n        <img\n            [style.background-size]="\'contain\'"\n            [style.background-repeat]="\'no-repeat\'"\n            [style.background-image]="getBackgroundImage()">\n    </div>\n\n</div>\n',styles:[".m-thumbnail img{max-width:100%}"]})],e)}(),R=function(e){function t(t,n,i,r){var o=e.call(this,t)||this;return o.label=n,o.code=i,o.item=r,o}return h(t,e),Object.defineProperty(t.prototype,"label",{get:function(){return this._label},set:function(e){this._label=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this._code},set:function(e){this._code=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._item},set:function(e){this._item=e},enumerable:!0,configurable:!0}),t.from=function(e){if(e instanceof t)return e;var n=new t(e.message);return n.label="An error occurred",n.code=500,n},t}(Error),_=function(){function e(){this.updateSubject=new n.BehaviorSubject(null),this.error$=this.updateSubject.asObservable()}return e.prototype.setError=function(e){var t=R.from(e);this.updateSubject.next(t)},e=y([t.Injectable()],e)}(),N={PUBLIC:"public",PRIVATE:"private"},D={SUBMITTED:"submitted"};function B(e,t){return Object.assign({type:e,uri:null,label:"New Item",description:"This item needs a description",resourceTypes:[],createdBy:null,lastModifiedBy:null},t||{})}function G(e,t){return B(e,Object.assign({keywords:[],alternateTitles:[],purpose:null,themes:[],contacts:[],publishers:[],contributors:[],distributions:[],classifiers:{},landingPage:null,status:D.SUBMITTED,visibility:N.PUBLIC,identifiers:[],extent:{minx:-179,miny:-89,maxx:179,maxy:89},temporal:{startDate:null,endDate:null},statistics:{numViews:0,numLikes:0},usedBy:[],related:[],rights:[]},t||{}))}function F(e,t){e&&t&&(null!==e[t]&&void 0!==e[t]&&void 0!==e[t]||(e[t]=[]))}function z(e,t){e&&t&&void 0===e[t]&&(e[t]=null)}var V,q=function(){function e(){}return e.create=function(e){switch(e){case i.ItemTypes.MAP:return G(i.ItemTypes.MAP,{layers:[],baseLayer:null,annotations:{},thumbnail:{label:null,url:null,contentData:null,width:0,height:0}});case i.ItemTypes.LAYER:return n=t?[t]:[],G(i.ItemTypes.LAYER,{subLayers:[],parentLayer:null,services:n,layerName:null,layerType:null,legend:null});case i.ItemTypes.SERVICE:return G(i.ItemTypes.SERVICE,{datasets:[],serviceType:null,href:null});case i.ItemTypes.DATASET:return G(i.ItemTypes.DATASET,{services:[]});case i.ItemTypes.GALLERY:return G(i.ItemTypes.GALLERY,{items:[]});case i.ItemTypes.COMMUNITY:return G(i.ItemTypes.COMMUNITY);case i.ItemTypes.CONCEPT:return B(i.ItemTypes.CONCEPT,{scheme:null});case i.ItemTypes.CONCEPT_SCHEME:return B(i.ItemTypes.CONCEPT_SCHEME);case i.ItemTypes.ORGANIZATION:return B(i.ItemTypes.ORGANIZATION,{subOrgOf:null});case i.ItemTypes.CONTACT:return B(i.ItemTypes.CONTACT,{fullName:null,email:null,tel:null,fax:null,address:{street1:null,street2:null,city:null,state:null,zip:null}});default:return null}var t,n},e.fix=function(e){F(e,"resourceTypes"),P.isAsset(e)&&(F(e,"keywords"),F(e,"alternateTitles"),F(e,"themes"),F(e,"contacts"),F(e,"publishers"),F(e,"contributors"),F(e,"distributions"),F(e,"identifiers"),F(e,"usedBy"),F(e,"related"),F(e,"accessRights"),z(e,"purpose"),z(e,"landingPage"),z(e,"status"),z(e,"visibility"),e.temporal||(e.temporal={startDate:null,endDate:null}),e.extent||(e.extent={minx:-179,miny:-89,maxx:179,maxy:89}))},e}(),W=function(){function e(){}return e.prototype.transform=function(e,t,n){var i=isNaN(n)||n>e.length?e.length:n;return e.slice(0,i).map((function(e){return e[t]})).join(" ")},e=y([t.Pipe({name:"arrayedItems"})],e)}(),H=function(){function e(){}return e.prototype.transform=function(e,t,n){if(e&&e.length>t){var i=isNaN(n)?0:n;return i>0&&(t+=i),console.log("Slicing from "+i+" to "+t),e.slice(i,t)}return e},e=y([t.Pipe({name:"limitTo"})],e)}(),$=function(){function e(){}return e.prototype.transform=function(e,t){return e.sort((function(e,n){return e[t]>n[t]?-1:1}))},e=y([t.Pipe({name:"sortBy"})],e)}(),Y=function(){function e(){}return e.prototype.transform=function(e){if(!e||"string"!=typeof e||0===e.length)return e;var t=e,n=e.indexOf(":");return~n&&(t=e.substring(n+1)),"VCard"===t&&(t="Contact"),t},e=y([t.Pipe({name:"friendlyType"})],e)}(),Z=function(){function e(){}return e.prototype.transform=function(e){if(!e||"string"!=typeof e||!e.length)return"Untitled";var t=e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").trim();return t.charAt(0).toUpperCase()+t.slice(1)},e=y([t.Pipe({name:"fixLabel"})],e)}(),K=function(){function e(e,t){this.service=e,this.trackingService=t}return e.prototype.resolve=function(e,t){var r=this,o=e.paramMap.get("id"),a={},s=e.paramMap.get("version");return s&&(a.version=s),this.service.get(o,a).then((function(e){if(r.trackingService){var t=i.TrackingEventFactory(i.TrackingTypes.VIEWED,e);r.trackingService.logEvent(t)}return e})).catch((function(e){return n.of(e)}))},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:[i.ItemService]}]},{type:void 0,decorators:[{type:t.Inject,args:[i.TrackingService]}]}]},e=y([t.Injectable(),b(0,t.Inject(i.ItemService)),b(1,t.Inject(i.TrackingService))],e)}(),Q=function(){function e(){}return e.prototype.resolve=function(e,t){var n=e.paramMap.get("version");return Promise.resolve(n||null)},e=y([t.Injectable()],e)}(),J=function(){function e(e){this.router=e}return e.prototype.resolve=function(e,t){var i=e.params.type,r=q.create(i);if(r)return n.of(r);new R("Type "+i+" is unsupported","Unsupported Type",400);return this.router.navigateByUrl("error",{skipLocationChange:!1}),n.empty()},e.ctorParameters=function(){return[{type:u.Router}]},e=y([t.Injectable()],e)}(),X=function(){function e(e){this.router=e}return e.prototype.resolve=function(e,t){var i=e.params.type,r="An error has occurred";"unsupported"===i?r="Type "+i+" is not supported":"404"===i&&(r="Item not found");var o=new Error(r);return n.of(o)},e.ctorParameters=function(){return[{type:u.Router}]},e=y([t.Injectable()],e)}();function ee(e){return V||(V=new i.TrackingService({provider:e})),V}var te=m.RPMServiceFactory(),ne=function(){function e(){}return e=y([t.NgModule({imports:[u.RouterModule,c.CommonModule,p.FormsModule,g.MatInputModule,g.MatButtonModule,g.MatIconModule,g.MatDialogModule,d.NgbModule],exports:[A,L,U,j,E,M,x,w,W,H,$,Y,Z,k],declarations:[A,L,U,j,E,M,x,w,W,H,$,Y,Z,k],providers:[S,X,K,J,Q,_,P,{provide:r.RPMService,useValue:te},{provide:i.TrackingService,useFactory:ee,deps:[r.RPMService]}],entryComponents:[A,L]})],e)}();e.AppAuthService=S,e.ArrayedItemsPipe=W,e.AuthenticatedComponent=v,e.ErrorResolver=X,e.FixLabelPipe=Z,e.FriendlyTypePipe=Y,e.GeoPlatformCommonModule=ne,e.GeoPlatformCommonVersion="1.0.0",e.GeoPlatformError=R,e.GeoPlatformErrorService=_,e.GeoPlatformIconDirective=k,e.ImageFallbackDirective=U,e.ItemFactory=q,e.ItemHelper=P,e.ItemResolver=K,e.LimitToPipe=H,e.ListSelectDialog=A,e.LoginButtonComponent=x,e.LoginModalComponent=w,e.MapTypes={GeoPlatform:{label:"GeoPlatform Map",uri:"http://www.geoplatform.gov/ont/openmap/GeoplatformMap"},AGOL:{label:"AGOL Web Map",uri:"http://www.geoplatform.gov/ont/openmap/AGOLMap"},WMS:{label:"WMS Map",uri:"http://www.geoplatform.gov/ont/openmap/WMSMap"},MapBox:{label:"Map Box Map",uri:"http://www.geoplatform.gov/ont/openmap/MapBoxMap"}},e.MessageDialog=L,e.NewItemResolver=J,e.ResourceLinkComponent=M,e.SelectedItemsComponent=E,e.SortByPipe=$,e.ThumbnailComponent=j,e.TrackingServiceFactory=ee,e.VersionResolver=Q,e.authServiceFactory=C,e.ɵ0=te,e.ɵa=A,e.ɵb=L,e.ɵc=U,e.ɵd=j,e.ɵe=E,e.ɵf=M,e.ɵg=x,e.ɵh=w,e.ɵi=k,e.ɵj=S,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=geoplatform-common.umd.min.js.map