import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { Config, ItemTypes } from "@geoplatform/client";
var ASSETS = [
    ItemTypes.DATASET, ItemTypes.SERVICE, ItemTypes.LAYER, ItemTypes.MAP,
    ItemTypes.GALLERY, ItemTypes.COMMUNITY, ItemTypes.APPLICATION, ItemTypes.TOPIC,
    ItemTypes.WEBSITE
];
var ItemHelper = /** @class */ (function () {
    function ItemHelper() {
    }
    /**
     * @param {any} item - either GP item or string type
     * @return {boolean}
     */
    ItemHelper.isAsset = function (item) {
        if (!item)
            return false;
        var type = null;
        if (typeof (item) === 'string')
            type = item;
        else if (item.type)
            type = item.type;
        return type && ASSETS.indexOf(type) >= 0;
    };
    /**
     * @param {any} item - either GP item or string type
     * @return {string} url of icon for the type
     */
    ItemHelper.getIcon = function (item) {
        var type = "dataset";
        switch (item.type) {
            case ItemTypes.CONTACT:
                type = 'vcard';
                break;
            default: type = item.type.replace(/^[a-z]+\:/i, '').toLowerCase();
        }
        return 'icon-' + type;
    };
    /**
     * @param {any} item - either GP item
     * @return {string} label for the item
     */
    ItemHelper.getLabel = function (item) {
        if (!item || !item.type)
            return 'Unknown type';
        var type = item.type;
        switch (type) {
            case ItemTypes.ORGANIZATION:
                // case ItemTypes.PERSON :
                return item.label || item.name || "Un-titled resource";
            case ItemTypes.CONCEPT:
            case ItemTypes.CONCEPT_SCHEME:
                return item.label || item.prefLabel || "Un-titled resource";
            case ItemTypes.CONTACT:
                var fn = item.fullName || '';
                var pt = item.positionTitle || '';
                var on = item.orgName || '';
                var label = fn + (fn.length ? ' - ' : '') + pt + (pt.length ? ' - ' : '') + on;
                //if none of those fields have been provided, default to email or placeholder
                if (!label.length)
                    label = item.email || 'Untitled Contact';
                return label;
            default: return item.label || item.title || "Un-titled resource";
        }
    };
    /**
     * @param {any} item - either GP item or string type
     * @return {string} label for the item's type
     */
    ItemHelper.getTypeLabel = function (item) {
        if (!item)
            return 'Unknown Resource Type';
        var type = null;
        if (typeof (item) === 'string')
            type = item;
        else if (item.type)
            type = item.type;
        else
            return null;
        switch (type) {
            case ItemTypes.DATASET:
            case ItemTypes.SERVICE:
            // case ItemTypes.PERSON :
            case ItemTypes.ORGANIZATION:
            case ItemTypes.CONCEPT:
                return type.replace(/^[a-z]+\:/i, '');
            case ItemTypes.CONCEPT_SCHEME: return "Concept Scheme";
            case ItemTypes.WEBSITE: return "Website";
            case ItemTypes.CONTACT: return "Contact";
            default: return type; //remainder are unprefixed
        }
    };
    /**
     * @param {any} item - either GP item or string type
     * @return {string} key (plural) for the item's type
     */
    ItemHelper.getTypeKey = function (item) {
        if (!item)
            return null;
        var type = null;
        if (typeof (item) === 'string')
            type = item;
        else if (item.type)
            type = item.type;
        else
            return null;
        switch (type) {
            //special plurality
            case ItemTypes.GALLERY: return 'galleries';
            case ItemTypes.COMMUNITY: return 'communities';
            //different name
            case ItemTypes.CONTACT: return 'contacts'; //instead of "vcards"
            //remainder
            default: return type.replace(/^[a-z]+\:/i, '').toLowerCase() + 's';
        }
    };
    /**
     * @param {string} type - item type
     * @return {string} string path to the type's icon
     */
    ItemHelper.determineIconType = function (type) {
        var name = type.replace(/^[a-z]+\:/i, '').toLowerCase();
        return "/assets/icons/" + name + ".svg";
    };
    ItemHelper.getItemDetailsUrl = function (item) {
        if (!item || !item.type || !item.id)
            return null;
        return Config.portalUrl + '/resources/' + this.getTypeKey(item) + '/' + item.id;
    };
    ItemHelper = tslib_1.__decorate([
        Injectable()
    ], ItemHelper);
    return ItemHelper;
}());
export { ItemHelper };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXRlbS1oZWxwZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ2VvcGxhdGZvcm0vY29tbW9uLyIsInNvdXJjZXMiOlsiaXRlbS1oZWxwZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUV4RCxJQUFNLE1BQU0sR0FBRztJQUNYLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLE9BQU8sRUFBSSxTQUFTLENBQUMsS0FBSyxFQUFRLFNBQVMsQ0FBQyxHQUFHO0lBQzVFLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxLQUFLO0lBQzlFLFNBQVMsQ0FBQyxPQUFPO0NBQ3BCLENBQUM7QUFHRjtJQUVJO0lBQWdCLENBQUM7SUFFakI7OztPQUdHO0lBQ0ksa0JBQU8sR0FBZCxVQUFlLElBQVU7UUFDckIsSUFBRyxDQUFDLElBQUk7WUFBRSxPQUFPLEtBQUssQ0FBQztRQUN2QixJQUFJLElBQUksR0FBRyxJQUFJLENBQUM7UUFDaEIsSUFBRyxPQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssUUFBUTtZQUFHLElBQUksR0FBRyxJQUFjLENBQUM7YUFDaEQsSUFBRyxJQUFJLENBQUMsSUFBSTtZQUFFLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQ3BDLE9BQU8sSUFBSSxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzdDLENBQUM7SUFFRDs7O09BR0c7SUFDSSxrQkFBTyxHQUFkLFVBQWUsSUFBVTtRQUNyQixJQUFJLElBQUksR0FBRyxTQUFTLENBQUM7UUFDckIsUUFBTyxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ2QsS0FBSyxTQUFTLENBQUMsT0FBTztn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Q0FBQyxFQUFFO1lBQUUsT0FBTyxJQUFJLENBQUM7UUFFaEQsT0FBTyxNQUFNLENBQUMsU0FBUyxHQUFHLGFBQWEsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDO0lBQ3BGLENBQUM7SUE3SFEsVUFBVTtRQUR0QixVQUFVLEVBQUU7T0FDQSxVQUFVLENBK0h0QjtJQUFELGlCQUFDO0NBQUEsQUEvSEQsSUErSEM7U0EvSFksVUFBVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbmZpZywgSXRlbVR5cGVzIH0gZnJvbSBcIkBnZW9wbGF0Zm9ybS9jbGllbnRcIjtcblxuY29uc3QgQVNTRVRTID0gW1xuICAgIEl0ZW1UeXBlcy5EQVRBU0VULCBJdGVtVHlwZXMuU0VSVklDRSwgICBJdGVtVHlwZXMuTEFZRVIsICAgICAgIEl0ZW1UeXBlcy5NQVAsXG4gICAgSXRlbVR5cGVzLkdBTExFUlksIEl0ZW1UeXBlcy5DT01NVU5JVFksIEl0ZW1UeXBlcy5BUFBMSUNBVElPTiwgSXRlbVR5cGVzLlRPUElDLFxuICAgIEl0ZW1UeXBlcy5XRUJTSVRFXG5dO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgSXRlbUhlbHBlciB7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHsgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHthbnl9IGl0ZW0gLSBlaXRoZXIgR1AgaXRlbSBvciBzdHJpbmcgdHlwZVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgc3RhdGljIGlzQXNzZXQoaXRlbSA6IGFueSkge1xuICAgICAgICBpZighaXRlbSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBsZXQgdHlwZSA9IG51bGw7XG4gICAgICAgIGlmKHR5cGVvZihpdGVtKSA9PT0gJ3N0cmluZycpICB0eXBlID0gaXRlbSBhcyBzdHJpbmc7XG4gICAgICAgIGVsc2UgaWYoaXRlbS50eXBlKSB0eXBlID0gaXRlbS50eXBlO1xuICAgICAgICByZXR1cm4gdHlwZSAmJiBBU1NFVFMuaW5kZXhPZih0eXBlKSA+PSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7YW55fSBpdGVtIC0gZWl0aGVyIEdQIGl0ZW0gb3Igc3RyaW5nIHR5cGVcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IHVybCBvZiBpY29uIGZvciB0aGUgdHlwZVxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRJY29uKGl0ZW0gOiBhbnkpIDpzdHJpbmcge1xuICAgICAgICBsZXQgdHlwZSA9IFwiZGF0YXNldFwiO1xuICAgICAgICBzd2l0Y2goaXRlbS50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05UQUNUOiAgICAgICAgIHR5cGUgPSAgJ3ZjYXJkJzsgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OiB0eXBlID0gaXRlbS50eXBlLnJlcGxhY2UoL15bYS16XStcXDovaSwgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICdpY29uLScgKyB0eXBlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7YW55fSBpdGVtIC0gZWl0aGVyIEdQIGl0ZW1cbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IGxhYmVsIGZvciB0aGUgaXRlbVxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRMYWJlbChpdGVtIDogYW55KSB7XG4gICAgICAgIGlmKCFpdGVtIHx8ICFpdGVtLnR5cGUpIHJldHVybiAnVW5rbm93biB0eXBlJztcblxuICAgICAgICBsZXQgdHlwZSA9IGl0ZW0udHlwZTtcbiAgICAgICAgc3dpdGNoKHR5cGUpIHtcblxuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuT1JHQU5JWkFUSU9OIDpcbiAgICAgICAgICAgIC8vIGNhc2UgSXRlbVR5cGVzLlBFUlNPTiA6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubGFiZWwgfHwgaXRlbS5uYW1lIHx8IFwiVW4tdGl0bGVkIHJlc291cmNlXCI7XG5cbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLkNPTkNFUFQgOlxuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuQ09OQ0VQVF9TQ0hFTUUgOlxuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmxhYmVsIHx8IGl0ZW0ucHJlZkxhYmVsIHx8IFwiVW4tdGl0bGVkIHJlc291cmNlXCI7XG5cbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLkNPTlRBQ1QgOlxuICAgICAgICAgICAgICAgIGxldCBmbiA9IGl0ZW0uZnVsbE5hbWUgfHwgJyc7XG4gICAgICAgICAgICAgICAgbGV0IHB0ID0gaXRlbS5wb3NpdGlvblRpdGxlIHx8ICcnO1xuICAgICAgICAgICAgICAgIGxldCBvbiA9IGl0ZW0ub3JnTmFtZSB8fCAnJztcbiAgICAgICAgICAgICAgICBsZXQgbGFiZWwgPSBmbiArIChmbi5sZW5ndGg/JyAtICc6JycpICsgcHQgKyAocHQubGVuZ3RoPycgLSAnOicnKSArIG9uO1xuICAgICAgICAgICAgICAgIC8vaWYgbm9uZSBvZiB0aG9zZSBmaWVsZHMgaGF2ZSBiZWVuIHByb3ZpZGVkLCBkZWZhdWx0IHRvIGVtYWlsIG9yIHBsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgaWYoIWxhYmVsLmxlbmd0aCkgbGFiZWwgPSBpdGVtLmVtYWlsIHx8ICdVbnRpdGxlZCBDb250YWN0JztcbiAgICAgICAgICAgICAgICByZXR1cm4gbGFiZWw7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBpdGVtLmxhYmVsIHx8IGl0ZW0udGl0bGUgfHwgXCJVbi10aXRsZWQgcmVzb3VyY2VcIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7YW55fSBpdGVtIC0gZWl0aGVyIEdQIGl0ZW0gb3Igc3RyaW5nIHR5cGVcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IGxhYmVsIGZvciB0aGUgaXRlbSdzIHR5cGVcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0VHlwZUxhYmVsKGl0ZW06YW55KSB7XG4gICAgICAgIGlmKCFpdGVtKSByZXR1cm4gJ1Vua25vd24gUmVzb3VyY2UgVHlwZSc7XG5cbiAgICAgICAgbGV0IHR5cGUgOiBzdHJpbmcgPSBudWxsO1xuICAgICAgICBpZih0eXBlb2YoaXRlbSkgPT09ICdzdHJpbmcnKSB0eXBlID0gaXRlbSBhcyBzdHJpbmc7XG4gICAgICAgIGVsc2UgaWYoaXRlbS50eXBlKSB0eXBlID0gaXRlbS50eXBlO1xuICAgICAgICBlbHNlIHJldHVybiBudWxsO1xuXG4gICAgICAgIHN3aXRjaCh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5EQVRBU0VUIDpcbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLlNFUlZJQ0UgOlxuICAgICAgICAgICAgLy8gY2FzZSBJdGVtVHlwZXMuUEVSU09OIDpcbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLk9SR0FOSVpBVElPTiA6XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05DRVBUIDpcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZS5yZXBsYWNlKC9eW2Etel0rXFw6L2ksICcnKTtcbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLkNPTkNFUFRfU0NIRU1FIDogcmV0dXJuIFwiQ29uY2VwdCBTY2hlbWVcIjtcbiAgICAgICAgICAgIGNhc2UgSXRlbVR5cGVzLldFQlNJVEUgOiByZXR1cm4gXCJXZWJzaXRlXCI7XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05UQUNUIDogcmV0dXJuIFwiQ29udGFjdFwiO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIHR5cGU7ICAgLy9yZW1haW5kZXIgYXJlIHVucHJlZml4ZWRcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHthbnl9IGl0ZW0gLSBlaXRoZXIgR1AgaXRlbSBvciBzdHJpbmcgdHlwZVxuICAgICAqIEByZXR1cm4ge3N0cmluZ30ga2V5IChwbHVyYWwpIGZvciB0aGUgaXRlbSdzIHR5cGVcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0VHlwZUtleShpdGVtOmFueSkge1xuICAgICAgICBpZighaXRlbSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgbGV0IHR5cGUgOiBzdHJpbmcgPSBudWxsO1xuICAgICAgICBpZih0eXBlb2YoaXRlbSkgPT09ICdzdHJpbmcnKSB0eXBlID0gaXRlbSBhcyBzdHJpbmc7XG4gICAgICAgIGVsc2UgaWYoaXRlbS50eXBlKSB0eXBlID0gaXRlbS50eXBlO1xuICAgICAgICBlbHNlIHJldHVybiBudWxsO1xuXG4gICAgICAgIHN3aXRjaCh0eXBlKSB7XG4gICAgICAgICAgICAvL3NwZWNpYWwgcGx1cmFsaXR5XG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5HQUxMRVJZIDogcmV0dXJuICdnYWxsZXJpZXMnO1xuICAgICAgICAgICAgY2FzZSBJdGVtVHlwZXMuQ09NTVVOSVRZIDogcmV0dXJuICdjb21tdW5pdGllcyc7XG4gICAgICAgICAgICAvL2RpZmZlcmVudCBuYW1lXG4gICAgICAgICAgICBjYXNlIEl0ZW1UeXBlcy5DT05UQUNUIDogcmV0dXJuICdjb250YWN0cyc7IC8vaW5zdGVhZCBvZiBcInZjYXJkc1wiXG4gICAgICAgICAgICAvL3JlbWFpbmRlclxuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIHR5cGUucmVwbGFjZSgvXlthLXpdK1xcOi9pLCAnJykudG9Mb3dlckNhc2UoKSArICdzJztcblxuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIGl0ZW0gdHlwZVxuICAgICAqIEByZXR1cm4ge3N0cmluZ30gc3RyaW5nIHBhdGggdG8gdGhlIHR5cGUncyBpY29uXG4gICAgICovXG4gICAgc3RhdGljIGRldGVybWluZUljb25UeXBlKHR5cGUgOiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IG5hbWUgPSB0eXBlLnJlcGxhY2UoL15bYS16XStcXDovaSwgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHJldHVybiBgL2Fzc2V0cy9pY29ucy8ke25hbWV9LnN2Z2A7XG4gICAgfVxuXG4gICAgc3RhdGljIGdldEl0ZW1EZXRhaWxzVXJsKGl0ZW0gOiBhbnkpIHtcbiAgICAgICAgaWYoIWl0ZW0gfHwgIWl0ZW0udHlwZSB8fCAhaXRlbS5pZCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgcmV0dXJuIENvbmZpZy5wb3J0YWxVcmwgKyAnL3Jlc291cmNlcy8nICsgdGhpcy5nZXRUeXBlS2V5KGl0ZW0pICsgJy8nICsgaXRlbS5pZDtcbiAgICB9XG5cbn1cbiJdfQ==