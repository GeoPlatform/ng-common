!function(){"use strict";"undefined"==typeof Array.prototype.find&&(Array.prototype.find=function(callback){for(var i=0;i<this.length;++i)if(callback(this[i],i,this))return this[i];return null}),"undefined"==typeof Array.prototype.filter&&(Array.prototype.filter=function(callback){for(var results=[],i=0;i<this.length;++i)callback(this[i],i,this)&&results.push(this[i]);return results}),"undefined"==typeof Array.prototype.each&&(Array.prototype.each=function(callback){for(var i=0;i<this.length;++i)callback(this[i],i,this)}),"undefined"==typeof String.prototype.startsWith&&(String.prototype.startsWith=function(value){var str=this;return str.length&&value.length?str.length<value.length?!1:0===str.indexOf(value):!1}),"undefined"==typeof String.prototype.endsWith&&(String.prototype.endsWith=function(value){var str=this;if(!str.length)return!1;if(!value.length)return!1;if(str.length<value.length)return!1;var substr=str.substring(str.length-value.length,str.length);return substr==value}),"undefined"==typeof Date.prototype.plus&&(Date.prototype.plus=function(offset){var type=typeof offset;if("undefined"===type)return this;var offsetMS=0;if("string"===type)switch(offset){case"hour":offsetMS=36e5;break;case"day":offsetMS=864e5;break;case"week":offsetMS=6048e5;break;case"month":offsetMS=26784e5;break;case"year":offsetMS=31536e6}else{if("number"!==type)return this;offsetMS=offset}var d=this;return new Date(d.getTime()+offsetMS)}),"undefined"==typeof Date.prototype.random&&(Date.prototype.random=function(threshold){var type=typeof threshold;if("undefined"===type)return this;var offsetMS=0;if("string"===type)switch(threshold){case"hour":offsetMS=36e5;break;case"day":offsetMS=864e5;break;case"week":offsetMS=6048e5;break;case"month":offsetMS=26784e5;break;case"year":offsetMS=31536e6}else{if("number"!==type)return this;offsetMS=threshold}var d=this;return new Date(d.getTime()+Math.floor(Math.random()*offsetMS))})}(),function(jQuery,angular){"use strict";angular.module("gp-common",[]).constant("idspBaseUrl",GeoPlatform.idspUrl).constant("idmBaseUrl",GeoPlatform.idmUrl).value("GPConfig",GeoPlatform)}(jQuery,angular),function(angular){"use strict";function isDEV(){return"localhost"===window.location.hostname||~window.location.hostname.indexOf("192.168")||~window.location.hostname.indexOf("10.0")}angular.module("gp-common").service("AuthenticationService",["$q","$http","GPConfig",function($q,$http,Config){function User(opts){for(var p in opts)this[p]=opts[p];!this.id&&this.username&&(this.id=this.username),this.toJSON=function(){return{id:this.id,username:this.username,name:this.name,email:this.email,org:this.org}},this.clone=function(){return new User(this.toJSON())},this.compare=function(arg){return arg instanceof User?this.id===arg.id:"object"==typeof arg?"undefined"!=typeof arg.id&&arg.id===this.id:!1}}var TEST_USER=new User({id:"tester",username:"tester",email:"tester@geoplatform.us",name:"John Test",org:"Other"}),_user=null;isDEV()&&(_user=GeoPlatform&&GeoPlatform.TEST_NO_AUTH?null:TEST_USER.clone());var STATUS={NONE:0,INITIALIZING:-1,INITIALIZED:1},Service=function(){var self=this;this.status=STATUS.NONE,this.getUserQ=function(){var deferred=$q.defer();return this.getUser(function(user){deferred.resolve(user)}),deferred.promise},this.getUser=function(callback){return callback&&"function"==typeof callback?void(self.status===STATUS.INITIALIZED?callback(_user):self.status!==STATUS.INITIALIZING?self.check().then(function(_user){self.status=STATUS.INITIALIZED,callback(_user)},function(){self.status=STATUS.INITIALIZED,callback(null)}):setTimeout(function(){self.getUser(callback)},500)):_user},this.login=function(){if(isDEV())return _user=TEST_USER.clone();var current=window.location.href;window.location=Config.idspUrl+"/module.php/core/as_login.php?AuthId=geosaml&ReturnTo="+encodeURIComponent(current)},this.logout=function(){if(isDEV())return _user=null;var current=window.location.href;window.location=Config.idspUrl+"/module.php/core/as_logout.php?AuthId=geosaml&ReturnTo="+encodeURIComponent(current)},this.check=function(){var deferred=$q.defer();return isDEV()?(setTimeout(function(){deferred.resolve(_user)},1e3),deferred.promise):(self.status=STATUS.INITIALIZING,$http.get(Config.idspUrl+"/authenticategeosaml.php?as=geosaml").success(function(response){_user=response.Success?new User({id:response.name[0],username:response.name[0],email:response.mail[0],name:response.first_name[0]+" "+response.last_name[0],org:response.organization[0]}):null,deferred.resolve(_user)}).error(function(data,status,headers){console.log("Authentication call failed"),deferred.reject(data)}),deferred.promise)},this.check().then(function(user){self.status=STATUS.INITIALIZED},function(err){self.status=STATUS.INITIALIZED})};return new Service}]).directive("gpLoginButton",["$timeout","AuthenticationService","GPConfig",function($timeout,AuthenticationService,Config){return{scope:{minimal:"@"},replace:!0,template:['<div class="btn-account btn-group">  <a class="btn btn-link" ng-click="login()" ng-if="!user">Sign In</a>  <button type="button" class="btn btn-link dropdown-toggle" data-toggle="dropdown"    aria-expanded="false" ng-if="user">     <span class="glyphicon glyphicon-user"></span>      <span class="hidden-xs">{{::user.name}}</span>      <span class="caret"></span>  </button>  <ul class="dropdown-menu dropdown-menu-right" role="menu" ng-if="user">    <li class="account-details">      <div class="media">        <div class="media-left">          <div class="media-object">            <span class="glyphicon glyphicon-user glyphicon-xlg"></span>          </div>        </div>        <div class="media-body">          <div class="media-heading">{{::user.name}}</div>          <div><em>{{::user.username}}</em></div>          <div>{{::user.email}}</div>          <div>{{::user.org}}</div>        </div>      </div>    </li>    <li class="divider"></li>    <li><a href="{{::idpUrl}}/modifyuser.html">Edit Info</a></li>    <li><a href="{{::idpUrl}}/changepassword.html">Change Password</a></li>    <li><a href ng-click="logout()">Sign Out</a></li>  </ul></div>'].join(" "),controller:function($scope,$element){"true"===$scope.minimal&&($scope.minimal=!0),$scope.minimal!==!0&&($scope.minimal=!1),$scope.idpUrl=Config.idmUrl,AuthenticationService.getUser(function(user){$timeout(function(){$scope.user=user},100)}),$scope.login=function(){$scope.user=AuthenticationService.login()},$scope.logout=function(){$scope.user=AuthenticationService.logout()};var watcher=$scope.$watch(function(){return AuthenticationService.getUser()},function(newUser){$scope.user=newUser});$scope.$on("$destroy",function(){watcher()})}}}]).directive("gpAccountDetails",["$timeout","AuthenticationService","GPConfig",function($timeout,AuthenticationService,Config){return{scope:{},replace:!0,template:['<div>  <div class="media">','    <div class="media-left">','        <div class="media-object">','            <span class="glyphicon glyphicon-user glyphicon-xlg"></span>',"        </div>","    </div>",'    <div class="media-body" ng-if="user">','       <div class="media-heading">{{::user.name}}</div>       <div><small><em>{{::user.username}}</em></small></div>       <div><small>{{::user.email}}</small></div>       <div><small>{{::user.org}}</small></div>    </div>','    <div class="media-body" ng-if="!user">','       <div class="media-heading">Please Sign In</div>       <div><small>Sign in to your GeoPlatform account or register a new account.</small></div>    </div>',"  </div>","  <hr/>",'  <div ng-if="user">','    <button type="button" class="btn btn-sm btn-accent pull-right" ng-click="logout()">Sign Out</button>    <a class="btn btn-sm btn-default" href="{{::idpUrl}}/modifyuser.html">Edit Details</a>  </div>','  <div ng-if="!user">','    <button type="button" class="btn btn-sm btn-accent pull-right" ng-click="login()">Sign In</button>    <a class="btn btn-sm btn-default" href="{{::idpUrl}}/registeruser.html">Register</a>  </div>',"</div>"].join(" "),controller:function($scope,$element){$scope.idpUrl=Config.idmUrl,AuthenticationService.getUser(function(user){$timeout(function(){$scope.user=user},100)}),$scope.login=function(){$scope.user=AuthenticationService.login()},$scope.logout=function(){$scope.user=AuthenticationService.logout()};var watcher=$scope.$watch(function(){return AuthenticationService.getUser()},function(newUser){$scope.user=newUser});$scope.$on("$destroy",function(){watcher()})}}}])}(angular),function(jQuery,angular){"use strict";angular.module("gp-common").directive("gpDatePicker",["$timeout",function($timeout){return{scope:{label:"@",format:"@",date:"=",onChange:"&?"},template:['<div class="input-group-slick">','    <input type="text" class="form-control" placeholder="{{::label}}"','        datepicker-popup="{{format}}" ng-model="date" is-open="opened" />','    <span class="glyphicon glyphicon-calendar" ng-click="toggle($event)"></span>',"</div>",'<p class="help-block"><small><em>Ex: "2015-01-31" or "Jan 31 2015"</em></small></p>'].join(" "),controller:function($scope,$element,$attrs){$scope.toggle=function(event){event.preventDefault(),event.stopPropagation(),this.opened=!this.opened},$scope.format||($scope.format="MMM dd yyyy");var promise=null;$scope.debounce=function(){promise&&$timeout.cancel(promise),promise=$timeout(function(){promise=null,$scope.onChange&&$scope.onChange()},200)},$scope.$watch("date",function(){$scope.debounce()});var listener=$scope.$on("$destroy",function(){listener(),promise&&$timeout.cancel(promise),promise=null,$scope.opened=!1,$scope.onChange=null,$scope.format=null,$scope.debounce=null})}}}])}(jQuery,angular),function(jQuery,angular){"use strict";angular.module("gp-common").directive("gpGeolocation",["$window",function($window){var defaultBtnLabel="Locate";return{scope:{label:"=?"},restrict:"EA",template:['<a class="btn btn-primary" ng-click="geolocate()" ng-if="available">','  <span class="glyphicon glyphicon-screenshot" ng-if="!loading"></span>','  <span class="glyphicon glyphicon-hourglass glyphicon-spin" ng-if="loading"></span>',"  {{btnLabel}}","</a>",'<div ng-if="error">{{error}}</div>'].join(" "),controller:function($scope){$scope.btnLabel=$scope.label||defaultBtnLabel,$scope.loading=!1,$scope.available=$window.navigator&&$window.navigator.geolocation,$scope.available||($scope.error="Your browser does not support determining location"),$scope.geolocate=function(){$scope.loading=!0,$window.navigator.geolocation.getCurrentPosition(function(position){$scope.$apply(function(){$scope.loading=!1}),$scope.$emit("map:geolocation",position.coords.latitude,position.coords.longitude)},function(error){switch(error.code){case 1:$scope.error="Permission was denied while attempting to determine location";break;case 2:$scope.error="Unable to determine your location";break;case 3:$scope.error="Unable to determine location in a reasonable amount of time"}})}}}}])}(jQuery,angular),function(jQuery,angular){"use strict";angular.module("gp-common").directive("gpHeader",["GPConfig","AuthenticationService",function(Config,AuthenticationService){return{scope:{brand:"@",showHomeLink:"@"},restrict:"AE",transclude:!0,replace:!0,template:["<header>",'  <div class="container-fluid">','    <div class="row">','      <div class="col-md-12">','        <ul role="menu" class="header__menu" gp-header-menu>','          <li ng-if="showHomeLink">','            <a href="#/goHome">','                <span class="glyphicon glyphicon-home"></span> ','                <span class="hidden-xs hidden-sm">Home</span>',"            </a>","          </li>",'          <div class="transcluded"></div>',"          <li><span gp-login-button></span></li>","        </ul>",'        <h4 class="brand">','          <a href="{{portalUrl}}" title="Go to the GeoPlatform Home Page">','            <span class="icon-gp"></span>','            <span class="hidden-xs">GeoPlatform</span>',"          </a>","          {{brand}}","        </h4>","      </div>","    </div>","  </div>","</header>"].join(" "),link:function($scope,$element,$attrs,ctrl,transcludeFn){$scope.showHomeLink="true"===$scope.showHomeLink||!1,$scope.portalUrl=Config.portalUrl,AuthenticationService.getUserQ().then(function(user){$scope.user=user}),$element.find(".transcluded").replaceWith(transcludeFn())}}}]).directive("gpHeaderMenu",["$location",function($location){function update($element){var path=$location.path();("/"===path||"/#"===path||"/#/"===path)&&(path=homeLink),"/"===path[0]&&(path=path.substring(1));var menu=$element;menu.find("li.active").removeClass("active");var link=menu.find('li > a[href="#/'+path+'"]');if(link.length){var dd=link.closest(".dropdown-menu");dd.length?dd.closest("li").addClass("active"):link.parent().addClass("active")}menu.find("li > a").each(function(i,a){var $a=$(a),href=$a.attr("href");href&&(href=href.replace("#/",""),0===path.indexOf(href)&&$a.parent().addClass("active"))})}var homeLink="goHome";return{scope:{homeHref:"@"},restrict:"A",controller:function($rootScope,$scope,$element){$scope.homeHref&&(homeLink=$scope.homeHref)},link:function($scope,$element){update($element),$scope.$root.$on("$locationChangeSuccess",function(){update($element)})}}}])}(jQuery,angular),function(angular){"use strict";angular.module("gp-common").directive("iframeOnload",function(){return{scope:{callback:"&iframeOnload"},link:function(scope,element,attrs){element.on("load",function(event){return element.off("load"),scope.callback(event)})}}})}(angular),function(angular){"use strict";angular.module("gp-common").directive("onImgFail",function(){return{scope:{onImgFail:"@"},link:function($scope,$element){var jqEl=jQuery($element);jqEl.on("error",function(){jqEl.attr("src",$scope.onImgFail)})}}})}(angular),function(angular){"use strict";angular.module("gp-common").service("NotificationService",["$rootScope",function($rootScope){var Service=function(){this.items=[]};return Service.prototype={getItems:function(){return this.items},addItem:function(item){this.items.push(item),$rootScope.$broadcast("gp:notifications:new",item);var fn=function(item){this.removeItem(item)};return fn.bind(this,item)},removeItem:function(item){var index=this.items.indexOf(item);return index>=0?this.items.splice(index,1):null},error:function(label,msg,dismiss){return this.addItem({type:"error",label:label,message:msg,canDismiss:dismiss})},success:function(label,msg,dismiss){return this.addItem({type:"success",label:label,message:msg,canDismiss:dismiss})},info:function(label,msg,dismiss){return this.addItem({type:"info",label:label,message:msg,canDismiss:dismiss})}},new Service}]).directive("gpNotifications",["$timeout","NotificationService",function($timeout,NotificationService){return{scope:{expiration:"@"},template:['<div class="notifications ng-hide" ng-show="items.length">','  <div class="notification" ng-repeat="item in items"',"    ng-class=\"{'notification--success':item.type==='success', 'notification--error':item.type==='error', 'notification--info':item.type==='info'}\">",'    <h5 class="notification__title">','        <span class="pull-right glyphicon" ',"            ng-class=\"{'glyphicon-ok-sign':item.type==='success','glyphicon-exclamation-sign':item.type==='error','glyphicon-info-sign':item.type==='info'}\">","        </span>","        {{item.label}}","    </h5>",'    <p class="notification__content" ng-bind-html="item.message"></p>','    <div class="notification__actions" ng-if="item.canDismiss">','        <button type="button" class="btn btn-link" ng-click="dismiss(item)">dismiss</button>',"    </div>","  </div>","</div>"].join(" "),link:function($scope,$element,$attrs){function update(){$scope.items=NotificationService.getItems(),$scope.timer&&($timeout.cancel($scope.timer),$scope.timer=null),$scope.timer=$timeout(function(){$scope.timer=null,$scope.removeOldest()},$scope.expiration)}$scope.expiration=1*($scope.expiration||2e3),$scope.items=[],update(),$scope.removeOldest=function(){var oldest=$scope.items.find(function(item){return item.canDismiss});oldest&&NotificationService.removeItem(oldest)},$scope.dismiss=function(item){NotificationService.removeItem(item)},$scope.$watchCollection(function(){return NotificationService.getItems()},update)}}}])}(angular),function(jQuery,angular){"use strict";angular.module("gp-common").directive("gpPagination",function(){function Controller($scope,$element){function update(){var ostart=1*$scope.start,osize=1*$scope.pageSize,pages=[],maxPagination=5;maxPagination%2!==0?Math.ceil(maxPagination/2):maxPagination/2;if($scope.total>0){var numPages=Math.ceil($scope.total/osize),currentPage=Math.floor(ostart/osize),s=0;s=currentPage>Math.floor(maxPagination/2)?currentPage-Math.floor(maxPagination/2):0;for(var e=Math.min(s+maxPagination,numPages);s>0&&maxPagination>e-s;)s-=1;for(var i=s;e>i;++i){var pageStart=i*osize+1,pageEnd=Math.min(pageStart+osize-1,$scope.total);pages.push({label:i+1+"",tooltip:"Results "+pageStart+"-"+pageEnd}),i==currentPage&&(pages[pages.length-1].active=!0)}}$scope.pages=pages}$scope.pageSizeOpts||($scope.pageSizeOpts=[5,10,25,50]),$scope.pageSize&&$scope.pageSizeOpts.indexOf(1*$scope.pageSize)<0&&$scope.pageSizeOpts.push(1*$scope.pageSize).sort(),$scope.previous=function(){$scope.start=Math.max(0,1*$scope.start-1*$scope.pageSize),$scope.$emit("pagination:change",$scope.start,$scope.pageSize)},$scope.next=function(){$scope.start=Math.min($scope.total,1*$scope.start+1*$scope.pageSize),$scope.$emit("pagination:change",$scope.start,$scope.pageSize)},$scope.setPage=function(arg){var page=1*arg;$scope.start=(page-1)*(1*$scope.pageSize),$scope.$emit("pagination:change",$scope.start,$scope.pageSize)},$scope.setPageSize=function(size){$scope.pageSize=1*size;var currentPage=Math.floor($scope.start/$scope.pageSize)+1;$scope.setPage(currentPage)},$scope.hasPrevious=function(){return $scope.start>0},$scope.hasNext=function(){return $scope.start+$scope.pageSize<$scope.total},update(),$scope.$watch("start",update),$scope.$watch("pageSize",update),$scope.$watch("total",update)}return{scope:{start:"=",pageSize:"=",total:"=",pageSizeOpts:"="},replace:!0,template:["<div>",'  <div class="visible-xs row">','    <div class="col-xs-6">{{total}} results</div>','    <div class="col-xs-6">','      <select class="form-control" ng-model="pageSize">','        <option ng-repeat="ps in pageSizeOpts" ','          ng-selected="pageSize===ps" ','          value="{{ps}}">{{ps}} per page</option>',"      </select>","    </div>","  </div>",'  <ul class="pagination">','    <li class="info hidden-xs">',"      <a>{{total}} results</a>","    </li>",'    <li class="pagination-control hidden-xs" ng-if="total>0">',"      <span uib-dropdown>",'        <a href="" uib-dropdown-toggle title="Change the number of results returned">','          {{pageSize}} per page <span class="caret"></span>',"        </a>",'        <ul class="dropdown-menu" role="menu">','          <li ng-repeat="ps in pageSizeOpts"><a ng-click="setPageSize(ps)">{{ps}} per page</a></li>',"        </ul>","      </span>","    </li>",'    <li class="separator hidden-xs"></li>','    <li ng-if="hasPrevious()">','      <a ng-click="previous()">','        <span class="glyphicon glyphicon-backward"></span>',"      </a>","    </li>",'    <li ng-repeat="page in pages" ng-class="{active:page.active,disabled:page.disabled}">','      <a ng-click="setPage(page.label)" title="{{::page.tooltip}}">{{::page.label}}</a>',"    </li>",'    <li ng-if="hasNext()">','      <a ng-click="next()">','        <span class="glyphicon glyphicon-forward"></span>',"      </a>","    </li>","  </ul>","</div>"].join(" "),controller:Controller}})}(jQuery,angular),function(jQuery,angular){"use strict";angular.module("gp-common").provider("responsiveHelper",["$windowProvider",function($windowProvider){function Helper($window){this.window=$window}var $window=$windowProvider.$get();Helper.prototype={getWidth:function(){return $window.innerWidth||$window.outerWidth},isXS:function(){var width=this.getWidth();return 768>width},isSM:function(){var width=this.getWidth();return width>=768&&992>width},isMD:function(){var width=this.getWidth();return width>=992&&1200>width},isLG:function(){var width=this.getWidth();return width>=1200}};var helper=new Helper($window);this.$get=function(){return helper}}]).directive("gpResponsive",["$window","responsiveHelper",function($window,responsiveHelper){return{restrict:"A",link:function($scope,$element,$attrs){function update(el,helper){helper.isXS()?el.addClass("gp-responsive-xs"):el.removeClass("gp-responsive-xs"),helper.isSM()?el.addClass("gp-responsive-sm"):el.removeClass("gp-responsive-sm"),helper.isMD()?el.addClass("gp-responsive-md"):el.removeClass("gp-responsive-md"),helper.isLG()?el.addClass("gp-responsive-lg"):el.removeClass("gp-responsive-lg")}update($element,responsiveHelper);var resizeFn=function(){update($element,responsiveHelper)},w=angular.element($window);w.on("resize",resizeFn);$scope.$on("$destroy",function(){w.off("resize",resizeFn)})}}}]).directive("gpResize",function($window,$timeout){return function($scope,$element,$attr){var resizeFn=function(){var hh=jQuery("header")[0].offsetHeight,tp=hh+2,changes={top:tp+"px"};$element.css(changes),$scope.$apply()},w=angular.element($window);w.on("resize",resizeFn),$timeout(resizeFn,200),$scope.$on("$destroy",function(){w.off("resize",resizeFn)})}})}(jQuery,angular),function(jQuery,angular){"use strict";function inputLinkFunction($scope,$element,$attrs,ngModelController,$timeout){function validate(){var input=$element.find(".form-control");$scope.isDirty=input.hasClass("ng-dirty"),input.hasClass("ng-invalid")?input.hasClass("ng-empty")?$scope.error="This field requires a value":$scope.error="Invalid value provided":$scope.error=null}function update(newValue){ngModelController.$setViewValue(newValue),ngModelController.$render()}$scope.type||($scope.type="text"),"true"===$scope.required?$scope.required=!0:$scope.required=!1,$scope.elId="input_"+Math.ceil(9999*Math.random()),$scope.size=$scope.size||"medium",$scope.type=$scope.type||"text",$element.find(".form-control").on("change",function(){validate($scope.innerValue)}),ngModelController.$render=function(){var value=ngModelController.$viewValue;$scope.innerValue=value,$scope.displayValue=value||$scope.placeholder||"No value provided",validate(value)},$scope.isReadOnly=function(){var t=typeof this.readOnly;return"undefined"===t?!1:"string"===t?"true"===this.readOnly.toLowerCase():"number"===t?1===this.readOnly:"boolean"===t?this.readOnly:!1},$scope.edit=function(){$scope.isReadOnly()||($scope.editing=!0,$timeout(function(){$element.find(".form-control").focus().select()},200))},$scope.done=function(){$scope.editing=!1,$scope.error=null},$scope.save=function(){update($scope.innerValue),$scope.done()},$scope.cancel=function(){$scope.innerValue=ngModelController.$viewValue,$scope.done()},$scope.onKeyPress=function($event,code){if(void 0!==code&&0!==code||void 0===$event.which||(code=$event.which),"number"===$scope.type){if(8===code||46===code||code>=44&&57>=code)return;return $event.preventDefault(),!1}},$scope.onKeyUp=function($event,code){if(void 0!==code&&0!==code||void 0===$event.which||(code=$event.which),13!==code||$scope.error)if(27===code)$scope.cancel();else{if(8!==code&&46!==code&&190!==code&&(48>code||code>90)&&(106>code||code>111)&&186>code)return;validate()}else $scope.done()},$scope.$destroy=function(){$element.off("change")}}angular.module("gp-common").directive("gpSlickFormInput",["$timeout",function($timeout){return{restrict:"AE",require:"ngModel",scope:{label:"@",placeholder:"@",help:"=",type:"@",pattern:"@",required:"@",readOnly:"@",size:"@",icon:"@"},template:INPUT_TEMPLATE,link:function($scope,$element,$attrs,ngModelController){inputLinkFunction($scope,$element,$attrs,ngModelController,$timeout)}}}]).directive("gpSlickFormTextarea",["$timeout",function($timeout){return{restrict:"AE",require:"ngModel",scope:{label:"@",placeholder:"@",help:"@",readOnly:"@",size:"@",icon:"@"},template:TEXTAREA_TEMPLATE,link:function($scope,$element,$attrs,ngModelController){inputLinkFunction($scope,$element,$attrs,ngModelController,$timeout)}}}]).directive("gpSlickFormDate",["$timeout","$filter",function($timeout,$filter){return{restrict:"AE",require:"ngModel",scope:{label:"@",format:"@",placeholder:"@",required:"@",readOnly:"@",size:"@",icon:"@"},template:DATE_TEMPLATE,controller:function($scope,$element){(!$scope.format||$scope.format.length<3)&&($scope.format="mediumDate"),$scope.inline=$element.hasClass("inline")},link:function($scope,$element,$attrs,ngModelController){function validate(value){var input=$element.find(".form-control");input.hasClass("ng-invalid")?input.hasClass("ng-empty")?$scope.error="This field requires a value":$scope.error="Invalid value provided":$scope.error=null}function update(newValue){ngModelController.$setViewValue(newValue),ngModelController.$render()}"true"===$scope.required?$scope.required=!0:$scope.required=!1,$scope.elId="input_"+Math.ceil(9999*Math.random()),$scope.size=$scope.size||"medium",$scope.type=$scope.type||"text",ngModelController.$render=function(){var value=ngModelController.$viewValue;$scope.innerValue=value,$scope.displayValue=value?$filter("date")(ngModelController.$modelValue,$scope.format):$scope.placeholder||"No value provided",validate(value)},$scope.isReadOnly=function(){var t=typeof this.readOnly;return"undefined"===t?!1:"string"===t?"true"===this.readOnly.toLowerCase():"number"===t?1===this.readOnly:"boolean"===t?this.readOnly:!1},$scope.edit=function(){$scope.isReadOnly()||($scope.editing=!0)},$scope.done=function(){$scope.opened=!1,$scope.editing=!1,$scope.error=null},$scope.save=function(){update($scope.innerValue),$scope.done()},$scope.cancel=function(){$scope.innerValue=angular.copy(ngModelController.$modelValue),$scope.done()},$scope.open=function(){"undefined"==typeof $scope.uibopts&&($scope.uibopts={}),$scope.uibopts.opened=!0},$scope.onKeyUp=function(code){13===code?$scope.done():27===code&&$scope.cancel()},$scope.onChange=function(date){isNaN(ngModelController.$modelValue)&&$scope.required?$scope.error="This field requires a value":$scope.error=null}}}}]).directive("gpSlickFormSelect",["$timeout",function($timeout){return{restrict:"AE",require:"ngModel",scope:{label:"@",codeList:"=",help:"=",required:"@",readOnly:"@",size:"@",icon:"@"},template:SELECT_TEMPLATE,link:function($scope,$element,$attrs,ngModelController){function getSelect(){return $select&&$select.length||($select=$element.find(".form-control")),$select}function validate(){var select=getSelect();$scope.isDirty=select.hasClass("ng-dirty"),select.hasClass("ng-invalid")?select.hasClass("ng-empty")?$scope.error="This field requires a value":$scope.error="Invalid value provided":$scope.error=null}function update(newValue){ngModelController.$setViewValue(newValue),ngModelController.$render()}$scope.type||($scope.type="text"),"true"===$scope.required?$scope.required=!0:$scope.required=!1,$scope.elId="input_"+Math.ceil(9999*Math.random()),$scope.size=$scope.size||"medium",$scope.type=$scope.type||"text";var $select=null;$scope.codeList?$scope.selectOptions=$scope.codeList.map(function(item){return"object"==typeof item&&item.value?item.label?item:{value:item.value,label:item.value}:{value:item,label:item}}):$scope.selectOptions=[],ngModelController.$render=function(){var value=ngModelController.$viewValue;if($scope.innerValue=value,$scope.displayValue=$scope.placeholder||"No value provided",value){var opt=$scope.selectOptions.find(function(o){return o.value==value});$scope.displayValue=opt.label}validate()},$scope.onChange=function(value){$scope.innerValue=value,$timeout(function(){validate()},200)},$scope.onTypeaheadSelection=function($item,$model,$label,$event){$scope.innerValue=$item?$item.value:null,$timeout(function(){validate()},200)},$scope.isReadOnly=function(){var t=typeof this.readOnly;return"undefined"===t?!1:"string"===t?"true"===this.readOnly.toLowerCase():"number"===t?1===this.readOnly:"boolean"===t?this.readOnly:!1},$scope.edit=function(){$scope.isReadOnly()||($scope.editing=!0,$timeout(function(){$select.focus().select()},200))},$scope.done=function(){$scope.editing=!1,$scope.error=null},$scope.save=function(){update($scope.innerValue),$scope.done()},$scope.cancel=function(){$scope.innerValue=ngModelController.$viewValue,$scope.done()},$scope.onKeyUp=function(code){13!==code||$scope.error?27===code&&$scope.cancel():$scope.save()},$scope.onTypeaheadKeyUp=function(code){validate()},$scope.$destroy=function(){}}}}]);var INPUT_TEMPLATE=['<div class="form-group form-group-slick">','   <label for="{{::elId}}" class="control-label">{{::label}}</label>','   <div class="input__display" ',"       ng-class=\"{'is-read-only':isReadOnly(), 'has-error':!!error,'text-lg':size==='large'}\" ",'       ng-show="!editing" ng-click="edit()" ',"       title=\"{{!!error?error:(!isReadOnly()?'Click to edit':'')}}\">","      {{displayValue}}","   </div>",'   <div ng-show="editing">',"      <div class=\"input-group\" ng-class=\"{'input-group-lg':size==='large'}\">","           <div class=\"input-group-slick\" ng-class=\"{'input-group-slick--lg':size==='large'}\">",'               <span ng-if="icon" class="{{::icon}}"></span>','               <input id="{{::elId}}" type="{{::type}}" class="form-control" ','                   pattern="{{pattern}}" ','                   ng-model="innerValue" ','                   ng-required="{{required}}" ','                   ng-keypress="onKeyPress($event, $event.keyCode)" ','                   ng-keyup="onKeyUp($event, $event.keyCode)" >','               <span class="indicators">','                   <span class="is-valid glyphicon glyphicon-ok-sign"></span>','                  <span class="is-invalid glyphicon glyphicon-exclamation-sign"></span>',"              </span>","           </div>",'          <span class="input-group-btn">','               <button type="button" class="btn btn-default" ',"                   ng-class=\"{'btn-lg':size==='large'}\"",'                   ng-click="cancel()" title="Cancel changes">','                   <span class="glyphicon glyphicon-ban-circle"></span>',"              </button>",'               <button type="button" class="btn btn-default" ',"                   ng-class=\"{disabled:!!error||!isDirty,'btn-lg':size==='large'}\"",'                   ng-disabled="{{!!error}}" ','                   ng-click="save()" title="Save changes">','                  <span class="glyphicon glyphicon-ok"></span>',"               </button>","           </span>","       </div>",'       <div ng-if="error && error.length"><small class="help-block text-danger">{{error}}</small></div>','       <div ng-if="help && help.length"><small class="help-block">{{help}}</small></div>',"   </div>","</div>"].join(" "),TEXTAREA_TEMPLATE=['<div class="form-group form-group-slick">','   <label for="{{::elId}}" class="control-label">{{::label}}</label>','   <div class="input__display" ',"       ng-class=\"{'is-read-only':isReadOnly(), 'has-error':!!error,'text-lg':size==='large'}\" ",'       ng-show="!editing" ng-click="edit()" ',"       title=\"{{!!error?error:(!isReadOnly()?'Click to edit':'')}}\">","      {{displayValue}}","   </div>",'   <div ng-show="editing">',"      <div class=\"input-group\" ng-class=\"{'input-group-lg':size==='large'}\">","           <div class=\"input-group-slick\" ng-class=\"{'input-group-slick--lg':size==='large'}\">",'               <span ng-if="icon" class="{{::icon}}"></span>','               <textarea rows="3" id="{{::elId}}" class="form-control" ','                   ng-required="{{required}}" ng-model="innerValue"','                   ng-keypress="onKeyPress($event, $event.keyCode)" ','                   ng-keyup="onKeyUp($event, $event.keyCode)"></textarea>','               <span class="indicators">','                   <span class="is-valid glyphicon glyphicon-ok-sign"></span>','                  <span class="is-invalid glyphicon glyphicon-exclamation-sign"></span>',"              </span>","           </div>",'          <span class="input-group-btn">','               <button type="button" class="btn btn-default" ',"                   ng-class=\"{'btn-lg':size==='large'}\"",'                   ng-click="cancel()" title="Cancel changes">','                   <span class="glyphicon glyphicon-ban-circle"></span>',"              </button>",'               <button type="button" class="btn btn-default" ',"                   ng-class=\"{disabled:!!error||!isDirty,'btn-lg':size==='large'}\"",'                   ng-disabled="{{!!error}}" ','                   ng-click="save()" title="Save changes">','                  <span class="glyphicon glyphicon-ok"></span>',"               </button>","           </span>","       </div>",'       <div ng-if="error && error.length"><small class="help-block text-danger">{{error}}</small></div>','       <div ng-if="help && help.length"><small class="help-block">{{help}}</small></div>',"   </div>","</div>"].join(" "),DATE_TEMPLATE=['<div class="form-group form-group-slick">','   <label for="{{::elId}}" class="control-label">{{::label}}</label>','   <div class="input__display" ',"       ng-class=\"{'is-read-only':isReadOnly(), 'has-error':!!error}\" ",'       ng-show="!editing" ng-click="edit()" ',"       title=\"{{!!error?error:(!isReadOnly()?'Click to edit':'')}}\">","      {{displayValue}}","   </div>",'   <div ng-show="editing">','       <div uib-datepicker ng-required="{{required}}" ng-model="innerValue" datepicker-options="{showWeeks:false}"></div>','       <div ng-if="error && error.length"><small class="help-block text-danger">{{error}}</small></div>','       <div ng-if="help && help.length"><small class="help-block">{{help}}</small></div>','       <button type="button" class="btn btn-default" ',"           ng-class=\"{'btn-lg':size==='large'}\"",'           ng-click="cancel()" title="Cancel changes">','           <span class="glyphicon glyphicon-ban-circle"></span>',"      </button>",'      <button type="button" class="btn btn-default" ',"           ng-class=\"{disabled:!!error,'btn-lg':size==='large'}\"",'          ng-disabled="{{!!error}}" ','           ng-click="save()" title="Save changes">','           <span class="glyphicon glyphicon-ok"></span>',"      </button>","   </div>","</div>"].join(" "),SELECT_TEMPLATE=['<div class="form-group form-group-slick">','   <label for="{{::elId}}" class="control-label">{{::label}}</label>','   <div class="input__display" ',"       ng-class=\"{'is-read-only':isReadOnly(), 'has-error':!!error}\" ",'       ng-show="!editing" ng-click="edit()" ',"       title=\"{{!!error?error:(!isReadOnly()?'Click to edit':'')}}\">","      {{displayValue}}","   </div>",'   <div ng-show="editing">',"      <div class=\"input-group\" ng-class=\"{'input-group-lg':size==='large'}\">","           <div class=\"input-group-slick\" ng-class=\"{'input-group-slick--lg':size==='large'}\">",'               <span ng-if="icon" class="{{::icon}}"></span>','               <select class="form-control input__field" ','                   ng-if="codeList.length<=12" ','                   ng-model="innerValue" ','                   ng-options="opt.value as opt.label for opt in selectOptions" ','                   ng-required="{{required}}" ','                   ng-change="onChange(innerValue)" ','                   ng-keyUp="onKeyUp($event.keyCode)" >','                   <option value="">Select One</option>',"               </select>",'               <input type="text" class="form-control input__field" ng-if="codeList.length>12" ','                   ng-model="innerValue" ','                   ng-required="{{required}}" ','                   ng-keyUp="onTypeaheadKeyUp($event.keyCode)" ','                   typeahead-on-select="onTypeaheadSelection($item, $model, $label, $event)" ','                   uib-typeahead="opt.value as opt.label for opt in selectOptions | filter:{value:$viewValue} | limitTo:12" ','                   typeahead-min-length="0" ','                   typeahead-editable="false">','               <span class="indicators">','                   <span class="is-valid glyphicon glyphicon-ok-sign"></span>','                  <span class="is-invalid glyphicon glyphicon-exclamation-sign"></span>',"              </span>","           </div>",'          <span class="input-group-btn">','               <button type="button" class="btn btn-default" ',"                   ng-class=\"{'btn-lg':size==='large'}\"",'                   ng-click="cancel()" title="Cancel changes">','                   <span class="glyphicon glyphicon-ban-circle"></span>',"              </button>",'               <button type="button" class="btn btn-default" ',"                   ng-class=\"{disabled:!!error||!isDirty,'btn-lg':size==='large'}\"",'                   ng-disabled="{{!!error}}" ','                   ng-click="save()" title="Save changes">','                  <span class="glyphicon glyphicon-ok"></span>',"               </button>","           </span>","       </div>",'       <div ng-if="error && error.length"><small class="help-block text-danger">{{error}}</small></div>','       <div ng-if="help && help.length"><small class="help-block">{{help}}</small></div>',"   </div>","</div>"].join(" ");
}(jQuery,angular),function(angular){"use strict";angular.module("gp-common").directive("gpTweetButton",["$timeout",function($timeout){function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)},callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&func.apply(context,args)}}return{link:function(scope,element,attr){if("undefined"==typeof twttr)return void(element.className+=" disabled");var renderTwitterButton=debounce(function(){attr.url&&$timeout(function(){element[0].innerHTML="",twttr.widgets.createShareButton(attr.url,element[0],function(){},{count:attr.count,text:attr.text,via:attr.via,size:attr.size,hashtags:attr.hashtags,dnt:attr.dnt})})},75);attr.$observe("url",renderTwitterButton),attr.$observe("text",renderTwitterButton)}}}])}(angular),function(angular){"use strict";angular.module("gp-common").directive("sortOrder",function(){return{replace:!0,require:"ngModel",template:["<div>",'<a class="btn btn-default" title="Click to sort in ascending order" href ng-if="value===\'dsc\'" ng-click="toggle()">','    <span class="glyphicon glyphicon-sort-by-attributes-alt"></span>',"</a>",'<a class="btn btn-default" title="Click to sort in descending order" href ng-if="value===\'asc\'" ng-click="toggle()">','    <span class="glyphicon glyphicon-sort-by-attributes"></span>',"</a>","</div>"].join(" "),link:function($scope,element,attrs,ngModel){ngModel.$viewChangeListeners.push(function(){$scope.$eval(attrs.ngChange)}),ngModel.$render=function(){$scope.value=ngModel.$modelValue},$scope.toggle=function(){$scope.value="asc"===$scope.value?"dsc":"asc",ngModel.$setViewValue($scope.value)}}}})}(angular),function(jQuery,angular){"use strict";angular.module("gp-common").filter("fixLabel",function(){return function(input){return input=input||"",input.replace(/_/g," ")}}).filter("pluralize",function(){return function(text){return text&&text.length?text.endsWith("ss")?text+"es":text.endsWith("s")?text:text+"s":""}}).filter("capitalize",function(){return function(text){return text[0].toUpperCase()+text.substring(1)}}).filter("facets",function(){return function(arr,facetName){return facetName?arr&&arr.length?arr.filter(function(f){return f.toLowerCase().startsWith(facetName+":")}).map(function(f){return f.substring(f.indexOf(":")+1,f.length)}):[]:arr}}).filter("joinBy",function(){return function(input,delimiter,emptyValue){return input.length?input.join(delimiter||", "):emptyValue||""}}).filter("defaultValue",function(){return function(text,defVal){return"undefined"!=typeof text&&text.length?text:defVal}}).filter("count",function(){return function(input){if("undefined"!=typeof input){if("function"==typeof input.push)return input.length;if("object"==typeof input&&"undefined"!=typeof Object.keys)return Object.keys(input)}return 0}})}(jQuery,angular);